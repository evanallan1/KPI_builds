{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "38"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import calendar\n",
    "import datetime\n",
    "import numpy as np\n",
    "import string\n",
    "import matplotlib as mt\n",
    "import matplotlib.pyplot as plt\n",
    "import pymysql\n",
    "from xlsxwriter.utility import xl_rowcol_to_cell\n",
    "myconnection = pymysql.connect( host='127.0.0.1', user='eallan', passwd='', db='main' )\n",
    "practices = pd.read_sql_query(\"select * from practices where enabled = 1 and id not in (9)\", myconnection)\n",
    "year = 2018\n",
    "year_start = 2015\n",
    "PSD = '2015-01-01 00:00:00'\n",
    "PED = '2018-02-28 23:59:59'\n",
    "month = 'December'\n",
    "def month_string_to_number(string):\n",
    "    m = {v: k for k,v in enumerate(calendar.month_name)}\n",
    "    s = string.strip()[:len('%s' % (month))]\n",
    "    try:\n",
    "        out = m[s]\n",
    "        return out\n",
    "    except:\n",
    "        raise ValueError('Not a month')\n",
    "month_string_to_number(\"%s\" % (month))\n",
    "PSD_computation = datetime.date(2015, 1, 1)\n",
    "PED_computation = datetime.date(2018, 2, 28)\n",
    "def diff_month(d1, d2):\n",
    "    return (d1.year - d2.year) * 12 + d1.month - d2.month +1\n",
    "diff_month(PED_computation, PSD_computation)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "28"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#tests_ige = pd.read_sql_query('select patient_id, start_date, start_practice_id from ige_tests where status = \"complete\" and patient_id IS NOT NULL AND start_practice_id IS NOT NULL', myconnection)\n",
    "#tests_ige\n",
    "practices = pd.read_sql_query(\"select * from practices where enabled = 1 and id not in (9)\", myconnection)\n",
    "len(practices)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pandas\\core\\indexing.py:517: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n",
      "  self.obj[item] = s\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\ipykernel\\__main__.py:21: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>42411</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-06 17:24:11</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>45685</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>June</td>\n",
       "      <td>2017-06-07 18:05:01</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>66497</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>August</td>\n",
       "      <td>2017-08-07 17:27:48</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>81758</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-05 19:15:24</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>87208</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-28 18:43:16</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>192034</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>January</td>\n",
       "      <td>2018-01-31 18:00:22</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>43939</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-02 18:42:59</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>47045</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-11 17:30:14</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>67814</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-01 19:08:59</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>27097</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-30 19:43:29</td>\n",
       "      <td>Abrams, Mark</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>89752</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>December</td>\n",
       "      <td>2017-12-28 17:41:54</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>42118</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-06 17:30:30</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>45749</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>June</td>\n",
       "      <td>2017-06-08 19:59:33</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>81880</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-06 19:18:05</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>87374</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-28 18:43:28</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>192037</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>January</td>\n",
       "      <td>2018-01-31 18:00:27</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>43943</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-02 18:43:06</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>47046</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-11 17:30:19</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>67942</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-05 17:41:57</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>83998</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-30 19:43:34</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>89754</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>December</td>\n",
       "      <td>2017-12-28 17:41:59</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>42412</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-06 17:30:34</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>45751</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>June</td>\n",
       "      <td>2017-06-08 20:06:41</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>66588</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>August</td>\n",
       "      <td>2017-08-08 17:48:01</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>28830</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-06 19:18:09</td>\n",
       "      <td>Sicard, Michael</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>87516</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-29 21:26:29</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>192033</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>January</td>\n",
       "      <td>2018-01-31 18:00:55</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>43944</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-02 18:43:12</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>46435</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-11 17:30:24</td>\n",
       "      <td>Silver, John Robert</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>67972</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-05 21:08:34</td>\n",
       "      <td></td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62334</th>\n",
       "      <td>192791</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>June</td>\n",
       "      <td>2016-06-01 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62335</th>\n",
       "      <td>192794</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>June</td>\n",
       "      <td>2016-06-13 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62336</th>\n",
       "      <td>192798</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>June</td>\n",
       "      <td>2016-06-20 00:00:00</td>\n",
       "      <td>Boone, John</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62337</th>\n",
       "      <td>192802</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>December</td>\n",
       "      <td>2016-12-08 00:00:00</td>\n",
       "      <td>Drew, Brian</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>12-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62338</th>\n",
       "      <td>192806</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>December</td>\n",
       "      <td>2016-12-19 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>12-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62339</th>\n",
       "      <td>192810</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>June</td>\n",
       "      <td>2016-06-29 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62340</th>\n",
       "      <td>192814</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-09 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62341</th>\n",
       "      <td>192819</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>February</td>\n",
       "      <td>2017-02-17 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>02-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62342</th>\n",
       "      <td>192822</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>February</td>\n",
       "      <td>2017-02-24 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>02-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62343</th>\n",
       "      <td>192827</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>March</td>\n",
       "      <td>2017-03-06 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62344</th>\n",
       "      <td>192830</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>March</td>\n",
       "      <td>2017-03-21 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62345</th>\n",
       "      <td>192833</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>July</td>\n",
       "      <td>2016-07-22 00:00:00</td>\n",
       "      <td>Drew, Brian</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62346</th>\n",
       "      <td>192839</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>August</td>\n",
       "      <td>2016-08-03 00:00:00</td>\n",
       "      <td>Ayre, Thomas</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62347</th>\n",
       "      <td>192843</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>August</td>\n",
       "      <td>2016-08-10 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62348</th>\n",
       "      <td>192846</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-07 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62349</th>\n",
       "      <td>192851</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-09 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62350</th>\n",
       "      <td>192856</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>September</td>\n",
       "      <td>2016-09-02 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62351</th>\n",
       "      <td>192855</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>August</td>\n",
       "      <td>2016-08-31 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62352</th>\n",
       "      <td>192863</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>October</td>\n",
       "      <td>2016-10-12 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>10-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62353</th>\n",
       "      <td>192867</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>October</td>\n",
       "      <td>2016-10-26 00:00:00</td>\n",
       "      <td>Drew, Brian</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>10-2016</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62354</th>\n",
       "      <td>192870</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-17 00:00:00</td>\n",
       "      <td>Ayre, Thomas</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62355</th>\n",
       "      <td>192877</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>June</td>\n",
       "      <td>2017-06-28 00:00:00</td>\n",
       "      <td>Drew, Brian</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62356</th>\n",
       "      <td>192881</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-13 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62357</th>\n",
       "      <td>192888</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>August</td>\n",
       "      <td>2017-08-24 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62358</th>\n",
       "      <td>192891</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>August</td>\n",
       "      <td>2017-08-30 00:00:00</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62359</th>\n",
       "      <td>192895</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-29 00:00:00</td>\n",
       "      <td>Ayre, Thomas</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62360</th>\n",
       "      <td>192901</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-25 00:00:00</td>\n",
       "      <td>Rapport, Philip</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62361</th>\n",
       "      <td>192906</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-10 00:00:00</td>\n",
       "      <td>Ayre, Thomas</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62362</th>\n",
       "      <td>192910</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>December</td>\n",
       "      <td>2017-12-21 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>62363</th>\n",
       "      <td>192914</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280.0</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>January</td>\n",
       "      <td>2018-01-17 00:00:00</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>Allergy Tests - Sticks</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>121236 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Patients_Tested  practice_id  \\\n",
       "0                42411           16   \n",
       "1                45685           16   \n",
       "2                66497           16   \n",
       "3                81758           16   \n",
       "4                87208           16   \n",
       "5               192034           16   \n",
       "6                43939           16   \n",
       "7                47045           16   \n",
       "8                67814           16   \n",
       "9                27097           16   \n",
       "10               89752           16   \n",
       "11               42118           16   \n",
       "12               45749           16   \n",
       "13               81880           16   \n",
       "14               87374           16   \n",
       "15              192037           16   \n",
       "16               43943           16   \n",
       "17               47046           16   \n",
       "18               67942           16   \n",
       "19               83998           16   \n",
       "20               89754           16   \n",
       "21               42412           16   \n",
       "22               45751           16   \n",
       "23               66588           16   \n",
       "24               28830           16   \n",
       "25               87516           16   \n",
       "26              192033           16   \n",
       "27               43944           16   \n",
       "28               46435           16   \n",
       "29               67972           16   \n",
       "...                ...          ...   \n",
       "62334           192791           15   \n",
       "62335           192794           15   \n",
       "62336           192798           15   \n",
       "62337           192802           15   \n",
       "62338           192806           15   \n",
       "62339           192810           15   \n",
       "62340           192814           15   \n",
       "62341           192819           15   \n",
       "62342           192822           15   \n",
       "62343           192827           15   \n",
       "62344           192830           15   \n",
       "62345           192833           15   \n",
       "62346           192839           15   \n",
       "62347           192843           15   \n",
       "62348           192846           15   \n",
       "62349           192851           15   \n",
       "62350           192856           15   \n",
       "62351           192855           15   \n",
       "62352           192863           15   \n",
       "62353           192867           15   \n",
       "62354           192870           15   \n",
       "62355           192877           15   \n",
       "62356           192881           15   \n",
       "62357           192888           15   \n",
       "62358           192891           15   \n",
       "62359           192895           15   \n",
       "62360           192901           15   \n",
       "62361           192906           15   \n",
       "62362           192910           15   \n",
       "62363           192914           15   \n",
       "\n",
       "                                          practice_name  location_id  \\\n",
       "0      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "1      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "2      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "3      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "4      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "5      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "6      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "7      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "8      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "9      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "10     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "11     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "12     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "13     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "14     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "15     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "16     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "17     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "18     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "19     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "20     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "21     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "22     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "23     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "24     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "25     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "26     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "27     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "28     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "29     Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "...                                                 ...          ...   \n",
       "62334                        Minneapolis Otolaryngology        280.0   \n",
       "62335                        Minneapolis Otolaryngology        280.0   \n",
       "62336                        Minneapolis Otolaryngology        280.0   \n",
       "62337                        Minneapolis Otolaryngology        280.0   \n",
       "62338                        Minneapolis Otolaryngology        280.0   \n",
       "62339                        Minneapolis Otolaryngology        280.0   \n",
       "62340                        Minneapolis Otolaryngology        280.0   \n",
       "62341                        Minneapolis Otolaryngology        280.0   \n",
       "62342                        Minneapolis Otolaryngology        280.0   \n",
       "62343                        Minneapolis Otolaryngology        280.0   \n",
       "62344                        Minneapolis Otolaryngology        280.0   \n",
       "62345                        Minneapolis Otolaryngology        280.0   \n",
       "62346                        Minneapolis Otolaryngology        280.0   \n",
       "62347                        Minneapolis Otolaryngology        280.0   \n",
       "62348                        Minneapolis Otolaryngology        280.0   \n",
       "62349                        Minneapolis Otolaryngology        280.0   \n",
       "62350                        Minneapolis Otolaryngology        280.0   \n",
       "62351                        Minneapolis Otolaryngology        280.0   \n",
       "62352                        Minneapolis Otolaryngology        280.0   \n",
       "62353                        Minneapolis Otolaryngology        280.0   \n",
       "62354                        Minneapolis Otolaryngology        280.0   \n",
       "62355                        Minneapolis Otolaryngology        280.0   \n",
       "62356                        Minneapolis Otolaryngology        280.0   \n",
       "62357                        Minneapolis Otolaryngology        280.0   \n",
       "62358                        Minneapolis Otolaryngology        280.0   \n",
       "62359                        Minneapolis Otolaryngology        280.0   \n",
       "62360                        Minneapolis Otolaryngology        280.0   \n",
       "62361                        Minneapolis Otolaryngology        280.0   \n",
       "62362                        Minneapolis Otolaryngology        280.0   \n",
       "62363                        Minneapolis Otolaryngology        280.0   \n",
       "\n",
       "                           location_name  test_date          month_year  \\\n",
       "0      North Charleston (reference-only)      April 2017-04-06 17:24:11   \n",
       "1      North Charleston (reference-only)       June 2017-06-07 18:05:01   \n",
       "2      North Charleston (reference-only)     August 2017-08-07 17:27:48   \n",
       "3      North Charleston (reference-only)    October 2017-10-05 19:15:24   \n",
       "4      North Charleston (reference-only)   November 2017-11-28 18:43:16   \n",
       "5      North Charleston (reference-only)    January 2018-01-31 18:00:22   \n",
       "6      North Charleston (reference-only)        May 2017-05-02 18:42:59   \n",
       "7      North Charleston (reference-only)       July 2017-07-11 17:30:14   \n",
       "8      North Charleston (reference-only)  September 2017-09-01 19:08:59   \n",
       "9      North Charleston (reference-only)    October 2017-10-30 19:43:29   \n",
       "10     North Charleston (reference-only)   December 2017-12-28 17:41:54   \n",
       "11     North Charleston (reference-only)      April 2017-04-06 17:30:30   \n",
       "12     North Charleston (reference-only)       June 2017-06-08 19:59:33   \n",
       "13     North Charleston (reference-only)    October 2017-10-06 19:18:05   \n",
       "14     North Charleston (reference-only)   November 2017-11-28 18:43:28   \n",
       "15     North Charleston (reference-only)    January 2018-01-31 18:00:27   \n",
       "16     North Charleston (reference-only)        May 2017-05-02 18:43:06   \n",
       "17     North Charleston (reference-only)       July 2017-07-11 17:30:19   \n",
       "18     North Charleston (reference-only)  September 2017-09-05 17:41:57   \n",
       "19     North Charleston (reference-only)    October 2017-10-30 19:43:34   \n",
       "20     North Charleston (reference-only)   December 2017-12-28 17:41:59   \n",
       "21     North Charleston (reference-only)      April 2017-04-06 17:30:34   \n",
       "22     North Charleston (reference-only)       June 2017-06-08 20:06:41   \n",
       "23     North Charleston (reference-only)     August 2017-08-08 17:48:01   \n",
       "24     North Charleston (reference-only)    October 2017-10-06 19:18:09   \n",
       "25     North Charleston (reference-only)   November 2017-11-29 21:26:29   \n",
       "26     North Charleston (reference-only)    January 2018-01-31 18:00:55   \n",
       "27     North Charleston (reference-only)        May 2017-05-02 18:43:12   \n",
       "28     North Charleston (reference-only)       July 2017-07-11 17:30:24   \n",
       "29     North Charleston (reference-only)  September 2017-09-05 21:08:34   \n",
       "...                                  ...        ...                 ...   \n",
       "62334                          Southdale       June 2016-06-01 00:00:00   \n",
       "62335                          Southdale       June 2016-06-13 00:00:00   \n",
       "62336                          Southdale       June 2016-06-20 00:00:00   \n",
       "62337                          Southdale   December 2016-12-08 00:00:00   \n",
       "62338                          Southdale   December 2016-12-19 00:00:00   \n",
       "62339                          Southdale       June 2016-06-29 00:00:00   \n",
       "62340                          Southdale    January 2017-01-09 00:00:00   \n",
       "62341                          Southdale   February 2017-02-17 00:00:00   \n",
       "62342                          Southdale   February 2017-02-24 00:00:00   \n",
       "62343                          Southdale      March 2017-03-06 00:00:00   \n",
       "62344                          Southdale      March 2017-03-21 00:00:00   \n",
       "62345                          Southdale       July 2016-07-22 00:00:00   \n",
       "62346                          Southdale     August 2016-08-03 00:00:00   \n",
       "62347                          Southdale     August 2016-08-10 00:00:00   \n",
       "62348                          Southdale      April 2017-04-07 00:00:00   \n",
       "62349                          Southdale        May 2017-05-09 00:00:00   \n",
       "62350                          Southdale  September 2016-09-02 00:00:00   \n",
       "62351                          Southdale     August 2016-08-31 00:00:00   \n",
       "62352                          Southdale    October 2016-10-12 00:00:00   \n",
       "62353                          Southdale    October 2016-10-26 00:00:00   \n",
       "62354                          Southdale        May 2017-05-17 00:00:00   \n",
       "62355                          Southdale       June 2017-06-28 00:00:00   \n",
       "62356                          Southdale       July 2017-07-13 00:00:00   \n",
       "62357                          Southdale     August 2017-08-24 00:00:00   \n",
       "62358                          Southdale     August 2017-08-30 00:00:00   \n",
       "62359                          Southdale  September 2017-09-29 00:00:00   \n",
       "62360                          Southdale    October 2017-10-25 00:00:00   \n",
       "62361                          Southdale   November 2017-11-10 00:00:00   \n",
       "62362                          Southdale   December 2017-12-21 00:00:00   \n",
       "62363                          Southdale    January 2018-01-17 00:00:00   \n",
       "\n",
       "                  provider                    type benchmark_date grouping  \n",
       "0                              Patient Tests - IGE        04-2017   Group1  \n",
       "1                              Patient Tests - IGE        06-2017   Group1  \n",
       "2                              Patient Tests - IGE        08-2017   Group1  \n",
       "3         Parsons, Gregory     Patient Tests - IGE        10-2017   Group1  \n",
       "4                              Patient Tests - IGE        11-2017   Group1  \n",
       "5                              Patient Tests - IGE        01-2018   Group1  \n",
       "6                              Patient Tests - IGE        05-2017   Group1  \n",
       "7                              Patient Tests - IGE        07-2017   Group1  \n",
       "8                              Patient Tests - IGE        09-2017   Group1  \n",
       "9             Abrams, Mark     Patient Tests - IGE        10-2017   Group1  \n",
       "10                             Patient Tests - IGE        12-2017   Group1  \n",
       "11                             Patient Tests - IGE        04-2017   Group1  \n",
       "12                             Patient Tests - IGE        06-2017   Group1  \n",
       "13                             Patient Tests - IGE        10-2017   Group1  \n",
       "14                             Patient Tests - IGE        11-2017   Group1  \n",
       "15                             Patient Tests - IGE        01-2018   Group1  \n",
       "16                             Patient Tests - IGE        05-2017   Group1  \n",
       "17                             Patient Tests - IGE        07-2017   Group1  \n",
       "18                             Patient Tests - IGE        09-2017   Group1  \n",
       "19                             Patient Tests - IGE        10-2017   Group1  \n",
       "20                             Patient Tests - IGE        12-2017   Group1  \n",
       "21        Parsons, Gregory     Patient Tests - IGE        04-2017   Group1  \n",
       "22        Parsons, Gregory     Patient Tests - IGE        06-2017   Group1  \n",
       "23                             Patient Tests - IGE        08-2017   Group1  \n",
       "24         Sicard, Michael     Patient Tests - IGE        10-2017   Group1  \n",
       "25                             Patient Tests - IGE        11-2017   Group1  \n",
       "26                             Patient Tests - IGE        01-2018   Group1  \n",
       "27                             Patient Tests - IGE        05-2017   Group1  \n",
       "28     Silver, John Robert     Patient Tests - IGE        07-2017   Group1  \n",
       "29                             Patient Tests - IGE        09-2017   Group1  \n",
       "...                    ...                     ...            ...      ...  \n",
       "62334       Silver, Robert  Allergy Tests - Sticks        06-2016   Group2  \n",
       "62335       Silver, Robert  Allergy Tests - Sticks        06-2016   Group2  \n",
       "62336          Boone, John  Allergy Tests - Sticks        06-2016   Group2  \n",
       "62337          Drew, Brian  Allergy Tests - Sticks        12-2016   Group2  \n",
       "62338          Posey, Lisa  Allergy Tests - Sticks        12-2016   Group2  \n",
       "62339          Posey, Lisa  Allergy Tests - Sticks        06-2016   Group2  \n",
       "62340          Posey, Lisa  Allergy Tests - Sticks        01-2017   Group2  \n",
       "62341          Posey, Lisa  Allergy Tests - Sticks        02-2017   Group2  \n",
       "62342          Posey, Lisa  Allergy Tests - Sticks        02-2017   Group2  \n",
       "62343       Silver, Robert  Allergy Tests - Sticks        03-2017   Group2  \n",
       "62344       Silver, Robert  Allergy Tests - Sticks        03-2017   Group2  \n",
       "62345          Drew, Brian  Allergy Tests - Sticks        07-2016   Group2  \n",
       "62346         Ayre, Thomas  Allergy Tests - Sticks        08-2016   Group2  \n",
       "62347       Silver, Robert  Allergy Tests - Sticks        08-2016   Group2  \n",
       "62348       Silver, Robert  Allergy Tests - Sticks        04-2017   Group2  \n",
       "62349          Posey, Lisa  Allergy Tests - Sticks        05-2017   Group2  \n",
       "62350       Silver, Robert  Allergy Tests - Sticks        09-2016   Group2  \n",
       "62351          Posey, Lisa  Allergy Tests - Sticks        08-2016   Group2  \n",
       "62352          Posey, Lisa  Allergy Tests - Sticks        10-2016   Group2  \n",
       "62353          Drew, Brian  Allergy Tests - Sticks        10-2016   Group2  \n",
       "62354         Ayre, Thomas  Allergy Tests - Sticks        05-2017   Group2  \n",
       "62355          Drew, Brian  Allergy Tests - Sticks        06-2017   Group2  \n",
       "62356          Posey, Lisa  Allergy Tests - Sticks        07-2017   Group2  \n",
       "62357       Silver, Robert  Allergy Tests - Sticks        08-2017   Group2  \n",
       "62358       Silver, Robert  Allergy Tests - Sticks        08-2017   Group2  \n",
       "62359         Ayre, Thomas  Allergy Tests - Sticks        09-2017   Group2  \n",
       "62360      Rapport, Philip  Allergy Tests - Sticks        10-2017   Group2  \n",
       "62361         Ayre, Thomas  Allergy Tests - Sticks        11-2017   Group2  \n",
       "62362                       Allergy Tests - Sticks        12-2017   Group2  \n",
       "62363          Posey, Lisa  Allergy Tests - Sticks        01-2018   Group2  \n",
       "\n",
       "[121236 rows x 11 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_tests = pd.read_sql_query(\"SELECT distinct q.patient as Patients_Tested, q.practice_ID as practice_id, q.Practice_name as practice_name, q.Location_ID as location_id, q.Name as location_name, monthname(q.test_date) as test_date, q.test_date as month_year, concat_ws(', ', pd.lastname, pd.firstname) as provider, q.type FROM ( (select distinct(a.patient_id) as patient, a.user_id as tester, a.test_date as test_date, a.location_ID, d.Name, a.practice_id, i.name as Practice_name, 'injection' as type from intradermal_tests a INNER JOIN practice_locations d ON a.Location_ID = d.id INNER JOIN practices i on a.practice_id = i.id where a.Test_Date BETWEEN %(PSD)s AND %(PED)s AND (a.Status IS NULL OR a.Status <> 'deleted')) UNION (select distinct(b.patient_id) as patient, b.tester_id as tester, b.test_date as test_date, b.location_id, e.Name, b.practice_id, i.name as Practice_name, 'mqt' as type from mq_tests b INNER JOIN practice_locations e ON b.Location_ID = e.id INNER JOIN practices i on b.practice_id = i.id where b.Test_Date BETWEEN %(PSD)s AND %(PED)s AND (b.Status IS NULL OR b.Status <> 'deleted')) UNION (select distinct(c.patient_id) as patient, c.tester_id as tester, c.test_date as test_date, c.location_id, f.Name, c.practice_id, i.name as Practice_name, 'stick' as type from prick_tests c INNER JOIN practice_locations f ON c.location_id = f.id INNER JOIN practices i on c.practice_id = i.id where c.Test_Date BETWEEN %(PSD)s AND %(PED)s AND (c.Status IS NULL OR c.Status <> 'deleted')) UNION (select distinct(g.patient_id) as patient, g.blood_drawn_by as tester, g.Start_Date as test_date, g.Start_Location_id AS Location_ID, h.name, g.start_practice_id, i.name as Practice_name, 'ige' as type from ige_tests g INNER JOIN practice_locations h ON g.start_practice_id = h.ID INNER JOIN practices i on g.start_practice_id = i.id where g.Start_Date BETWEEN %(PSD)s AND %(PED)s AND (g.Status = 'Complete')) order by Location_ID) q LEFT JOIN patients p on q.patient = p.id LEFT JOIN practice_doctors pd on p.mix_practice_doctor_id = pd.id WHERE q.practice_id <> 9\" , myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "total_tests['benchmark_date'] = total_tests['month_year'].dt.strftime('%m-%Y')\n",
    "total_tests_no_dups = total_tests.drop_duplicates(['Patients_Tested', 'test_date', 'type'])\n",
    "prick_index = total_tests_no_dups.type == 'stick'\n",
    "injection_index = total_tests_no_dups.type == 'injection'\n",
    "mqt_index = total_tests_no_dups.type == 'mqt'\n",
    "ige_index = total_tests_no_dups.type == 'ige'\n",
    "total_tests_no_dups.loc[prick_index, 'type'] = 'Patient Tests - Pricks'\n",
    "total_tests_no_dups.loc[injection_index, 'type'] = 'Patient Tests - Sticks'\n",
    "total_tests_no_dups.loc[mqt_index, 'type'] = 'Patient Tests - MQT'\n",
    "total_tests_no_dups.loc[ige_index, 'type'] = 'Patient Tests - IGE'\n",
    "prick_index = total_tests.type == 'stick'\n",
    "injection_index = total_tests.type == 'injection'\n",
    "mqt_index = total_tests.type == 'mqt'\n",
    "ige_index = total_tests.type == 'ige'\n",
    "total_tests.loc[prick_index, 'type'] = 'Allergy Tests - Pricks'\n",
    "total_tests.loc[injection_index, 'type'] = 'Allergy Tests - Sticks'\n",
    "total_tests.loc[mqt_index, 'type'] = 'Allergy Tests - MQT'\n",
    "total_tests.loc[ige_index, 'type'] = 'Allergy Tests - IGE'\n",
    "total_tests['grouping'] = 'Group2'\n",
    "total_tests_no_dups['grouping'] = 'Group1'\n",
    "all_tests = pd.concat([total_tests_no_dups, total_tests], axis=0)\n",
    "#all_tests.to_excel('AllergyEDGE Tests Examples Tests.xlsx')\n",
    "all_tests"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>14588</td>\n",
       "      <td>34</td>\n",
       "      <td>Jeffrey Masin MD</td>\n",
       "      <td>129.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-02</td>\n",
       "      <td>Masin, Jeffery</td>\n",
       "      <td># of Pricks related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384408</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384409</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384410</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384411</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384412</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384413</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384414</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384415</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384416</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384417</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384418</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384419</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384420</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384421</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384422</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384423</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384424</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384425</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384426</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384427</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384428</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384429</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384430</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384431</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384432</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384433</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384434</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384435</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384436</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1384437</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Pricks not related to Food</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1384438 rows Ã— 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Patients_Tested  practice_id     practice_name  location_id  \\\n",
       "0                  14588           34  Jeffrey Masin MD        129.0   \n",
       "1                  14588           34  Jeffrey Masin MD        129.0   \n",
       "2                  14588           34  Jeffrey Masin MD        129.0   \n",
       "3                  14588           34  Jeffrey Masin MD        129.0   \n",
       "4                  14588           34  Jeffrey Masin MD        129.0   \n",
       "5                  14588           34  Jeffrey Masin MD        129.0   \n",
       "6                  14588           34  Jeffrey Masin MD        129.0   \n",
       "7                  14588           34  Jeffrey Masin MD        129.0   \n",
       "8                  14588           34  Jeffrey Masin MD        129.0   \n",
       "9                  14588           34  Jeffrey Masin MD        129.0   \n",
       "10                 14588           34  Jeffrey Masin MD        129.0   \n",
       "11                 14588           34  Jeffrey Masin MD        129.0   \n",
       "12                 14588           34  Jeffrey Masin MD        129.0   \n",
       "13                 14588           34  Jeffrey Masin MD        129.0   \n",
       "14                 14588           34  Jeffrey Masin MD        129.0   \n",
       "15                 14588           34  Jeffrey Masin MD        129.0   \n",
       "16                 14588           34  Jeffrey Masin MD        129.0   \n",
       "17                 14588           34  Jeffrey Masin MD        129.0   \n",
       "18                 14588           34  Jeffrey Masin MD        129.0   \n",
       "19                 14588           34  Jeffrey Masin MD        129.0   \n",
       "20                 14588           34  Jeffrey Masin MD        129.0   \n",
       "21                 14588           34  Jeffrey Masin MD        129.0   \n",
       "22                 14588           34  Jeffrey Masin MD        129.0   \n",
       "23                 14588           34  Jeffrey Masin MD        129.0   \n",
       "24                 14588           34  Jeffrey Masin MD        129.0   \n",
       "25                 14588           34  Jeffrey Masin MD        129.0   \n",
       "26                 14588           34  Jeffrey Masin MD        129.0   \n",
       "27                 14588           34  Jeffrey Masin MD        129.0   \n",
       "28                 14588           34  Jeffrey Masin MD        129.0   \n",
       "29                 14588           34  Jeffrey Masin MD        129.0   \n",
       "...                  ...          ...               ...          ...   \n",
       "1384408           196390           13         Texas ENT        221.0   \n",
       "1384409           196390           13         Texas ENT        221.0   \n",
       "1384410           196390           13         Texas ENT        221.0   \n",
       "1384411           196390           13         Texas ENT        221.0   \n",
       "1384412           196390           13         Texas ENT        221.0   \n",
       "1384413           196390           13         Texas ENT        221.0   \n",
       "1384414           196390           13         Texas ENT        221.0   \n",
       "1384415           196390           13         Texas ENT        221.0   \n",
       "1384416           196390           13         Texas ENT        221.0   \n",
       "1384417           196390           13         Texas ENT        221.0   \n",
       "1384418           196390           13         Texas ENT        221.0   \n",
       "1384419           196390           13         Texas ENT        221.0   \n",
       "1384420           196390           13         Texas ENT        221.0   \n",
       "1384421           196390           13         Texas ENT        221.0   \n",
       "1384422           196390           13         Texas ENT        221.0   \n",
       "1384423           196390           13         Texas ENT        221.0   \n",
       "1384424           196390           13         Texas ENT        221.0   \n",
       "1384425           196390           13         Texas ENT        221.0   \n",
       "1384426           196390           13         Texas ENT        221.0   \n",
       "1384427           196390           13         Texas ENT        221.0   \n",
       "1384428           196390           13         Texas ENT        221.0   \n",
       "1384429           196390           13         Texas ENT        221.0   \n",
       "1384430           196390           13         Texas ENT        221.0   \n",
       "1384431           196390           13         Texas ENT        221.0   \n",
       "1384432           196390           13         Texas ENT        221.0   \n",
       "1384433           196390           13         Texas ENT        221.0   \n",
       "1384434           196390           13         Texas ENT        221.0   \n",
       "1384435           196390           13         Texas ENT        221.0   \n",
       "1384436           196390           13         Texas ENT        221.0   \n",
       "1384437           196390           13         Texas ENT        221.0   \n",
       "\n",
       "        location_name  test_date month_year        provider  \\\n",
       "0                Main  September 2015-09-02  Masin, Jeffery   \n",
       "1                Main  September 2015-09-02  Masin, Jeffery   \n",
       "2                Main  September 2015-09-02  Masin, Jeffery   \n",
       "3                Main  September 2015-09-02  Masin, Jeffery   \n",
       "4                Main  September 2015-09-02  Masin, Jeffery   \n",
       "5                Main  September 2015-09-02  Masin, Jeffery   \n",
       "6                Main  September 2015-09-02  Masin, Jeffery   \n",
       "7                Main  September 2015-09-02  Masin, Jeffery   \n",
       "8                Main  September 2015-09-02  Masin, Jeffery   \n",
       "9                Main  September 2015-09-02  Masin, Jeffery   \n",
       "10               Main  September 2015-09-02  Masin, Jeffery   \n",
       "11               Main  September 2015-09-02  Masin, Jeffery   \n",
       "12               Main  September 2015-09-02  Masin, Jeffery   \n",
       "13               Main  September 2015-09-02  Masin, Jeffery   \n",
       "14               Main  September 2015-09-02  Masin, Jeffery   \n",
       "15               Main  September 2015-09-02  Masin, Jeffery   \n",
       "16               Main  September 2015-09-02  Masin, Jeffery   \n",
       "17               Main  September 2015-09-02  Masin, Jeffery   \n",
       "18               Main  September 2015-09-02  Masin, Jeffery   \n",
       "19               Main  September 2015-09-02  Masin, Jeffery   \n",
       "20               Main  September 2015-09-02  Masin, Jeffery   \n",
       "21               Main  September 2015-09-02  Masin, Jeffery   \n",
       "22               Main  September 2015-09-02  Masin, Jeffery   \n",
       "23               Main  September 2015-09-02  Masin, Jeffery   \n",
       "24               Main  September 2015-09-02  Masin, Jeffery   \n",
       "25               Main  September 2015-09-02  Masin, Jeffery   \n",
       "26               Main  September 2015-09-02  Masin, Jeffery   \n",
       "27               Main  September 2015-09-02  Masin, Jeffery   \n",
       "28               Main  September 2015-09-02  Masin, Jeffery   \n",
       "29               Main  September 2015-09-02  Masin, Jeffery   \n",
       "...               ...        ...        ...             ...   \n",
       "1384408   Tanglewilde   February 2018-02-28                   \n",
       "1384409   Tanglewilde   February 2018-02-28                   \n",
       "1384410   Tanglewilde   February 2018-02-28                   \n",
       "1384411   Tanglewilde   February 2018-02-28                   \n",
       "1384412   Tanglewilde   February 2018-02-28                   \n",
       "1384413   Tanglewilde   February 2018-02-28                   \n",
       "1384414   Tanglewilde   February 2018-02-28                   \n",
       "1384415   Tanglewilde   February 2018-02-28                   \n",
       "1384416   Tanglewilde   February 2018-02-28                   \n",
       "1384417   Tanglewilde   February 2018-02-28                   \n",
       "1384418   Tanglewilde   February 2018-02-28                   \n",
       "1384419   Tanglewilde   February 2018-02-28                   \n",
       "1384420   Tanglewilde   February 2018-02-28                   \n",
       "1384421   Tanglewilde   February 2018-02-28                   \n",
       "1384422   Tanglewilde   February 2018-02-28                   \n",
       "1384423   Tanglewilde   February 2018-02-28                   \n",
       "1384424   Tanglewilde   February 2018-02-28                   \n",
       "1384425   Tanglewilde   February 2018-02-28                   \n",
       "1384426   Tanglewilde   February 2018-02-28                   \n",
       "1384427   Tanglewilde   February 2018-02-28                   \n",
       "1384428   Tanglewilde   February 2018-02-28                   \n",
       "1384429   Tanglewilde   February 2018-02-28                   \n",
       "1384430   Tanglewilde   February 2018-02-28                   \n",
       "1384431   Tanglewilde   February 2018-02-28                   \n",
       "1384432   Tanglewilde   February 2018-02-28                   \n",
       "1384433   Tanglewilde   February 2018-02-28                   \n",
       "1384434   Tanglewilde   February 2018-02-28                   \n",
       "1384435   Tanglewilde   February 2018-02-28                   \n",
       "1384436   Tanglewilde   February 2018-02-28                   \n",
       "1384437   Tanglewilde   February 2018-02-28                   \n",
       "\n",
       "                                    type grouping  \n",
       "0        # of Pricks not related to Food   Group3  \n",
       "1        # of Pricks not related to Food   Group3  \n",
       "2        # of Pricks not related to Food   Group3  \n",
       "3        # of Pricks not related to Food   Group3  \n",
       "4        # of Pricks not related to Food   Group3  \n",
       "5        # of Pricks not related to Food   Group3  \n",
       "6        # of Pricks not related to Food   Group3  \n",
       "7        # of Pricks not related to Food   Group3  \n",
       "8        # of Pricks not related to Food   Group3  \n",
       "9        # of Pricks not related to Food   Group3  \n",
       "10       # of Pricks not related to Food   Group3  \n",
       "11       # of Pricks not related to Food   Group3  \n",
       "12       # of Pricks not related to Food   Group3  \n",
       "13       # of Pricks not related to Food   Group3  \n",
       "14       # of Pricks not related to Food   Group3  \n",
       "15       # of Pricks not related to Food   Group3  \n",
       "16       # of Pricks not related to Food   Group3  \n",
       "17       # of Pricks not related to Food   Group3  \n",
       "18       # of Pricks not related to Food   Group3  \n",
       "19       # of Pricks not related to Food   Group3  \n",
       "20       # of Pricks not related to Food   Group3  \n",
       "21       # of Pricks not related to Food   Group3  \n",
       "22       # of Pricks not related to Food   Group3  \n",
       "23       # of Pricks not related to Food   Group3  \n",
       "24       # of Pricks not related to Food   Group3  \n",
       "25       # of Pricks not related to Food   Group3  \n",
       "26       # of Pricks not related to Food   Group3  \n",
       "27       # of Pricks not related to Food   Group3  \n",
       "28       # of Pricks not related to Food   Group3  \n",
       "29           # of Pricks related to Food   Group3  \n",
       "...                                  ...      ...  \n",
       "1384408  # of Pricks not related to Food   Group3  \n",
       "1384409  # of Pricks not related to Food   Group3  \n",
       "1384410  # of Pricks not related to Food   Group3  \n",
       "1384411  # of Pricks not related to Food   Group3  \n",
       "1384412      # of Pricks related to Food   Group3  \n",
       "1384413  # of Pricks not related to Food   Group3  \n",
       "1384414  # of Pricks not related to Food   Group3  \n",
       "1384415  # of Pricks not related to Food   Group3  \n",
       "1384416  # of Pricks not related to Food   Group3  \n",
       "1384417  # of Pricks not related to Food   Group3  \n",
       "1384418  # of Pricks not related to Food   Group3  \n",
       "1384419  # of Pricks not related to Food   Group3  \n",
       "1384420  # of Pricks not related to Food   Group3  \n",
       "1384421  # of Pricks not related to Food   Group3  \n",
       "1384422      # of Pricks related to Food   Group3  \n",
       "1384423  # of Pricks not related to Food   Group3  \n",
       "1384424  # of Pricks not related to Food   Group3  \n",
       "1384425  # of Pricks not related to Food   Group3  \n",
       "1384426  # of Pricks not related to Food   Group3  \n",
       "1384427  # of Pricks not related to Food   Group3  \n",
       "1384428  # of Pricks not related to Food   Group3  \n",
       "1384429  # of Pricks not related to Food   Group3  \n",
       "1384430  # of Pricks not related to Food   Group3  \n",
       "1384431  # of Pricks not related to Food   Group3  \n",
       "1384432  # of Pricks not related to Food   Group3  \n",
       "1384433  # of Pricks not related to Food   Group3  \n",
       "1384434  # of Pricks not related to Food   Group3  \n",
       "1384435  # of Pricks not related to Food   Group3  \n",
       "1384436  # of Pricks not related to Food   Group3  \n",
       "1384437  # of Pricks not related to Food   Group3  \n",
       "\n",
       "[1384438 rows x 10 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "####Not Needed###\n",
    "total_pricks_pricks = pd.read_sql_query(\"SELECT a.patient_id as Patients_Tested, a.practice_id, p.name as practice_name, a.location_id, pl.name as location_name, monthname(a.test_date) as test_date, a.test_date as month_year, 'prick' as source, ucase(c.name) as name, concat_ws(', ', pd.lastname, pd.firstname) as provider FROM prick_tests a LEFT JOIN prick_test_results b on a.id = b.test_id LEFT JOIN antigens c on b.antigen_id = c.id LEFT JOIN practices p on a.practice_id = p.id LEFT JOIN practice_locations pl on a.location_id = pl.id LEFT JOIN patients d on a.patient_id = d.id LEFT JOIN practice_doctors pd on d.mix_practice_doctor_id = pd.id WHERE a.practice_id <> 9 and a.test_date BETWEEN %(PSD)s AND %(PED)s\" , myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "total_pricks_mqt = pd.read_sql_query(\"SELECT a.patient_id as Patients_Tested, a.practice_id, p.name as practice_name, a.location_id, pl.name as location_name, monthname(a.test_date) as test_date, a.test_date as month_year, 'mqt' as source, ucase(c.name) as name, concat_ws(', ', pd.lastname, pd.firstname) as provider FROM mq_tests a LEFT JOIN mq_tests_antigens b on a.id = b.test_id LEFT JOIN antigens c on b.antigen_id = c.id LEFT JOIN practices p on a.practice_id = p.id LEFT JOIN practice_locations pl on a.location_id = pl.id LEFT JOIN patients d on a.patient_id = d.id LEFT JOIN practice_doctors pd on d.mix_practice_doctor_id = pd.id WHERE a.practice_id <> 9 and a.test_date BETWEEN %(PSD)s AND %(PED)s and b.multi is not null\" , myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "total_pricks = total_pricks_pricks.append(total_pricks_mqt, ignore_index=True)\n",
    "#if len(total_pricks.index) > 0:\n",
    "#    total_pricks['month_year'] = total_pricks['month_year'].dt.strftime('%m/%d/%Y')\n",
    "#else:\n",
    "#    total_pricks\n",
    "food_allergins = pd.read_excel('Food Allergens.xlsx')\n",
    "food_pricks = pd.merge(total_pricks, food_allergins, on=['name'], how='left')\n",
    "food_pricks['type'].fillna(\"N\", inplace=True)\n",
    "not_food_index = food_pricks.type == 'N'\n",
    "food_index = food_pricks.type == 'Y'\n",
    "food_pricks.loc[not_food_index, 'type'] = '# of Pricks not related to Food'\n",
    "food_pricks.loc[food_index, 'type'] = '# of Pricks related to Food'\n",
    "food_pricks['grouping'] = 'Group3'\n",
    "food_pricks.drop(['source', 'name'], 1, inplace=True)\n",
    "#food_pricks.to_excel('AllergyEDGE Tests Examples Pricks.xlsx', sheet_name='Food Pricks')\n",
    "food_pricks"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-07</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Intradermal Tests related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533706</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533707</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533708</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533709</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533710</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533711</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533712</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533713</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533714</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533715</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533716</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533717</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533718</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533719</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533720</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533721</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533722</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533723</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533724</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533725</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533726</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533727</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533728</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533729</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533730</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533731</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533732</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533733</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533734</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1533735</th>\n",
       "      <td>196390</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>221.0</td>\n",
       "      <td>Tanglewilde</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28</td>\n",
       "      <td></td>\n",
       "      <td># of Intradermal Tests not related to Food</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1533736 rows Ã— 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Patients_Tested  practice_id practice_name  location_id  \\\n",
       "0                     77           36   Augusta ENT        124.0   \n",
       "1                     77           36   Augusta ENT        124.0   \n",
       "2                     77           36   Augusta ENT        124.0   \n",
       "3                     77           36   Augusta ENT        124.0   \n",
       "4                     77           36   Augusta ENT        124.0   \n",
       "5                     77           36   Augusta ENT        124.0   \n",
       "6                     77           36   Augusta ENT        124.0   \n",
       "7                     77           36   Augusta ENT        124.0   \n",
       "8                     77           36   Augusta ENT        124.0   \n",
       "9                     77           36   Augusta ENT        124.0   \n",
       "10                    77           36   Augusta ENT        124.0   \n",
       "11                    77           36   Augusta ENT        124.0   \n",
       "12                    77           36   Augusta ENT        124.0   \n",
       "13                    77           36   Augusta ENT        124.0   \n",
       "14                    77           36   Augusta ENT        124.0   \n",
       "15                    77           36   Augusta ENT        124.0   \n",
       "16                    77           36   Augusta ENT        124.0   \n",
       "17                    77           36   Augusta ENT        124.0   \n",
       "18                    77           36   Augusta ENT        124.0   \n",
       "19                    77           36   Augusta ENT        124.0   \n",
       "20                    77           36   Augusta ENT        124.0   \n",
       "21                    77           36   Augusta ENT        124.0   \n",
       "22                    77           36   Augusta ENT        124.0   \n",
       "23                    77           36   Augusta ENT        124.0   \n",
       "24                    77           36   Augusta ENT        124.0   \n",
       "25                    77           36   Augusta ENT        124.0   \n",
       "26                    77           36   Augusta ENT        124.0   \n",
       "27                    77           36   Augusta ENT        124.0   \n",
       "28                    77           36   Augusta ENT        124.0   \n",
       "29                    77           36   Augusta ENT        124.0   \n",
       "...                  ...          ...           ...          ...   \n",
       "1533706           196390           13     Texas ENT        221.0   \n",
       "1533707           196390           13     Texas ENT        221.0   \n",
       "1533708           196390           13     Texas ENT        221.0   \n",
       "1533709           196390           13     Texas ENT        221.0   \n",
       "1533710           196390           13     Texas ENT        221.0   \n",
       "1533711           196390           13     Texas ENT        221.0   \n",
       "1533712           196390           13     Texas ENT        221.0   \n",
       "1533713           196390           13     Texas ENT        221.0   \n",
       "1533714           196390           13     Texas ENT        221.0   \n",
       "1533715           196390           13     Texas ENT        221.0   \n",
       "1533716           196390           13     Texas ENT        221.0   \n",
       "1533717           196390           13     Texas ENT        221.0   \n",
       "1533718           196390           13     Texas ENT        221.0   \n",
       "1533719           196390           13     Texas ENT        221.0   \n",
       "1533720           196390           13     Texas ENT        221.0   \n",
       "1533721           196390           13     Texas ENT        221.0   \n",
       "1533722           196390           13     Texas ENT        221.0   \n",
       "1533723           196390           13     Texas ENT        221.0   \n",
       "1533724           196390           13     Texas ENT        221.0   \n",
       "1533725           196390           13     Texas ENT        221.0   \n",
       "1533726           196390           13     Texas ENT        221.0   \n",
       "1533727           196390           13     Texas ENT        221.0   \n",
       "1533728           196390           13     Texas ENT        221.0   \n",
       "1533729           196390           13     Texas ENT        221.0   \n",
       "1533730           196390           13     Texas ENT        221.0   \n",
       "1533731           196390           13     Texas ENT        221.0   \n",
       "1533732           196390           13     Texas ENT        221.0   \n",
       "1533733           196390           13     Texas ENT        221.0   \n",
       "1533734           196390           13     Texas ENT        221.0   \n",
       "1533735           196390           13     Texas ENT        221.0   \n",
       "\n",
       "        location_name test_date month_year              provider  \\\n",
       "0               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "1               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "2               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "3               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "4               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "5               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "6               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "7               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "8               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "9               Evans    August 2015-08-07  Vickery, Christopher   \n",
       "10              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "11              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "12              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "13              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "14              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "15              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "16              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "17              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "18              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "19              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "20              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "21              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "22              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "23              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "24              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "25              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "26              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "27              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "28              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "29              Evans    August 2015-08-07  Vickery, Christopher   \n",
       "...               ...       ...        ...                   ...   \n",
       "1533706   Tanglewilde  February 2018-02-28                         \n",
       "1533707   Tanglewilde  February 2018-02-28                         \n",
       "1533708   Tanglewilde  February 2018-02-28                         \n",
       "1533709   Tanglewilde  February 2018-02-28                         \n",
       "1533710   Tanglewilde  February 2018-02-28                         \n",
       "1533711   Tanglewilde  February 2018-02-28                         \n",
       "1533712   Tanglewilde  February 2018-02-28                         \n",
       "1533713   Tanglewilde  February 2018-02-28                         \n",
       "1533714   Tanglewilde  February 2018-02-28                         \n",
       "1533715   Tanglewilde  February 2018-02-28                         \n",
       "1533716   Tanglewilde  February 2018-02-28                         \n",
       "1533717   Tanglewilde  February 2018-02-28                         \n",
       "1533718   Tanglewilde  February 2018-02-28                         \n",
       "1533719   Tanglewilde  February 2018-02-28                         \n",
       "1533720   Tanglewilde  February 2018-02-28                         \n",
       "1533721   Tanglewilde  February 2018-02-28                         \n",
       "1533722   Tanglewilde  February 2018-02-28                         \n",
       "1533723   Tanglewilde  February 2018-02-28                         \n",
       "1533724   Tanglewilde  February 2018-02-28                         \n",
       "1533725   Tanglewilde  February 2018-02-28                         \n",
       "1533726   Tanglewilde  February 2018-02-28                         \n",
       "1533727   Tanglewilde  February 2018-02-28                         \n",
       "1533728   Tanglewilde  February 2018-02-28                         \n",
       "1533729   Tanglewilde  February 2018-02-28                         \n",
       "1533730   Tanglewilde  February 2018-02-28                         \n",
       "1533731   Tanglewilde  February 2018-02-28                         \n",
       "1533732   Tanglewilde  February 2018-02-28                         \n",
       "1533733   Tanglewilde  February 2018-02-28                         \n",
       "1533734   Tanglewilde  February 2018-02-28                         \n",
       "1533735   Tanglewilde  February 2018-02-28                         \n",
       "\n",
       "                                               type grouping  \n",
       "0        # of Intradermal Tests not related to Food   Group4  \n",
       "1        # of Intradermal Tests not related to Food   Group4  \n",
       "2        # of Intradermal Tests not related to Food   Group4  \n",
       "3        # of Intradermal Tests not related to Food   Group4  \n",
       "4        # of Intradermal Tests not related to Food   Group4  \n",
       "5        # of Intradermal Tests not related to Food   Group4  \n",
       "6        # of Intradermal Tests not related to Food   Group4  \n",
       "7        # of Intradermal Tests not related to Food   Group4  \n",
       "8        # of Intradermal Tests not related to Food   Group4  \n",
       "9        # of Intradermal Tests not related to Food   Group4  \n",
       "10       # of Intradermal Tests not related to Food   Group4  \n",
       "11       # of Intradermal Tests not related to Food   Group4  \n",
       "12       # of Intradermal Tests not related to Food   Group4  \n",
       "13       # of Intradermal Tests not related to Food   Group4  \n",
       "14       # of Intradermal Tests not related to Food   Group4  \n",
       "15       # of Intradermal Tests not related to Food   Group4  \n",
       "16       # of Intradermal Tests not related to Food   Group4  \n",
       "17       # of Intradermal Tests not related to Food   Group4  \n",
       "18       # of Intradermal Tests not related to Food   Group4  \n",
       "19       # of Intradermal Tests not related to Food   Group4  \n",
       "20       # of Intradermal Tests not related to Food   Group4  \n",
       "21       # of Intradermal Tests not related to Food   Group4  \n",
       "22       # of Intradermal Tests not related to Food   Group4  \n",
       "23       # of Intradermal Tests not related to Food   Group4  \n",
       "24       # of Intradermal Tests not related to Food   Group4  \n",
       "25       # of Intradermal Tests not related to Food   Group4  \n",
       "26       # of Intradermal Tests not related to Food   Group4  \n",
       "27       # of Intradermal Tests not related to Food   Group4  \n",
       "28       # of Intradermal Tests not related to Food   Group4  \n",
       "29           # of Intradermal Tests related to Food   Group4  \n",
       "...                                             ...      ...  \n",
       "1533706  # of Intradermal Tests not related to Food   Group4  \n",
       "1533707  # of Intradermal Tests not related to Food   Group4  \n",
       "1533708  # of Intradermal Tests not related to Food   Group4  \n",
       "1533709  # of Intradermal Tests not related to Food   Group4  \n",
       "1533710      # of Intradermal Tests related to Food   Group4  \n",
       "1533711  # of Intradermal Tests not related to Food   Group4  \n",
       "1533712  # of Intradermal Tests not related to Food   Group4  \n",
       "1533713  # of Intradermal Tests not related to Food   Group4  \n",
       "1533714  # of Intradermal Tests not related to Food   Group4  \n",
       "1533715  # of Intradermal Tests not related to Food   Group4  \n",
       "1533716  # of Intradermal Tests not related to Food   Group4  \n",
       "1533717  # of Intradermal Tests not related to Food   Group4  \n",
       "1533718  # of Intradermal Tests not related to Food   Group4  \n",
       "1533719  # of Intradermal Tests not related to Food   Group4  \n",
       "1533720      # of Intradermal Tests related to Food   Group4  \n",
       "1533721  # of Intradermal Tests not related to Food   Group4  \n",
       "1533722  # of Intradermal Tests not related to Food   Group4  \n",
       "1533723  # of Intradermal Tests not related to Food   Group4  \n",
       "1533724  # of Intradermal Tests not related to Food   Group4  \n",
       "1533725  # of Intradermal Tests not related to Food   Group4  \n",
       "1533726  # of Intradermal Tests not related to Food   Group4  \n",
       "1533727  # of Intradermal Tests not related to Food   Group4  \n",
       "1533728  # of Intradermal Tests not related to Food   Group4  \n",
       "1533729  # of Intradermal Tests not related to Food   Group4  \n",
       "1533730  # of Intradermal Tests not related to Food   Group4  \n",
       "1533731  # of Intradermal Tests not related to Food   Group4  \n",
       "1533732  # of Intradermal Tests not related to Food   Group4  \n",
       "1533733  # of Intradermal Tests not related to Food   Group4  \n",
       "1533734  # of Intradermal Tests not related to Food   Group4  \n",
       "1533735  # of Intradermal Tests not related to Food   Group4  \n",
       "\n",
       "[1533736 rows x 10 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "####Not Needed###\n",
    "total_inj_intra = pd.read_sql_query(\"SELECT a.patient_id as Patients_Tested, a.practice_id, p.name as practice_name, a.location_id, pl.name as location_name, monthname(a.test_date) as test_date, a.test_date as month_year, 'intra' as source, ucase(c.name) as name, concat_ws(', ', pd.lastname, pd.firstname) as provider FROM intradermal_tests a LEFT JOIN intradermal_test_results b on a.id = b.test_id LEFT JOIN intradermal_test_antigens_names c on b.antigen_id = c.id LEFT JOIN practices p on a.practice_id = p.id LEFT JOIN practice_locations pl on a.location_id = pl.id LEFT JOIN patients d on a.patient_id = d.id LEFT JOIN practice_doctors pd on d.mix_practice_doctor_id = pd.id WHERE a.practice_id <> 9 and a.test_date BETWEEN %(PSD)s AND %(PED)s\", myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "total_inj_mqt = pd.read_sql_query(\"SELECT a.patient_id as Patients_Tested, a.practice_id, p.name as practice_name, a.location_id, pl.name as location_name, monthname(a.test_date) as test_date, a.test_date as month_year, 'mqt' as source, ucase(c.name) as name, concat_ws(', ', pd.lastname, pd.firstname) as provider FROM mq_tests a LEFT JOIN mq_tests_antigens b on a.id = b.test_id LEFT JOIN antigens c on b.antigen_id = c.id LEFT JOIN practices p on a.practice_id = p.id LEFT JOIN practice_locations pl on a.location_id = pl.id LEFT JOIN patients d on a.patient_id = d.id LEFT JOIN practice_doctors pd on d.mix_practice_doctor_id = pd.id WHERE a.practice_id <> 9 and a.test_date BETWEEN %(PSD)s AND %(PED)s and b.multi is not null and ((b.dilution_1 is not null and b.dilution_1 <> '') or (b.dilution_2 is not null and b.dilution_2 <> ''))\" , myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "total_inj = total_inj_intra.append(total_inj_mqt, ignore_index=True)\n",
    "#if len(total_inj.index) > 0:\n",
    "#    total_inj['month_year'] = total_inj['month_year'].dt.strftime('%m/%d/%Y')\n",
    "#else:\n",
    "#    total_inj\n",
    "food_allergins = pd.read_excel('Food Allergens.xlsx')\n",
    "food_allergins\n",
    "food_inj = pd.merge(total_inj, food_allergins, on=['name'], how='left')\n",
    "food_inj\n",
    "food_inj['type'].fillna(\"N\", inplace=True)\n",
    "not_food_index = food_inj.type == 'N'\n",
    "food_index = food_inj.type == 'Y'\n",
    "food_inj.loc[not_food_index, 'type'] = '# of Intradermal Tests not related to Food'\n",
    "food_inj.loc[food_index, 'type'] = '# of Intradermal Tests related to Food'\n",
    "food_inj['grouping'] = 'Group4'\n",
    "food_inj.drop(['source', 'name'], 1, inplace=True)\n",
    "#food_inj.to_excel('AllergyEDGE Tests Examples Sticks.xlsx', sheet_name='Food Sticks')\n",
    "food_inj"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>80012</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-04 19:12:14</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>43227</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-19 18:58:12</td>\n",
       "      <td>Caldwell, William</td>\n",
       "      <td># SLIT Vials Mixed for New Patients</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>43279</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-20 19:02:35</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>28230</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-03 19:40:04</td>\n",
       "      <td>Harley, Robert</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>68035</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-06 18:54:51</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>82742</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-13 18:53:36</td>\n",
       "      <td>Miltich, Michael</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>43538</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-26 17:36:51</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>28668</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-11 17:30:29</td>\n",
       "      <td>Moss, Jonathan</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>43447</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-14 19:35:42</td>\n",
       "      <td>Reulbach, Todd</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>43999</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-03 19:12:07</td>\n",
       "      <td>Gibson, F. Brian</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>41266</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-17 17:06:05</td>\n",
       "      <td>Weigel, Mark</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>33845</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>August</td>\n",
       "      <td>2017-08-17 17:38:52</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>34220</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-20 19:22:49</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>44385</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-11 17:06:31</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>78795</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-27 19:23:44</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SLIT Vials Mixed for New Patients</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>90026</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>January</td>\n",
       "      <td>2018-01-02 19:43:44</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>64397</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>August</td>\n",
       "      <td>2017-08-01 19:54:16</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>83999</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-30 19:44:02</td>\n",
       "      <td>Ego-Osuala, Bryan</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>28830</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-06 19:18:08</td>\n",
       "      <td>Sicard, Michael</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>84315</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-02 20:06:11</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>87833</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>December</td>\n",
       "      <td>2017-12-06 21:03:09</td>\n",
       "      <td>Cain-Saint, Faith</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>38798</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-03 18:13:52</td>\n",
       "      <td>Jones, CT</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>68030</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-06 18:54:29</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>33747</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-05 16:27:51</td>\n",
       "      <td>Jones, CT</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>68036</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-06 18:54:54</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>85723</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-07 21:35:43</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>33970</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-07 20:39:39</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>66755</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>August</td>\n",
       "      <td>2017-08-10 19:09:30</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SLIT Vials Mixed for New Patients</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>43540</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>April</td>\n",
       "      <td>2017-04-26 17:37:04</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>83059</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-17 20:31:13</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td># SCIT Vials Mixed for New Patients</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329830</th>\n",
       "      <td>7926</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-17 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329831</th>\n",
       "      <td>8683</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-17 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329832</th>\n",
       "      <td>17255</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-17 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329833</th>\n",
       "      <td>8308</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329834</th>\n",
       "      <td>17353</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329835</th>\n",
       "      <td>17109</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-18 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329836</th>\n",
       "      <td>2430</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329837</th>\n",
       "      <td>2430</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329838</th>\n",
       "      <td>6561</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329839</th>\n",
       "      <td>6561</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329840</th>\n",
       "      <td>2982</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329841</th>\n",
       "      <td>2982</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329842</th>\n",
       "      <td>17187</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329843</th>\n",
       "      <td>17187</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329844</th>\n",
       "      <td>17333</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329845</th>\n",
       "      <td>17333</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329846</th>\n",
       "      <td>17230</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329847</th>\n",
       "      <td>17230</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329848</th>\n",
       "      <td>11256</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329849</th>\n",
       "      <td>11112</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329850</th>\n",
       "      <td>10833</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329851</th>\n",
       "      <td>10833</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329852</th>\n",
       "      <td>2297</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329853</th>\n",
       "      <td>2297</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329854</th>\n",
       "      <td>2297</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td></td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329855</th>\n",
       "      <td>890</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329856</th>\n",
       "      <td>890</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329857</th>\n",
       "      <td>17253</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329858</th>\n",
       "      <td>17253</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>329859</th>\n",
       "      <td>17231</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125.0</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2017-01-20 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of Total SCIT Vials Mixed</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Group4</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>356904 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Patients_Tested  practice_id  \\\n",
       "0                 80012           16   \n",
       "1                 43227           16   \n",
       "2                 43279           16   \n",
       "3                 28230           16   \n",
       "4                 68035           16   \n",
       "5                 82742           16   \n",
       "6                 43538           16   \n",
       "7                 28668           16   \n",
       "8                 43447           16   \n",
       "9                 43999           16   \n",
       "10                41266           16   \n",
       "11                33845           16   \n",
       "12                34220           16   \n",
       "13                44385           16   \n",
       "14                78795           16   \n",
       "15                90026           16   \n",
       "16                64397           16   \n",
       "17                83999           16   \n",
       "18                28830           16   \n",
       "19                84315           16   \n",
       "20                87833           16   \n",
       "21                38798           16   \n",
       "22                68030           16   \n",
       "23                33747           16   \n",
       "24                68036           16   \n",
       "25                85723           16   \n",
       "26                33970           16   \n",
       "27                66755           16   \n",
       "28                43540           16   \n",
       "29                83059           16   \n",
       "...                 ...          ...   \n",
       "329830             7926           36   \n",
       "329831             8683           36   \n",
       "329832            17255           36   \n",
       "329833             8308           36   \n",
       "329834            17353           36   \n",
       "329835            17109           36   \n",
       "329836             2430           36   \n",
       "329837             2430           36   \n",
       "329838             6561           36   \n",
       "329839             6561           36   \n",
       "329840             2982           36   \n",
       "329841             2982           36   \n",
       "329842            17187           36   \n",
       "329843            17187           36   \n",
       "329844            17333           36   \n",
       "329845            17333           36   \n",
       "329846            17230           36   \n",
       "329847            17230           36   \n",
       "329848            11256           36   \n",
       "329849            11112           36   \n",
       "329850            10833           36   \n",
       "329851            10833           36   \n",
       "329852             2297           36   \n",
       "329853             2297           36   \n",
       "329854             2297           36   \n",
       "329855              890           36   \n",
       "329856              890           36   \n",
       "329857            17253           36   \n",
       "329858            17253           36   \n",
       "329859            17231           36   \n",
       "\n",
       "                                           practice_name  location_id  \\\n",
       "0       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "1       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "2       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "3       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "4       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "5       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "6       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "7       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "8       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "9       Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "10      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "11      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "12      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "13      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "14      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "15      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "16      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "17      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "18      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "19      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "20      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "21      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "22      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "23      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "24      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "25      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "26      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "27      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "28      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "29      Charlotte Eye Ear Nose & Throat Associates, P.A.          NaN   \n",
       "...                                                  ...          ...   \n",
       "329830                                       Augusta ENT        125.0   \n",
       "329831                                       Augusta ENT        125.0   \n",
       "329832                                       Augusta ENT        125.0   \n",
       "329833                                       Augusta ENT        125.0   \n",
       "329834                                       Augusta ENT        125.0   \n",
       "329835                                       Augusta ENT        125.0   \n",
       "329836                                       Augusta ENT        125.0   \n",
       "329837                                       Augusta ENT        125.0   \n",
       "329838                                       Augusta ENT        125.0   \n",
       "329839                                       Augusta ENT        125.0   \n",
       "329840                                       Augusta ENT        125.0   \n",
       "329841                                       Augusta ENT        125.0   \n",
       "329842                                       Augusta ENT        125.0   \n",
       "329843                                       Augusta ENT        125.0   \n",
       "329844                                       Augusta ENT        125.0   \n",
       "329845                                       Augusta ENT        125.0   \n",
       "329846                                       Augusta ENT        125.0   \n",
       "329847                                       Augusta ENT        125.0   \n",
       "329848                                       Augusta ENT        125.0   \n",
       "329849                                       Augusta ENT        125.0   \n",
       "329850                                       Augusta ENT        125.0   \n",
       "329851                                       Augusta ENT        125.0   \n",
       "329852                                       Augusta ENT        125.0   \n",
       "329853                                       Augusta ENT        125.0   \n",
       "329854                                       Augusta ENT        125.0   \n",
       "329855                                       Augusta ENT        125.0   \n",
       "329856                                       Augusta ENT        125.0   \n",
       "329857                                       Augusta ENT        125.0   \n",
       "329858                                       Augusta ENT        125.0   \n",
       "329859                                       Augusta ENT        125.0   \n",
       "\n",
       "                            location_name  test_date          month_year  \\\n",
       "0       North Charleston (reference-only)    October 2017-10-04 19:12:14   \n",
       "1       North Charleston (reference-only)      April 2017-04-19 18:58:12   \n",
       "2       North Charleston (reference-only)      April 2017-04-20 19:02:35   \n",
       "3       North Charleston (reference-only)   November 2017-11-03 19:40:04   \n",
       "4       North Charleston (reference-only)  September 2017-09-06 18:54:51   \n",
       "5       North Charleston (reference-only)    October 2017-10-13 18:53:36   \n",
       "6       North Charleston (reference-only)      April 2017-04-26 17:36:51   \n",
       "7       North Charleston (reference-only)       July 2017-07-11 17:30:29   \n",
       "8       North Charleston (reference-only)  September 2017-09-14 19:35:42   \n",
       "9       North Charleston (reference-only)        May 2017-05-03 19:12:07   \n",
       "10      North Charleston (reference-only)       July 2017-07-17 17:06:05   \n",
       "11      North Charleston (reference-only)     August 2017-08-17 17:38:52   \n",
       "12      North Charleston (reference-only)   November 2017-11-20 19:22:49   \n",
       "13      North Charleston (reference-only)        May 2017-05-11 17:06:31   \n",
       "14      North Charleston (reference-only)  September 2017-09-27 19:23:44   \n",
       "15      North Charleston (reference-only)    January 2018-01-02 19:43:44   \n",
       "16      North Charleston (reference-only)     August 2017-08-01 19:54:16   \n",
       "17      North Charleston (reference-only)    October 2017-10-30 19:44:02   \n",
       "18      North Charleston (reference-only)    October 2017-10-06 19:18:08   \n",
       "19      North Charleston (reference-only)   November 2017-11-02 20:06:11   \n",
       "20      North Charleston (reference-only)   December 2017-12-06 21:03:09   \n",
       "21      North Charleston (reference-only)       July 2017-07-03 18:13:52   \n",
       "22      North Charleston (reference-only)  September 2017-09-06 18:54:29   \n",
       "23      North Charleston (reference-only)       July 2017-07-05 16:27:51   \n",
       "24      North Charleston (reference-only)  September 2017-09-06 18:54:54   \n",
       "25      North Charleston (reference-only)   November 2017-11-07 21:35:43   \n",
       "26      North Charleston (reference-only)  September 2017-09-07 20:39:39   \n",
       "27      North Charleston (reference-only)     August 2017-08-10 19:09:30   \n",
       "28      North Charleston (reference-only)      April 2017-04-26 17:37:04   \n",
       "29      North Charleston (reference-only)    October 2017-10-17 20:31:13   \n",
       "...                                   ...        ...                 ...   \n",
       "329830                           Downtown    January 2017-01-17 00:00:00   \n",
       "329831                           Downtown    January 2017-01-17 00:00:00   \n",
       "329832                           Downtown    January 2017-01-17 00:00:00   \n",
       "329833                           Downtown    January 2017-01-20 00:00:00   \n",
       "329834                           Downtown    January 2017-01-20 00:00:00   \n",
       "329835                           Downtown    January 2017-01-18 00:00:00   \n",
       "329836                           Downtown    January 2017-01-20 00:00:00   \n",
       "329837                           Downtown    January 2017-01-20 00:00:00   \n",
       "329838                           Downtown    January 2017-01-20 00:00:00   \n",
       "329839                           Downtown    January 2017-01-20 00:00:00   \n",
       "329840                           Downtown    January 2017-01-20 00:00:00   \n",
       "329841                           Downtown    January 2017-01-20 00:00:00   \n",
       "329842                           Downtown    January 2017-01-20 00:00:00   \n",
       "329843                           Downtown    January 2017-01-20 00:00:00   \n",
       "329844                           Downtown    January 2017-01-20 00:00:00   \n",
       "329845                           Downtown    January 2017-01-20 00:00:00   \n",
       "329846                           Downtown    January 2017-01-20 00:00:00   \n",
       "329847                           Downtown    January 2017-01-20 00:00:00   \n",
       "329848                           Downtown    January 2017-01-20 00:00:00   \n",
       "329849                           Downtown    January 2017-01-20 00:00:00   \n",
       "329850                           Downtown    January 2017-01-20 00:00:00   \n",
       "329851                           Downtown    January 2017-01-20 00:00:00   \n",
       "329852                           Downtown    January 2017-01-20 00:00:00   \n",
       "329853                           Downtown    January 2017-01-20 00:00:00   \n",
       "329854                           Downtown    January 2017-01-20 00:00:00   \n",
       "329855                           Downtown    January 2017-01-20 00:00:00   \n",
       "329856                           Downtown    January 2017-01-20 00:00:00   \n",
       "329857                           Downtown    January 2017-01-20 00:00:00   \n",
       "329858                           Downtown    January 2017-01-20 00:00:00   \n",
       "329859                           Downtown    January 2017-01-20 00:00:00   \n",
       "\n",
       "                  provider                                 type  \\\n",
       "0         Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "1        Caldwell, William  # SLIT Vials Mixed for New Patients   \n",
       "2         Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "3           Harley, Robert  # SCIT Vials Mixed for New Patients   \n",
       "4         Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "5         Miltich, Michael  # SCIT Vials Mixed for New Patients   \n",
       "6         Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "7           Moss, Jonathan  # SCIT Vials Mixed for New Patients   \n",
       "8           Reulbach, Todd  # SCIT Vials Mixed for New Patients   \n",
       "9         Gibson, F. Brian  # SCIT Vials Mixed for New Patients   \n",
       "10            Weigel, Mark  # SCIT Vials Mixed for New Patients   \n",
       "11        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "12        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "13        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "14        Parsons, Gregory  # SLIT Vials Mixed for New Patients   \n",
       "15        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "16        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "17       Ego-Osuala, Bryan  # SCIT Vials Mixed for New Patients   \n",
       "18         Sicard, Michael  # SCIT Vials Mixed for New Patients   \n",
       "19        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "20       Cain-Saint, Faith  # SCIT Vials Mixed for New Patients   \n",
       "21               Jones, CT  # SCIT Vials Mixed for New Patients   \n",
       "22        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "23               Jones, CT  # SCIT Vials Mixed for New Patients   \n",
       "24        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "25        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "26        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "27        Parsons, Gregory  # SLIT Vials Mixed for New Patients   \n",
       "28        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "29        Parsons, Gregory  # SCIT Vials Mixed for New Patients   \n",
       "...                    ...                                  ...   \n",
       "329830  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329831                              # of Total SCIT Vials Mixed   \n",
       "329832                              # of Total SCIT Vials Mixed   \n",
       "329833  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329834  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329835                              # of Total SCIT Vials Mixed   \n",
       "329836  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329837  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329838                              # of Total SCIT Vials Mixed   \n",
       "329839                              # of Total SCIT Vials Mixed   \n",
       "329840      Wells, William          # of Total SCIT Vials Mixed   \n",
       "329841      Wells, William          # of Total SCIT Vials Mixed   \n",
       "329842  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329843  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329844                              # of Total SCIT Vials Mixed   \n",
       "329845                              # of Total SCIT Vials Mixed   \n",
       "329846  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329847  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329848                              # of Total SCIT Vials Mixed   \n",
       "329849   Esselman, Gregory          # of Total SCIT Vials Mixed   \n",
       "329850                              # of Total SCIT Vials Mixed   \n",
       "329851                              # of Total SCIT Vials Mixed   \n",
       "329852                              # of Total SCIT Vials Mixed   \n",
       "329853                              # of Total SCIT Vials Mixed   \n",
       "329854                              # of Total SCIT Vials Mixed   \n",
       "329855   Esselman, Gregory          # of Total SCIT Vials Mixed   \n",
       "329856   Esselman, Gregory          # of Total SCIT Vials Mixed   \n",
       "329857  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329858  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "329859  McMenamin, Patrick          # of Total SCIT Vials Mixed   \n",
       "\n",
       "       benchmark_date grouping  \n",
       "0             10-2017   Group3  \n",
       "1             04-2017   Group3  \n",
       "2             04-2017   Group3  \n",
       "3             11-2017   Group3  \n",
       "4             09-2017   Group3  \n",
       "5             10-2017   Group3  \n",
       "6             04-2017   Group3  \n",
       "7             07-2017   Group3  \n",
       "8             09-2017   Group3  \n",
       "9             05-2017   Group3  \n",
       "10            07-2017   Group3  \n",
       "11            08-2017   Group3  \n",
       "12            11-2017   Group3  \n",
       "13            05-2017   Group3  \n",
       "14            09-2017   Group3  \n",
       "15            01-2018   Group3  \n",
       "16            08-2017   Group3  \n",
       "17            10-2017   Group3  \n",
       "18            10-2017   Group3  \n",
       "19            11-2017   Group3  \n",
       "20            12-2017   Group3  \n",
       "21            07-2017   Group3  \n",
       "22            09-2017   Group3  \n",
       "23            07-2017   Group3  \n",
       "24            09-2017   Group3  \n",
       "25            11-2017   Group3  \n",
       "26            09-2017   Group3  \n",
       "27            08-2017   Group3  \n",
       "28            04-2017   Group3  \n",
       "29            10-2017   Group3  \n",
       "...               ...      ...  \n",
       "329830        01-2017   Group4  \n",
       "329831        01-2017   Group4  \n",
       "329832        01-2017   Group4  \n",
       "329833        01-2017   Group4  \n",
       "329834        01-2017   Group4  \n",
       "329835        01-2017   Group4  \n",
       "329836        01-2017   Group4  \n",
       "329837        01-2017   Group4  \n",
       "329838        01-2017   Group4  \n",
       "329839        01-2017   Group4  \n",
       "329840        01-2017   Group4  \n",
       "329841        01-2017   Group4  \n",
       "329842        01-2017   Group4  \n",
       "329843        01-2017   Group4  \n",
       "329844        01-2017   Group4  \n",
       "329845        01-2017   Group4  \n",
       "329846        01-2017   Group4  \n",
       "329847        01-2017   Group4  \n",
       "329848        01-2017   Group4  \n",
       "329849        01-2017   Group4  \n",
       "329850        01-2017   Group4  \n",
       "329851        01-2017   Group4  \n",
       "329852        01-2017   Group4  \n",
       "329853        01-2017   Group4  \n",
       "329854        01-2017   Group4  \n",
       "329855        01-2017   Group4  \n",
       "329856        01-2017   Group4  \n",
       "329857        01-2017   Group4  \n",
       "329858        01-2017   Group4  \n",
       "329859        01-2017   Group4  \n",
       "\n",
       "[356904 rows x 11 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "'''\n",
    "Distinct patients who got a vial made (doesn't inlcude if multiple vials were made for the same patient\n",
    "'''\n",
    "vials = pd.read_sql_query(\"SELECT DISTINCT q.patient as Patients_Tested, q.practice_ID as practice_id, q.Practice_name as practice_name, q.Location_ID as location_id, q.Name as location_name, monthname(q.test_date) as test_date, q.test_date as month_year, concat_ws(', ', pd.lastname, pd.firstname) as provider, z.intake_method as type FROM ((select distinct(a.patient_id) as patient, a.Test_Date as test_date, a.location_ID, d.Name, a.practice_id, i.name as Practice_name from intradermal_tests a INNER JOIN practice_locations d ON a.Location_ID = d.id INNER JOIN practices i on a.practice_id = i.id where a.Test_Date BETWEEN %(PSD)s AND %(PED)s AND (a.Status IS NULL OR a.Status <> 'deleted')) UNION (select distinct(b.patient_id) as patient, b.Test_Date as test_date, b.location_id, e.Name, b.practice_id, i.name as Practice_name from mq_tests b INNER JOIN practice_locations e ON b.Location_ID = e.id INNER JOIN practices i on b.practice_id = i.id where b.Test_Date BETWEEN %(PSD)s AND %(PED)s AND (b.Status IS NULL OR b.Status <> 'deleted')) UNION (select distinct(c.patient_id) as patient, c.Test_Date as test_date, c.location_id, f.Name, c.practice_id, i.name as Practice_name from prick_tests c INNER JOIN practice_locations f ON c.location_id = f.id INNER JOIN practices i on c.practice_id = i.id where c.Test_Date BETWEEN %(PSD)s AND %(PED)s AND (c.Status IS NULL OR c.Status <> 'deleted')) UNION (select distinct(g.patient_id) as patient, g.Start_Date as test_date, g.Start_Location_id AS Location_ID, h.name, g.start_practice_id, i.name as Practice_name from ige_tests g INNER JOIN practice_locations h ON g.start_practice_id = h.ID INNER JOIN practices i on g.start_practice_id = i.id where g.Start_Date BETWEEN %(PSD)s AND %(PED)s AND (g.Status = 'Complete')) order by Location_ID) q LEFT JOIN (SELECT DISTINCT barcode, Patient_ID FROM vials WHERE (status_id <> 2 or status_id is not null) and is_child <> 1 AND Mix_Date BETWEEN %(PSD)s AND %(PED)s) v ON q.patient = v.Patient_ID LEFT JOIN (SELECT id, intake_method, mix_practice_doctor_id FROM patients) z on q.patient = z.id LEFT JOIN practice_doctors pd on z.mix_practice_doctor_id = pd.id where v.Patient_ID is not null and q.practice_id <> 9\", myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "'''\n",
    "Total Number of vials mixed for each patient, a patient could have multiple vials mixed here\n",
    "'''\n",
    "vials_total = pd.read_sql_query(\"SELECT DISTINCT(v.barcode) AS barcode, v.patient_id as Patients_Tested, v.mix_practice_id as practice_id, b.name as practice_name, v.mix_location_id as location_id, a.Name as location_name, vn.name, vs.status, monthname(v.Mix_date) as test_date, v.Mix_Date as month_year, concat_ws(', ', pd.lastname, pd.firstname) as provider, z.intake_method as type FROM vials v INNER JOIN vial_names vn ON v.id=vn.vial_id INNER JOIN vial_statuses vs on v.status_id = vs.id INNER JOIN patients z on v.patient_id = z.id left join users u on if(v.created_by is null, v.mixer_id, v.created_by) = u.id INNER join practice_locations a on v.mix_location_id = a.id INNER join practices b on v.mix_practice_id = b.id LEFT JOIN practice_doctors pd on z.mix_practice_doctor_id = pd.id where (v.is_child = 0 OR v.is_child IS null OR (v.is_child = 1 and v.from_titrated = 1)) AND v.Mix_Date BETWEEN %(PSD)s AND %(PED)s and (z.mix_practice_id <> 9 OR z.shot_practice_id <> 9) ORDER BY barcode\", myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "vials['benchmark_date'] = vials['month_year'].dt.strftime('%m-%Y')\n",
    "vials_total['benchmark_date'] = vials_total['month_year'].dt.strftime('%m-%Y')\n",
    "inj_vial_index = vials.type == 'inj'\n",
    "sub_vial_index = vials.type == 'sub'\n",
    "unk_vial_index = vials.type == 'unk'\n",
    "vials.loc[inj_vial_index, 'type'] = '# SCIT Vials Mixed for New Patients'\n",
    "vials.loc[sub_vial_index, 'type'] = '# SLIT Vials Mixed for New Patients'\n",
    "vials.loc[unk_vial_index, 'type'] = '# Unknown Vials Mixed for New Patients'\n",
    "inj_vial_index = vials_total.type == 'inj'\n",
    "sub_vial_index = vials_total.type == 'sub'\n",
    "unk_vial_index = vials_total.type == 'unk'\n",
    "vials_total.loc[inj_vial_index, 'type'] = '# of Total SCIT Vials Mixed'\n",
    "vials_total.loc[sub_vial_index, 'type'] = '# of Total SLIT Vials Mixed'\n",
    "vials_total.loc[unk_vial_index, 'type'] = '# of Total Unknown Vials Mixed'\n",
    "vials['grouping'] = 'Group3'\n",
    "vials_total.drop(['barcode', 'name', 'status'], 1, inplace=True)\n",
    "vials_total['grouping'] = 'Group4'\n",
    "all_vials = pd.concat([vials, vials_total], axis=0)\n",
    "#all_vials.to_excel('AllergyEDGE Tests Examples Vials.xlsx')\n",
    "all_vials"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-02 14:33:56</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-02 14:33:56</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-19 16:11:34</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-19 16:11:34</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-22 19:53:22</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-22 19:53:22</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-27 20:02:07</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-27 20:02:07</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>February</td>\n",
       "      <td>2015-02-03 19:58:23</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>February</td>\n",
       "      <td>2015-02-03 19:58:23</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>February</td>\n",
       "      <td>2015-02-12 20:00:17</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>February</td>\n",
       "      <td>2015-02-12 20:00:17</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>February</td>\n",
       "      <td>2015-02-23 21:09:08</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>February</td>\n",
       "      <td>2015-02-23 21:09:08</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-03 20:10:01</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-03 20:10:01</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-10 20:05:20</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-10 20:05:20</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-16 19:57:54</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-16 19:57:54</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-25 20:06:45</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-25 20:06:45</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-31 20:15:09</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-31 20:15:09</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-06 18:34:20</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-06 18:34:20</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-13 20:15:12</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-13 20:15:12</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-29 20:39:57</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>78</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124.0</td>\n",
       "      <td>Evans</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-29 20:39:57</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660505</th>\n",
       "      <td>49089</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:44:55</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660506</th>\n",
       "      <td>53285</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:45:22</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660507</th>\n",
       "      <td>53285</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:45:32</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660508</th>\n",
       "      <td>53285</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:45:47</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660509</th>\n",
       "      <td>52828</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:46:13</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660510</th>\n",
       "      <td>52828</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:46:21</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660511</th>\n",
       "      <td>16742</td>\n",
       "      <td>48</td>\n",
       "      <td>Mile High Family Medicine</td>\n",
       "      <td>162.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:46:21</td>\n",
       "      <td>Rohweder, Daniel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660512</th>\n",
       "      <td>16046</td>\n",
       "      <td>45</td>\n",
       "      <td>Cache Valley Ear Nose &amp; Throat</td>\n",
       "      <td>157.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:46:23</td>\n",
       "      <td>Bennion, Jeffrey</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660513</th>\n",
       "      <td>52828</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:46:36</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660514</th>\n",
       "      <td>15087</td>\n",
       "      <td>45</td>\n",
       "      <td>Cache Valley Ear Nose &amp; Throat</td>\n",
       "      <td>157.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:47:31</td>\n",
       "      <td>Bennion, Jeffrey</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660515</th>\n",
       "      <td>15087</td>\n",
       "      <td>45</td>\n",
       "      <td>Cache Valley Ear Nose &amp; Throat</td>\n",
       "      <td>157.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:47:38</td>\n",
       "      <td>Bennion, Jeffrey</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660516</th>\n",
       "      <td>46346</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>201.0</td>\n",
       "      <td>Huntersville</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:48:56</td>\n",
       "      <td>Reulbach, Todd</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660517</th>\n",
       "      <td>46346</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>201.0</td>\n",
       "      <td>Huntersville</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:49:10</td>\n",
       "      <td>Reulbach, Todd</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660518</th>\n",
       "      <td>36916</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>201.0</td>\n",
       "      <td>Huntersville</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:49:38</td>\n",
       "      <td>Reulbach, Todd</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660519</th>\n",
       "      <td>36916</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>201.0</td>\n",
       "      <td>Huntersville</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:49:42</td>\n",
       "      <td>Reulbach, Todd</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660520</th>\n",
       "      <td>41425</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>201.0</td>\n",
       "      <td>Huntersville</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:50:30</td>\n",
       "      <td>Weigel, Mark</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660521</th>\n",
       "      <td>41425</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>201.0</td>\n",
       "      <td>Huntersville</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:50:42</td>\n",
       "      <td>Weigel, Mark</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660522</th>\n",
       "      <td>62832</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:52:59</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660523</th>\n",
       "      <td>62832</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:53:12</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660524</th>\n",
       "      <td>62832</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:53:30</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660525</th>\n",
       "      <td>56860</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:53:30</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660526</th>\n",
       "      <td>56860</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:53:42</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660527</th>\n",
       "      <td>56860</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>230.0</td>\n",
       "      <td>Katy Methodist</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:53:57</td>\n",
       "      <td>Anthis, Joel</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660528</th>\n",
       "      <td>194047</td>\n",
       "      <td>51</td>\n",
       "      <td>Western Washington Medical Group</td>\n",
       "      <td>181.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:56:04</td>\n",
       "      <td>Epperson, Rebecca</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660529</th>\n",
       "      <td>194047</td>\n",
       "      <td>51</td>\n",
       "      <td>Western Washington Medical Group</td>\n",
       "      <td>181.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:56:09</td>\n",
       "      <td>Epperson, Rebecca</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660530</th>\n",
       "      <td>16788</td>\n",
       "      <td>48</td>\n",
       "      <td>Mile High Family Medicine</td>\n",
       "      <td>162.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:56:20</td>\n",
       "      <td>Cheung, Terry</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660531</th>\n",
       "      <td>16788</td>\n",
       "      <td>48</td>\n",
       "      <td>Mile High Family Medicine</td>\n",
       "      <td>162.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:56:24</td>\n",
       "      <td>Cheung, Terry</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660532</th>\n",
       "      <td>46135</td>\n",
       "      <td>45</td>\n",
       "      <td>Cache Valley Ear Nose &amp; Throat</td>\n",
       "      <td>157.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:56:47</td>\n",
       "      <td>Grange, Jamie</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660533</th>\n",
       "      <td>46135</td>\n",
       "      <td>45</td>\n",
       "      <td>Cache Valley Ear Nose &amp; Throat</td>\n",
       "      <td>157.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:56:52</td>\n",
       "      <td>Grange, Jamie</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1660534</th>\n",
       "      <td>24238</td>\n",
       "      <td>45</td>\n",
       "      <td>Cache Valley Ear Nose &amp; Throat</td>\n",
       "      <td>157.0</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:59:56</td>\n",
       "      <td>Humes, Lindsay</td>\n",
       "      <td># of Injections</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1660535 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Patients_Tested  practice_id  \\\n",
       "0                     77           36   \n",
       "1                     77           36   \n",
       "2                     78           36   \n",
       "3                     78           36   \n",
       "4                     78           36   \n",
       "5                     78           36   \n",
       "6                     78           36   \n",
       "7                     78           36   \n",
       "8                     78           36   \n",
       "9                     78           36   \n",
       "10                    78           36   \n",
       "11                    78           36   \n",
       "12                    78           36   \n",
       "13                    78           36   \n",
       "14                    78           36   \n",
       "15                    78           36   \n",
       "16                    78           36   \n",
       "17                    78           36   \n",
       "18                    78           36   \n",
       "19                    78           36   \n",
       "20                    78           36   \n",
       "21                    78           36   \n",
       "22                    78           36   \n",
       "23                    78           36   \n",
       "24                    78           36   \n",
       "25                    78           36   \n",
       "26                    78           36   \n",
       "27                    78           36   \n",
       "28                    78           36   \n",
       "29                    78           36   \n",
       "...                  ...          ...   \n",
       "1660505            49089           13   \n",
       "1660506            53285           13   \n",
       "1660507            53285           13   \n",
       "1660508            53285           13   \n",
       "1660509            52828           13   \n",
       "1660510            52828           13   \n",
       "1660511            16742           48   \n",
       "1660512            16046           45   \n",
       "1660513            52828           13   \n",
       "1660514            15087           45   \n",
       "1660515            15087           45   \n",
       "1660516            46346           16   \n",
       "1660517            46346           16   \n",
       "1660518            36916           16   \n",
       "1660519            36916           16   \n",
       "1660520            41425           16   \n",
       "1660521            41425           16   \n",
       "1660522            62832           13   \n",
       "1660523            62832           13   \n",
       "1660524            62832           13   \n",
       "1660525            56860           13   \n",
       "1660526            56860           13   \n",
       "1660527            56860           13   \n",
       "1660528           194047           51   \n",
       "1660529           194047           51   \n",
       "1660530            16788           48   \n",
       "1660531            16788           48   \n",
       "1660532            46135           45   \n",
       "1660533            46135           45   \n",
       "1660534            24238           45   \n",
       "\n",
       "                                            practice_name  location_id  \\\n",
       "0                                             Augusta ENT        124.0   \n",
       "1                                             Augusta ENT        124.0   \n",
       "2                                             Augusta ENT        124.0   \n",
       "3                                             Augusta ENT        124.0   \n",
       "4                                             Augusta ENT        124.0   \n",
       "5                                             Augusta ENT        124.0   \n",
       "6                                             Augusta ENT        124.0   \n",
       "7                                             Augusta ENT        124.0   \n",
       "8                                             Augusta ENT        124.0   \n",
       "9                                             Augusta ENT        124.0   \n",
       "10                                            Augusta ENT        124.0   \n",
       "11                                            Augusta ENT        124.0   \n",
       "12                                            Augusta ENT        124.0   \n",
       "13                                            Augusta ENT        124.0   \n",
       "14                                            Augusta ENT        124.0   \n",
       "15                                            Augusta ENT        124.0   \n",
       "16                                            Augusta ENT        124.0   \n",
       "17                                            Augusta ENT        124.0   \n",
       "18                                            Augusta ENT        124.0   \n",
       "19                                            Augusta ENT        124.0   \n",
       "20                                            Augusta ENT        124.0   \n",
       "21                                            Augusta ENT        124.0   \n",
       "22                                            Augusta ENT        124.0   \n",
       "23                                            Augusta ENT        124.0   \n",
       "24                                            Augusta ENT        124.0   \n",
       "25                                            Augusta ENT        124.0   \n",
       "26                                            Augusta ENT        124.0   \n",
       "27                                            Augusta ENT        124.0   \n",
       "28                                            Augusta ENT        124.0   \n",
       "29                                            Augusta ENT        124.0   \n",
       "...                                                   ...          ...   \n",
       "1660505                                         Texas ENT        230.0   \n",
       "1660506                                         Texas ENT        230.0   \n",
       "1660507                                         Texas ENT        230.0   \n",
       "1660508                                         Texas ENT        230.0   \n",
       "1660509                                         Texas ENT        230.0   \n",
       "1660510                                         Texas ENT        230.0   \n",
       "1660511                        Mile High Family Medicine         162.0   \n",
       "1660512                    Cache Valley Ear Nose & Throat        157.0   \n",
       "1660513                                         Texas ENT        230.0   \n",
       "1660514                    Cache Valley Ear Nose & Throat        157.0   \n",
       "1660515                    Cache Valley Ear Nose & Throat        157.0   \n",
       "1660516  Charlotte Eye Ear Nose & Throat Associates, P.A.        201.0   \n",
       "1660517  Charlotte Eye Ear Nose & Throat Associates, P.A.        201.0   \n",
       "1660518  Charlotte Eye Ear Nose & Throat Associates, P.A.        201.0   \n",
       "1660519  Charlotte Eye Ear Nose & Throat Associates, P.A.        201.0   \n",
       "1660520  Charlotte Eye Ear Nose & Throat Associates, P.A.        201.0   \n",
       "1660521  Charlotte Eye Ear Nose & Throat Associates, P.A.        201.0   \n",
       "1660522                                         Texas ENT        230.0   \n",
       "1660523                                         Texas ENT        230.0   \n",
       "1660524                                         Texas ENT        230.0   \n",
       "1660525                                         Texas ENT        230.0   \n",
       "1660526                                         Texas ENT        230.0   \n",
       "1660527                                         Texas ENT        230.0   \n",
       "1660528                  Western Washington Medical Group        181.0   \n",
       "1660529                  Western Washington Medical Group        181.0   \n",
       "1660530                        Mile High Family Medicine         162.0   \n",
       "1660531                        Mile High Family Medicine         162.0   \n",
       "1660532                    Cache Valley Ear Nose & Throat        157.0   \n",
       "1660533                    Cache Valley Ear Nose & Throat        157.0   \n",
       "1660534                    Cache Valley Ear Nose & Throat        157.0   \n",
       "\n",
       "          location_name test_date          month_year              provider  \\\n",
       "0                 Evans  November 2015-11-02 14:33:56  Vickery, Christopher   \n",
       "1                 Evans  November 2015-11-02 14:33:56  Vickery, Christopher   \n",
       "2                 Evans   January 2015-01-19 16:11:34           Owen, Ralph   \n",
       "3                 Evans   January 2015-01-19 16:11:34           Owen, Ralph   \n",
       "4                 Evans   January 2015-01-22 19:53:22           Owen, Ralph   \n",
       "5                 Evans   January 2015-01-22 19:53:22           Owen, Ralph   \n",
       "6                 Evans   January 2015-01-27 20:02:07           Owen, Ralph   \n",
       "7                 Evans   January 2015-01-27 20:02:07           Owen, Ralph   \n",
       "8                 Evans  February 2015-02-03 19:58:23           Owen, Ralph   \n",
       "9                 Evans  February 2015-02-03 19:58:23           Owen, Ralph   \n",
       "10                Evans  February 2015-02-12 20:00:17           Owen, Ralph   \n",
       "11                Evans  February 2015-02-12 20:00:17           Owen, Ralph   \n",
       "12                Evans  February 2015-02-23 21:09:08           Owen, Ralph   \n",
       "13                Evans  February 2015-02-23 21:09:08           Owen, Ralph   \n",
       "14                Evans     March 2015-03-03 20:10:01           Owen, Ralph   \n",
       "15                Evans     March 2015-03-03 20:10:01           Owen, Ralph   \n",
       "16                Evans     March 2015-03-10 20:05:20           Owen, Ralph   \n",
       "17                Evans     March 2015-03-10 20:05:20           Owen, Ralph   \n",
       "18                Evans     March 2015-03-16 19:57:54           Owen, Ralph   \n",
       "19                Evans     March 2015-03-16 19:57:54           Owen, Ralph   \n",
       "20                Evans     March 2015-03-25 20:06:45           Owen, Ralph   \n",
       "21                Evans     March 2015-03-25 20:06:45           Owen, Ralph   \n",
       "22                Evans     March 2015-03-31 20:15:09           Owen, Ralph   \n",
       "23                Evans     March 2015-03-31 20:15:09           Owen, Ralph   \n",
       "24                Evans     April 2015-04-06 18:34:20           Owen, Ralph   \n",
       "25                Evans     April 2015-04-06 18:34:20           Owen, Ralph   \n",
       "26                Evans     April 2015-04-13 20:15:12           Owen, Ralph   \n",
       "27                Evans     April 2015-04-13 20:15:12           Owen, Ralph   \n",
       "28                Evans     April 2015-04-29 20:39:57           Owen, Ralph   \n",
       "29                Evans     April 2015-04-29 20:39:57           Owen, Ralph   \n",
       "...                 ...       ...                 ...                   ...   \n",
       "1660505  Katy Methodist  February 2018-02-28 23:44:55          Anthis, Joel   \n",
       "1660506  Katy Methodist  February 2018-02-28 23:45:22          Anthis, Joel   \n",
       "1660507  Katy Methodist  February 2018-02-28 23:45:32          Anthis, Joel   \n",
       "1660508  Katy Methodist  February 2018-02-28 23:45:47          Anthis, Joel   \n",
       "1660509  Katy Methodist  February 2018-02-28 23:46:13          Anthis, Joel   \n",
       "1660510  Katy Methodist  February 2018-02-28 23:46:21          Anthis, Joel   \n",
       "1660511            Main  February 2018-02-28 23:46:21      Rohweder, Daniel   \n",
       "1660512            Main  February 2018-02-28 23:46:23      Bennion, Jeffrey   \n",
       "1660513  Katy Methodist  February 2018-02-28 23:46:36          Anthis, Joel   \n",
       "1660514            Main  February 2018-02-28 23:47:31      Bennion, Jeffrey   \n",
       "1660515            Main  February 2018-02-28 23:47:38      Bennion, Jeffrey   \n",
       "1660516    Huntersville  February 2018-02-28 23:48:56        Reulbach, Todd   \n",
       "1660517    Huntersville  February 2018-02-28 23:49:10        Reulbach, Todd   \n",
       "1660518    Huntersville  February 2018-02-28 23:49:38        Reulbach, Todd   \n",
       "1660519    Huntersville  February 2018-02-28 23:49:42        Reulbach, Todd   \n",
       "1660520    Huntersville  February 2018-02-28 23:50:30          Weigel, Mark   \n",
       "1660521    Huntersville  February 2018-02-28 23:50:42          Weigel, Mark   \n",
       "1660522  Katy Methodist  February 2018-02-28 23:52:59     Brauchle, Randall   \n",
       "1660523  Katy Methodist  February 2018-02-28 23:53:12     Brauchle, Randall   \n",
       "1660524  Katy Methodist  February 2018-02-28 23:53:30     Brauchle, Randall   \n",
       "1660525  Katy Methodist  February 2018-02-28 23:53:30          Anthis, Joel   \n",
       "1660526  Katy Methodist  February 2018-02-28 23:53:42          Anthis, Joel   \n",
       "1660527  Katy Methodist  February 2018-02-28 23:53:57          Anthis, Joel   \n",
       "1660528            Main  February 2018-02-28 23:56:04     Epperson, Rebecca   \n",
       "1660529            Main  February 2018-02-28 23:56:09     Epperson, Rebecca   \n",
       "1660530            Main  February 2018-02-28 23:56:20         Cheung, Terry   \n",
       "1660531            Main  February 2018-02-28 23:56:24         Cheung, Terry   \n",
       "1660532            Main  February 2018-02-28 23:56:47         Grange, Jamie   \n",
       "1660533            Main  February 2018-02-28 23:56:52         Grange, Jamie   \n",
       "1660534            Main  February 2018-02-28 23:59:56        Humes, Lindsay   \n",
       "\n",
       "                    type benchmark_date grouping  \n",
       "0        # of Injections        11-2015   Group5  \n",
       "1        # of Injections        11-2015   Group5  \n",
       "2        # of Injections        01-2015   Group5  \n",
       "3        # of Injections        01-2015   Group5  \n",
       "4        # of Injections        01-2015   Group5  \n",
       "5        # of Injections        01-2015   Group5  \n",
       "6        # of Injections        01-2015   Group5  \n",
       "7        # of Injections        01-2015   Group5  \n",
       "8        # of Injections        02-2015   Group5  \n",
       "9        # of Injections        02-2015   Group5  \n",
       "10       # of Injections        02-2015   Group5  \n",
       "11       # of Injections        02-2015   Group5  \n",
       "12       # of Injections        02-2015   Group5  \n",
       "13       # of Injections        02-2015   Group5  \n",
       "14       # of Injections        03-2015   Group5  \n",
       "15       # of Injections        03-2015   Group5  \n",
       "16       # of Injections        03-2015   Group5  \n",
       "17       # of Injections        03-2015   Group5  \n",
       "18       # of Injections        03-2015   Group5  \n",
       "19       # of Injections        03-2015   Group5  \n",
       "20       # of Injections        03-2015   Group5  \n",
       "21       # of Injections        03-2015   Group5  \n",
       "22       # of Injections        03-2015   Group5  \n",
       "23       # of Injections        03-2015   Group5  \n",
       "24       # of Injections        04-2015   Group5  \n",
       "25       # of Injections        04-2015   Group5  \n",
       "26       # of Injections        04-2015   Group5  \n",
       "27       # of Injections        04-2015   Group5  \n",
       "28       # of Injections        04-2015   Group5  \n",
       "29       # of Injections        04-2015   Group5  \n",
       "...                  ...            ...      ...  \n",
       "1660505  # of Injections        02-2018   Group5  \n",
       "1660506  # of Injections        02-2018   Group5  \n",
       "1660507  # of Injections        02-2018   Group5  \n",
       "1660508  # of Injections        02-2018   Group5  \n",
       "1660509  # of Injections        02-2018   Group5  \n",
       "1660510  # of Injections        02-2018   Group5  \n",
       "1660511  # of Injections        02-2018   Group5  \n",
       "1660512  # of Injections        02-2018   Group5  \n",
       "1660513  # of Injections        02-2018   Group5  \n",
       "1660514  # of Injections        02-2018   Group5  \n",
       "1660515  # of Injections        02-2018   Group5  \n",
       "1660516  # of Injections        02-2018   Group5  \n",
       "1660517  # of Injections        02-2018   Group5  \n",
       "1660518  # of Injections        02-2018   Group5  \n",
       "1660519  # of Injections        02-2018   Group5  \n",
       "1660520  # of Injections        02-2018   Group5  \n",
       "1660521  # of Injections        02-2018   Group5  \n",
       "1660522  # of Injections        02-2018   Group5  \n",
       "1660523  # of Injections        02-2018   Group5  \n",
       "1660524  # of Injections        02-2018   Group5  \n",
       "1660525  # of Injections        02-2018   Group5  \n",
       "1660526  # of Injections        02-2018   Group5  \n",
       "1660527  # of Injections        02-2018   Group5  \n",
       "1660528  # of Injections        02-2018   Group5  \n",
       "1660529  # of Injections        02-2018   Group5  \n",
       "1660530  # of Injections        02-2018   Group5  \n",
       "1660531  # of Injections        02-2018   Group5  \n",
       "1660532  # of Injections        02-2018   Group5  \n",
       "1660533  # of Injections        02-2018   Group5  \n",
       "1660534  # of Injections        02-2018   Group5  \n",
       "\n",
       "[1660535 rows x 11 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_injections = pd.read_sql_query(\"select a.patient_id as Patients_Tested, b.practice_id, p.name as practice_name, pv.location_id, pl.name as location_name, monthname(a.date) as test_date, a.date as month_year, concat_ws(', ', pd.lastname, pd.firstname) as provider, 1 as type from patient_visits_shots a left join patients b on a.patient_id = b.id left join users c on c.id = a.shot_giver_id left join patient_visits pv on a.visit_id = pv.id left join practice_doctors pd on b.mix_practice_doctor_id = pd.id left join practices p on b.practice_id = p.id left join practice_locations pl on pv.location_id = pl.id WHERE b.practice_id <> 9 and a.active = 1 AND a.Date BETWEEN %(PSD)s AND %(PED)s and b.id is not null and c.id is not null\", myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "total_injections['benchmark_date'] = total_injections['month_year'].dt.strftime('%m-%Y')\n",
    "practice_id_index = total_injections.type == 1\n",
    "total_injections.loc[practice_id_index, 'type'] = '# of Injections'\n",
    "total_injections['grouping'] = 'Group5'\n",
    "#total_injections.to_excel('AllergyEDGE Tests Examples Injections.xlsx')\n",
    "total_injections"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>77</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>May</td>\n",
       "      <td>2015-05-13 00:00:00</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>117</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>May</td>\n",
       "      <td>2015-05-18 00:00:00</td>\n",
       "      <td>Lindman, Jonathan</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>145</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-21 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>154</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-07 00:00:00</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>159</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>July</td>\n",
       "      <td>2016-07-07 20:12:22</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>166</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-17 00:00:00</td>\n",
       "      <td>Kimbrough, James</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>176</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-27 00:00:00</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>183</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-27 00:00:00</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>190</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>May</td>\n",
       "      <td>2015-05-11 00:00:00</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>228</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>September</td>\n",
       "      <td>2015-09-10 00:00:00</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>256</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>July</td>\n",
       "      <td>2017-07-12 18:55:47</td>\n",
       "      <td>Ayers, Christopher</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>264</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-30 00:00:00</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>267</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-10 00:00:00</td>\n",
       "      <td>Ayers, Christopher</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>316</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>May</td>\n",
       "      <td>2015-05-15 00:00:00</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>407</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-06 22:10:48</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>427</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>March</td>\n",
       "      <td>2017-03-29 00:00:00</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>520</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-05 00:00:00</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>617</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>October</td>\n",
       "      <td>2015-10-26 00:00:00</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>10-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>645</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-21 00:00:00</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>668</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-31 00:00:00</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>703</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-21 00:00:00</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>766</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>August</td>\n",
       "      <td>2016-08-08 00:00:00</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>926</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>October</td>\n",
       "      <td>2017-10-10 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1006</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-19 19:12:31</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1133</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2018-01-08 20:51:32</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>1165</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>March</td>\n",
       "      <td>2015-03-12 00:00:00</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1170</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>July</td>\n",
       "      <td>2015-07-15 00:00:00</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>07-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1179</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>September</td>\n",
       "      <td>2016-09-26 00:00:00</td>\n",
       "      <td>Whitehouse, Alan</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1186</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-17 00:00:00</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>1231</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>June</td>\n",
       "      <td>2015-06-11 00:00:00</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>06-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24280</th>\n",
       "      <td>195821</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-26 00:00:00</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24281</th>\n",
       "      <td>196015</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-21 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24282</th>\n",
       "      <td>196017</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-27 15:56:08</td>\n",
       "      <td></td>\n",
       "      <td># of New Patients on Unknown</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24283</th>\n",
       "      <td>196042</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-16 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24284</th>\n",
       "      <td>196149</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 00:00:00</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24285</th>\n",
       "      <td>196177</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>January</td>\n",
       "      <td>2016-01-22 00:00:00</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>01-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24286</th>\n",
       "      <td>196191</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-01 00:00:00</td>\n",
       "      <td>Prichard, Christopher</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24287</th>\n",
       "      <td>196192</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>October</td>\n",
       "      <td>2015-10-05 00:00:00</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>10-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24288</th>\n",
       "      <td>196193</td>\n",
       "      <td>55</td>\n",
       "      <td>Bartlesville ENT</td>\n",
       "      <td>219</td>\n",
       "      <td>Bartlesville ENT</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-19 00:00:00</td>\n",
       "      <td>Holland, Charles</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24289</th>\n",
       "      <td>196194</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>May</td>\n",
       "      <td>2016-05-09 00:00:00</td>\n",
       "      <td>Craddock, John</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>05-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24290</th>\n",
       "      <td>196223</td>\n",
       "      <td>51</td>\n",
       "      <td>Western Washington Medical Group</td>\n",
       "      <td>181</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 00:00:00</td>\n",
       "      <td>Epperson, Rebecca</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24291</th>\n",
       "      <td>196234</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-28 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24292</th>\n",
       "      <td>196270</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 00:00:00</td>\n",
       "      <td>Ayers, Christopher</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24293</th>\n",
       "      <td>196405</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-20 00:00:00</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24294</th>\n",
       "      <td>196507</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-29 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24295</th>\n",
       "      <td>196523</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>August</td>\n",
       "      <td>2015-08-20 00:00:00</td>\n",
       "      <td>Craddock, John</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24296</th>\n",
       "      <td>196761</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>June</td>\n",
       "      <td>2017-06-02 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24297</th>\n",
       "      <td>196885</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-03 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24298</th>\n",
       "      <td>197082</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>November</td>\n",
       "      <td>2016-11-10 00:00:00</td>\n",
       "      <td>Prichard, Christopher</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>11-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24299</th>\n",
       "      <td>197098</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>March</td>\n",
       "      <td>2016-03-14 00:00:00</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>03-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24300</th>\n",
       "      <td>197101</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>April</td>\n",
       "      <td>2015-04-27 00:00:00</td>\n",
       "      <td>Craddock, John</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24301</th>\n",
       "      <td>197106</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>February</td>\n",
       "      <td>2017-02-15 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24302</th>\n",
       "      <td>197173</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>September</td>\n",
       "      <td>2016-09-27 00:00:00</td>\n",
       "      <td>Brauchle, Randall</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24303</th>\n",
       "      <td>197247</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>July</td>\n",
       "      <td>2016-07-26 00:00:00</td>\n",
       "      <td>Prichard, Christopher</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24304</th>\n",
       "      <td>197256</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>April</td>\n",
       "      <td>2016-04-20 00:00:00</td>\n",
       "      <td>Craddock, John</td>\n",
       "      <td># of New Patients on SLIT</td>\n",
       "      <td>04-2016</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24305</th>\n",
       "      <td>197471</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>June</td>\n",
       "      <td>2017-06-23 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24306</th>\n",
       "      <td>197838</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>May</td>\n",
       "      <td>2017-05-23 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24307</th>\n",
       "      <td>197843</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>February</td>\n",
       "      <td>2017-02-07 00:00:00</td>\n",
       "      <td>McMenamin, Patrick</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>02-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24308</th>\n",
       "      <td>197912</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2017-11-28 00:00:00</td>\n",
       "      <td>Esselman, Gregory</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24309</th>\n",
       "      <td>197956</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>September</td>\n",
       "      <td>2017-09-15 00:00:00</td>\n",
       "      <td>Ayers, Christopher</td>\n",
       "      <td># of New Patients on SCIT</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group6</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>24310 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Patients_Tested  practice_id                     practice_name  \\\n",
       "0                   77           36                       Augusta ENT   \n",
       "1                  117           36                       Augusta ENT   \n",
       "2                  145           36                       Augusta ENT   \n",
       "3                  154           36                       Augusta ENT   \n",
       "4                  159           36                       Augusta ENT   \n",
       "5                  166           36                       Augusta ENT   \n",
       "6                  176           36                       Augusta ENT   \n",
       "7                  183           36                       Augusta ENT   \n",
       "8                  190           36                       Augusta ENT   \n",
       "9                  228           36                       Augusta ENT   \n",
       "10                 256           36                       Augusta ENT   \n",
       "11                 264           36                       Augusta ENT   \n",
       "12                 267           36                       Augusta ENT   \n",
       "13                 316           36                       Augusta ENT   \n",
       "14                 407           36                       Augusta ENT   \n",
       "15                 427           36                       Augusta ENT   \n",
       "16                 520           36                       Augusta ENT   \n",
       "17                 617           36                       Augusta ENT   \n",
       "18                 645           36                       Augusta ENT   \n",
       "19                 668           36                       Augusta ENT   \n",
       "20                 703           36                       Augusta ENT   \n",
       "21                 766           36                       Augusta ENT   \n",
       "22                 926           36                       Augusta ENT   \n",
       "23                1006           36                       Augusta ENT   \n",
       "24                1133           36                       Augusta ENT   \n",
       "25                1165           36                       Augusta ENT   \n",
       "26                1170           36                       Augusta ENT   \n",
       "27                1179           36                       Augusta ENT   \n",
       "28                1186           36                       Augusta ENT   \n",
       "29                1231           36                       Augusta ENT   \n",
       "...                ...          ...                               ...   \n",
       "24280           195821           36                       Augusta ENT   \n",
       "24281           196015           36                       Augusta ENT   \n",
       "24282           196017           31            Advanced ENT & Allergy   \n",
       "24283           196042           36                       Augusta ENT   \n",
       "24284           196149           36                       Augusta ENT   \n",
       "24285           196177           13                         Texas ENT   \n",
       "24286           196191           13                         Texas ENT   \n",
       "24287           196192           13                         Texas ENT   \n",
       "24288           196193           55                 Bartlesville ENT    \n",
       "24289           196194           13                         Texas ENT   \n",
       "24290           196223           51  Western Washington Medical Group   \n",
       "24291           196234           36                       Augusta ENT   \n",
       "24292           196270           36                       Augusta ENT   \n",
       "24293           196405           13                         Texas ENT   \n",
       "24294           196507           36                       Augusta ENT   \n",
       "24295           196523           13                         Texas ENT   \n",
       "24296           196761           36                       Augusta ENT   \n",
       "24297           196885           36                       Augusta ENT   \n",
       "24298           197082           13                         Texas ENT   \n",
       "24299           197098           13                         Texas ENT   \n",
       "24300           197101           13                         Texas ENT   \n",
       "24301           197106           36                       Augusta ENT   \n",
       "24302           197173           13                         Texas ENT   \n",
       "24303           197247           13                         Texas ENT   \n",
       "24304           197256           13                         Texas ENT   \n",
       "24305           197471           36                       Augusta ENT   \n",
       "24306           197838           36                       Augusta ENT   \n",
       "24307           197843           36                       Augusta ENT   \n",
       "24308           197912           36                       Augusta ENT   \n",
       "24309           197956           36                       Augusta ENT   \n",
       "\n",
       "       location_id      location_name  test_date          month_year  \\\n",
       "0              125           Downtown        May 2015-05-13 00:00:00   \n",
       "1              125           Downtown        May 2015-05-18 00:00:00   \n",
       "2              125           Downtown     August 2015-08-21 00:00:00   \n",
       "3              125           Downtown      April 2015-04-07 00:00:00   \n",
       "4              124              Evans       July 2016-07-07 20:12:22   \n",
       "5              125           Downtown  September 2015-09-17 00:00:00   \n",
       "6              125           Downtown     August 2015-08-27 00:00:00   \n",
       "7              124              Evans      March 2015-03-27 00:00:00   \n",
       "8              125           Downtown        May 2015-05-11 00:00:00   \n",
       "9              125           Downtown  September 2015-09-10 00:00:00   \n",
       "10             124              Evans       July 2017-07-12 18:55:47   \n",
       "11             124              Evans    January 2015-01-30 00:00:00   \n",
       "12             124              Evans    October 2017-10-10 00:00:00   \n",
       "13             125           Downtown        May 2015-05-15 00:00:00   \n",
       "14             124              Evans   November 2017-11-06 22:10:48   \n",
       "15             125           Downtown      March 2017-03-29 00:00:00   \n",
       "16             124              Evans   November 2015-11-05 00:00:00   \n",
       "17             125           Downtown    October 2015-10-26 00:00:00   \n",
       "18             124              Evans  September 2017-09-21 00:00:00   \n",
       "19             125           Downtown     August 2015-08-31 00:00:00   \n",
       "20             125           Downtown      April 2015-04-21 00:00:00   \n",
       "21             124              Evans     August 2016-08-08 00:00:00   \n",
       "22             125           Downtown    October 2017-10-10 00:00:00   \n",
       "23             125           Downtown   February 2018-02-19 19:12:31   \n",
       "24             125           Downtown    January 2018-01-08 20:51:32   \n",
       "25             124              Evans      March 2015-03-12 00:00:00   \n",
       "26             125           Downtown       July 2015-07-15 00:00:00   \n",
       "27             125           Downtown  September 2016-09-26 00:00:00   \n",
       "28             125           Downtown      April 2015-04-17 00:00:00   \n",
       "29             125           Downtown       June 2015-06-11 00:00:00   \n",
       "...            ...                ...        ...                 ...   \n",
       "24280          125           Downtown   February 2018-02-26 00:00:00   \n",
       "24281          125           Downtown   November 2017-11-21 00:00:00   \n",
       "24282          265         Daisy lane   February 2018-02-27 15:56:08   \n",
       "24283          125           Downtown        May 2017-05-16 00:00:00   \n",
       "24284          125           Downtown   February 2018-02-28 00:00:00   \n",
       "24285          233        The Vintage    January 2016-01-22 00:00:00   \n",
       "24286          233        The Vintage      April 2015-04-01 00:00:00   \n",
       "24287          233        The Vintage    October 2015-10-05 00:00:00   \n",
       "24288          219  Bartlesville ENT    February 2018-02-19 00:00:00   \n",
       "24289          233        The Vintage        May 2016-05-09 00:00:00   \n",
       "24290          181               Main   February 2018-02-28 00:00:00   \n",
       "24291          125           Downtown   November 2017-11-28 00:00:00   \n",
       "24292          125           Downtown   February 2018-02-28 00:00:00   \n",
       "24293          233        The Vintage        May 2017-05-20 00:00:00   \n",
       "24294          125           Downtown   November 2017-11-29 00:00:00   \n",
       "24295          233        The Vintage     August 2015-08-20 00:00:00   \n",
       "24296          125           Downtown       June 2017-06-02 00:00:00   \n",
       "24297          125           Downtown        May 2017-05-03 00:00:00   \n",
       "24298          233        The Vintage   November 2016-11-10 00:00:00   \n",
       "24299          233        The Vintage      March 2016-03-14 00:00:00   \n",
       "24300          233        The Vintage      April 2015-04-27 00:00:00   \n",
       "24301          125           Downtown   February 2017-02-15 00:00:00   \n",
       "24302          233        The Vintage  September 2016-09-27 00:00:00   \n",
       "24303          233        The Vintage       July 2016-07-26 00:00:00   \n",
       "24304          233        The Vintage      April 2016-04-20 00:00:00   \n",
       "24305          125           Downtown       June 2017-06-23 00:00:00   \n",
       "24306          125           Downtown        May 2017-05-23 00:00:00   \n",
       "24307          125           Downtown   February 2017-02-07 00:00:00   \n",
       "24308          125           Downtown   November 2017-11-28 00:00:00   \n",
       "24309          125           Downtown  September 2017-09-15 00:00:00   \n",
       "\n",
       "                    provider                          type benchmark_date  \\\n",
       "0       Vickery, Christopher     # of New Patients on SLIT        05-2015   \n",
       "1          Lindman, Jonathan     # of New Patients on SCIT        05-2015   \n",
       "2          Esselman, Gregory     # of New Patients on SCIT        08-2015   \n",
       "3       Vickery, Christopher     # of New Patients on SCIT        04-2015   \n",
       "4          Barfield, William     # of New Patients on SCIT        07-2016   \n",
       "5           Kimbrough, James     # of New Patients on SCIT        09-2015   \n",
       "6           Porubsky, Edward     # of New Patients on SCIT        08-2015   \n",
       "7          Barfield, William     # of New Patients on SCIT        03-2015   \n",
       "8               Deal, Robert     # of New Patients on SCIT        05-2015   \n",
       "9          Barfield, William     # of New Patients on SCIT        09-2015   \n",
       "10        Ayers, Christopher     # of New Patients on SCIT        07-2017   \n",
       "11         Barfield, William     # of New Patients on SCIT        01-2015   \n",
       "12        Ayers, Christopher     # of New Patients on SCIT        10-2017   \n",
       "13          Porubsky, Edward     # of New Patients on SCIT        05-2015   \n",
       "14          Porubsky, Edward     # of New Patients on SCIT        11-2017   \n",
       "15              Deal, Robert     # of New Patients on SCIT        03-2017   \n",
       "16            Wells, William     # of New Patients on SCIT        11-2015   \n",
       "17               Owen, Ralph     # of New Patients on SCIT        10-2015   \n",
       "18          Porubsky, Edward     # of New Patients on SCIT        09-2017   \n",
       "19               Owen, Ralph     # of New Patients on SCIT        08-2015   \n",
       "20              Deal, Robert     # of New Patients on SCIT        04-2015   \n",
       "21          Porubsky, Edward     # of New Patients on SCIT        08-2016   \n",
       "22         Esselman, Gregory     # of New Patients on SCIT        10-2017   \n",
       "23        McMenamin, Patrick     # of New Patients on SCIT        02-2018   \n",
       "24               Owen, Ralph     # of New Patients on SCIT        01-2018   \n",
       "25         Barfield, William     # of New Patients on SCIT        03-2015   \n",
       "26              Deal, Robert     # of New Patients on SCIT        07-2015   \n",
       "27          Whitehouse, Alan     # of New Patients on SCIT        09-2016   \n",
       "28          Porubsky, Edward     # of New Patients on SCIT        04-2015   \n",
       "29          Porubsky, Edward     # of New Patients on SCIT        06-2015   \n",
       "...                      ...                           ...            ...   \n",
       "24280           Deal, Robert     # of New Patients on SCIT        02-2018   \n",
       "24281      Esselman, Gregory     # of New Patients on SCIT        11-2017   \n",
       "24282                         # of New Patients on Unknown        02-2018   \n",
       "24283      Esselman, Gregory     # of New Patients on SCIT        05-2017   \n",
       "24284           Deal, Robert     # of New Patients on SCIT        02-2018   \n",
       "24285      Brauchle, Randall     # of New Patients on SLIT        01-2016   \n",
       "24286  Prichard, Christopher     # of New Patients on SLIT        04-2015   \n",
       "24287      Brauchle, Randall     # of New Patients on SCIT        10-2015   \n",
       "24288       Holland, Charles     # of New Patients on SCIT        02-2018   \n",
       "24289         Craddock, John     # of New Patients on SCIT        05-2016   \n",
       "24290      Epperson, Rebecca     # of New Patients on SCIT        02-2018   \n",
       "24291      Esselman, Gregory     # of New Patients on SCIT        11-2017   \n",
       "24292     Ayers, Christopher     # of New Patients on SCIT        02-2018   \n",
       "24293      Brauchle, Randall     # of New Patients on SLIT        05-2017   \n",
       "24294      Esselman, Gregory     # of New Patients on SCIT        11-2017   \n",
       "24295         Craddock, John     # of New Patients on SCIT        08-2015   \n",
       "24296      Esselman, Gregory     # of New Patients on SCIT        06-2017   \n",
       "24297     McMenamin, Patrick     # of New Patients on SCIT        05-2017   \n",
       "24298  Prichard, Christopher     # of New Patients on SLIT        11-2016   \n",
       "24299      Brauchle, Randall     # of New Patients on SLIT        03-2016   \n",
       "24300         Craddock, John     # of New Patients on SLIT        04-2015   \n",
       "24301      Esselman, Gregory     # of New Patients on SCIT        02-2017   \n",
       "24302      Brauchle, Randall     # of New Patients on SCIT        09-2016   \n",
       "24303  Prichard, Christopher     # of New Patients on SLIT        07-2016   \n",
       "24304         Craddock, John     # of New Patients on SLIT        04-2016   \n",
       "24305     McMenamin, Patrick     # of New Patients on SCIT        06-2017   \n",
       "24306      Esselman, Gregory     # of New Patients on SCIT        05-2017   \n",
       "24307     McMenamin, Patrick     # of New Patients on SCIT        02-2017   \n",
       "24308      Esselman, Gregory     # of New Patients on SCIT        11-2017   \n",
       "24309     Ayers, Christopher     # of New Patients on SCIT        09-2017   \n",
       "\n",
       "      grouping  \n",
       "0       Group6  \n",
       "1       Group6  \n",
       "2       Group6  \n",
       "3       Group6  \n",
       "4       Group6  \n",
       "5       Group6  \n",
       "6       Group6  \n",
       "7       Group6  \n",
       "8       Group6  \n",
       "9       Group6  \n",
       "10      Group6  \n",
       "11      Group6  \n",
       "12      Group6  \n",
       "13      Group6  \n",
       "14      Group6  \n",
       "15      Group6  \n",
       "16      Group6  \n",
       "17      Group6  \n",
       "18      Group6  \n",
       "19      Group6  \n",
       "20      Group6  \n",
       "21      Group6  \n",
       "22      Group6  \n",
       "23      Group6  \n",
       "24      Group6  \n",
       "25      Group6  \n",
       "26      Group6  \n",
       "27      Group6  \n",
       "28      Group6  \n",
       "29      Group6  \n",
       "...        ...  \n",
       "24280   Group6  \n",
       "24281   Group6  \n",
       "24282   Group6  \n",
       "24283   Group6  \n",
       "24284   Group6  \n",
       "24285   Group6  \n",
       "24286   Group6  \n",
       "24287   Group6  \n",
       "24288   Group6  \n",
       "24289   Group6  \n",
       "24290   Group6  \n",
       "24291   Group6  \n",
       "24292   Group6  \n",
       "24293   Group6  \n",
       "24294   Group6  \n",
       "24295   Group6  \n",
       "24296   Group6  \n",
       "24297   Group6  \n",
       "24298   Group6  \n",
       "24299   Group6  \n",
       "24300   Group6  \n",
       "24301   Group6  \n",
       "24302   Group6  \n",
       "24303   Group6  \n",
       "24304   Group6  \n",
       "24305   Group6  \n",
       "24306   Group6  \n",
       "24307   Group6  \n",
       "24308   Group6  \n",
       "24309   Group6  \n",
       "\n",
       "[24310 rows x 11 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "treatments = pd.read_sql_query(\"SELECT a.ID AS Patients_Tested, a.mix_practice_id as practice_id, c.name as practice_name, a.Mix_Location_ID as location_id, b.name as location_name, monthname(a.therapy_start_date) as test_date, a.therapy_start_date as month_year, concat_ws(', ', pd.lastname, pd.firstname) as provider, a.intake_method as type FROM patients a INNER JOIN practice_locations b on a.mix_location_ID = b.id INNER JOIN practices c on a.mix_practice_ID = c.id left join practice_doctors pd on a.mix_practice_doctor_id = pd.id WHERE a.therapy_start_date BETWEEN %(PSD)s AND %(PED)s and mix_practice_id <> 9\", myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "treatments['benchmark_date'] = treatments['month_year'].dt.strftime('%m-%Y')\n",
    "inj_index = treatments.type == 'inj'\n",
    "sub_index = treatments.type == 'sub'\n",
    "unk_index = treatments.type == 'unk'\n",
    "treatments.loc[inj_index, 'type'] = '# of New Patients on SCIT'\n",
    "treatments.loc[sub_index, 'type'] = '# of New Patients on SLIT'\n",
    "treatments.loc[unk_index, 'type'] = '# of New Patients on Unknown'\n",
    "treatments['grouping'] = 'Group6'\n",
    "#treatments.to_excel('AllergyEDGE Tests Examples Treatments.xlsx')\n",
    "treatments"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>68</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>71</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>82</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>83</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>85</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>90</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>97</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>102</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Whitehouse, Alan</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>118</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>121</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>127</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>132</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Whitehouse, Alan</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>136</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>138</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>147</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>158</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>160</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>170</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Lindman, Jonathan</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>181</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Wells, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>189</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Vickery, Christopher</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>191</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>193</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Deal, Robert</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>200</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>201</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>208</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>210</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>211</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>213</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Owen, Ralph</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>221</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Porubsky, Edward</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>223</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>January</td>\n",
       "      <td>2015-01-01</td>\n",
       "      <td>Barfield, William</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46030</th>\n",
       "      <td>198347</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Forwith, Keith</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46031</th>\n",
       "      <td>198351</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Corbett, Mark</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46032</th>\n",
       "      <td>198352</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Allan, Joseph</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46033</th>\n",
       "      <td>198354</td>\n",
       "      <td>54</td>\n",
       "      <td>ENT Office</td>\n",
       "      <td>218</td>\n",
       "      <td>ENT Office</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Bloom, David</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46034</th>\n",
       "      <td>198355</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46035</th>\n",
       "      <td>198356</td>\n",
       "      <td>54</td>\n",
       "      <td>ENT Office</td>\n",
       "      <td>218</td>\n",
       "      <td>ENT Office</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Bloom, David</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46036</th>\n",
       "      <td>198358</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Thompson, Clark</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46037</th>\n",
       "      <td>198364</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Nishioka, Gary</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46038</th>\n",
       "      <td>198368</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td>167</td>\n",
       "      <td>South MP</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Angelos, Patrick</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46039</th>\n",
       "      <td>198370</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Ayers, Christopher</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46040</th>\n",
       "      <td>198378</td>\n",
       "      <td>51</td>\n",
       "      <td>Western Washington Medical Group</td>\n",
       "      <td>181</td>\n",
       "      <td>Main</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Epperson, Rebecca</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46041</th>\n",
       "      <td>198379</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46042</th>\n",
       "      <td>198381</td>\n",
       "      <td>52</td>\n",
       "      <td>Ear Nose and Throat Associates, P.C. Ft. Wayne</td>\n",
       "      <td>184</td>\n",
       "      <td>Southwest Jefferson</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Wellman, Cynthia</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46043</th>\n",
       "      <td>198388</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46044</th>\n",
       "      <td>198395</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46045</th>\n",
       "      <td>198398</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Corbett, Mark</td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46046</th>\n",
       "      <td>198401</td>\n",
       "      <td>57</td>\n",
       "      <td>Portneuf Ear, Nose and Throat</td>\n",
       "      <td>252</td>\n",
       "      <td>Main</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Yost, Morgan</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46047</th>\n",
       "      <td>198406</td>\n",
       "      <td>37</td>\n",
       "      <td>Ear, Nose &amp; Throat Associates</td>\n",
       "      <td>127</td>\n",
       "      <td>Main</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Thiringer, J.K.</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46048</th>\n",
       "      <td>198408</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46049</th>\n",
       "      <td>198409</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td>167</td>\n",
       "      <td>South MP</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Brown, Eugene</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46050</th>\n",
       "      <td>198414</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on SCIT</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46051</th>\n",
       "      <td>198415</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46052</th>\n",
       "      <td>198426</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td>167</td>\n",
       "      <td>South MP</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46053</th>\n",
       "      <td>198430</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46054</th>\n",
       "      <td>198432</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46055</th>\n",
       "      <td>198433</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46056</th>\n",
       "      <td>198437</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46057</th>\n",
       "      <td>198438</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46058</th>\n",
       "      <td>198441</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td></td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46059</th>\n",
       "      <td>198442</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td>167</td>\n",
       "      <td>South MP</td>\n",
       "      <td>November</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>Murphy, Thomas</td>\n",
       "      <td>Total Active Patients on Unknown</td>\n",
       "      <td>11-2018</td>\n",
       "      <td>Group7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1617613 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Patients_Tested practice_id  \\\n",
       "0                  68          36   \n",
       "1                  71          36   \n",
       "2                  82          36   \n",
       "3                  83          36   \n",
       "4                  85          36   \n",
       "5                  90          36   \n",
       "6                  97          36   \n",
       "7                 102          36   \n",
       "8                 118          36   \n",
       "9                 121          36   \n",
       "10                127          36   \n",
       "11                132          36   \n",
       "12                136          36   \n",
       "13                138          36   \n",
       "14                147          36   \n",
       "15                158          36   \n",
       "16                160          36   \n",
       "17                170          36   \n",
       "18                181          36   \n",
       "19                189          36   \n",
       "20                191          36   \n",
       "21                193          36   \n",
       "22                200          36   \n",
       "23                201          36   \n",
       "24                208          36   \n",
       "25                210          36   \n",
       "26                211          36   \n",
       "27                213          36   \n",
       "28                221          36   \n",
       "29                223          36   \n",
       "...               ...         ...   \n",
       "46030          198347          31   \n",
       "46031          198351          31   \n",
       "46032          198352          20   \n",
       "46033          198354          54   \n",
       "46034          198355          31   \n",
       "46035          198356          54   \n",
       "46036          198358          20   \n",
       "46037          198364          20   \n",
       "46038          198368           7   \n",
       "46039          198370          36   \n",
       "46040          198378          51   \n",
       "46041          198379          31   \n",
       "46042          198381          52   \n",
       "46043          198388          31   \n",
       "46044          198395          31   \n",
       "46045          198398          31   \n",
       "46046          198401          57   \n",
       "46047          198406          37   \n",
       "46048          198408          15   \n",
       "46049          198409           7   \n",
       "46050          198414          13   \n",
       "46051          198415          31   \n",
       "46052          198426           7   \n",
       "46053          198430          31   \n",
       "46054          198432          31   \n",
       "46055          198433          31   \n",
       "46056          198437          31   \n",
       "46057          198438          31   \n",
       "46058          198441          31   \n",
       "46059          198442           7   \n",
       "\n",
       "                                        practice_name location_id  \\\n",
       "0                                         Augusta ENT         125   \n",
       "1                                         Augusta ENT         125   \n",
       "2                                         Augusta ENT         124   \n",
       "3                                         Augusta ENT         125   \n",
       "4                                         Augusta ENT         125   \n",
       "5                                         Augusta ENT         125   \n",
       "6                                         Augusta ENT         125   \n",
       "7                                         Augusta ENT         125   \n",
       "8                                         Augusta ENT         125   \n",
       "9                                         Augusta ENT         125   \n",
       "10                                        Augusta ENT         124   \n",
       "11                                        Augusta ENT         125   \n",
       "12                                        Augusta ENT         125   \n",
       "13                                        Augusta ENT         124   \n",
       "14                                        Augusta ENT         125   \n",
       "15                                        Augusta ENT         125   \n",
       "16                                        Augusta ENT         125   \n",
       "17                                        Augusta ENT         125   \n",
       "18                                        Augusta ENT         124   \n",
       "19                                        Augusta ENT         125   \n",
       "20                                        Augusta ENT         125   \n",
       "21                                        Augusta ENT         125   \n",
       "22                                        Augusta ENT         124   \n",
       "23                                        Augusta ENT         125   \n",
       "24                                        Augusta ENT         125   \n",
       "25                                        Augusta ENT         124   \n",
       "26                                        Augusta ENT         125   \n",
       "27                                        Augusta ENT         125   \n",
       "28                                        Augusta ENT         125   \n",
       "29                                        Augusta ENT         125   \n",
       "...                                               ...         ...   \n",
       "46030                          Advanced ENT & Allergy         265   \n",
       "46031                          Advanced ENT & Allergy         265   \n",
       "46032                                  Willamette ENT         251   \n",
       "46033                                      ENT Office         218   \n",
       "46034                          Advanced ENT & Allergy         265   \n",
       "46035                                      ENT Office         218   \n",
       "46036                                  Willamette ENT         251   \n",
       "46037                                  Willamette ENT         251   \n",
       "46038                                  Charleston ENT         167   \n",
       "46039                                     Augusta ENT         125   \n",
       "46040                Western Washington Medical Group         181   \n",
       "46041                          Advanced ENT & Allergy         265   \n",
       "46042  Ear Nose and Throat Associates, P.C. Ft. Wayne         184   \n",
       "46043                          Advanced ENT & Allergy         265   \n",
       "46044                          Advanced ENT & Allergy         265   \n",
       "46045                          Advanced ENT & Allergy         265   \n",
       "46046                   Portneuf Ear, Nose and Throat         252   \n",
       "46047                   Ear, Nose & Throat Associates         127   \n",
       "46048                      Minneapolis Otolaryngology         280   \n",
       "46049                                  Charleston ENT         167   \n",
       "46050                                       Texas ENT         233   \n",
       "46051                          Advanced ENT & Allergy         265   \n",
       "46052                                  Charleston ENT         167   \n",
       "46053                          Advanced ENT & Allergy         265   \n",
       "46054                          Advanced ENT & Allergy         265   \n",
       "46055                          Advanced ENT & Allergy         265   \n",
       "46056                          Advanced ENT & Allergy         265   \n",
       "46057                          Advanced ENT & Allergy         265   \n",
       "46058                          Advanced ENT & Allergy         265   \n",
       "46059                                  Charleston ENT         167   \n",
       "\n",
       "             location_name test_date month_year              provider  \\\n",
       "0                 Downtown   January 2015-01-01        Wells, William   \n",
       "1                 Downtown   January 2015-01-01      Porubsky, Edward   \n",
       "2                    Evans   January 2015-01-01        Wells, William   \n",
       "3                 Downtown   January 2015-01-01        Wells, William   \n",
       "4                 Downtown   January 2015-01-01     Barfield, William   \n",
       "5                 Downtown   January 2015-01-01  Vickery, Christopher   \n",
       "6                 Downtown   January 2015-01-01                         \n",
       "7                 Downtown   January 2015-01-01      Whitehouse, Alan   \n",
       "8                 Downtown   January 2015-01-01          Deal, Robert   \n",
       "9                 Downtown   January 2015-01-01          Deal, Robert   \n",
       "10                   Evans   January 2015-01-01        Wells, William   \n",
       "11                Downtown   January 2015-01-01      Whitehouse, Alan   \n",
       "12                Downtown   January 2015-01-01     Barfield, William   \n",
       "13                   Evans   January 2015-01-01        Wells, William   \n",
       "14                Downtown   January 2015-01-01          Deal, Robert   \n",
       "15                Downtown   January 2015-01-01  Vickery, Christopher   \n",
       "16                Downtown   January 2015-01-01  Vickery, Christopher   \n",
       "17                Downtown   January 2015-01-01     Lindman, Jonathan   \n",
       "18                   Evans   January 2015-01-01        Wells, William   \n",
       "19                Downtown   January 2015-01-01  Vickery, Christopher   \n",
       "20                Downtown   January 2015-01-01          Deal, Robert   \n",
       "21                Downtown   January 2015-01-01          Deal, Robert   \n",
       "22                   Evans   January 2015-01-01           Owen, Ralph   \n",
       "23                Downtown   January 2015-01-01           Owen, Ralph   \n",
       "24                Downtown   January 2015-01-01           Owen, Ralph   \n",
       "25                   Evans   January 2015-01-01      Porubsky, Edward   \n",
       "26                Downtown   January 2015-01-01           Owen, Ralph   \n",
       "27                Downtown   January 2015-01-01           Owen, Ralph   \n",
       "28                Downtown   January 2015-01-01      Porubsky, Edward   \n",
       "29                Downtown   January 2015-01-01     Barfield, William   \n",
       "...                    ...       ...        ...                   ...   \n",
       "46030           Daisy lane  November 2018-11-01        Forwith, Keith   \n",
       "46031           Daisy lane  November 2018-11-01        Corbett, Mark    \n",
       "46032                Salem  November 2018-11-01         Allan, Joseph   \n",
       "46033           ENT Office  November 2018-11-01          Bloom, David   \n",
       "46034           Daisy lane  November 2018-11-01                         \n",
       "46035           ENT Office  November 2018-11-01          Bloom, David   \n",
       "46036                Salem  November 2018-11-01       Thompson, Clark   \n",
       "46037                Salem  November 2018-11-01        Nishioka, Gary   \n",
       "46038             South MP  November 2018-11-01      Angelos, Patrick   \n",
       "46039             Downtown  November 2018-11-01    Ayers, Christopher   \n",
       "46040                 Main  November 2018-11-01     Epperson, Rebecca   \n",
       "46041           Daisy lane  November 2018-11-01                         \n",
       "46042  Southwest Jefferson  November 2018-11-01     Wellman, Cynthia    \n",
       "46043           Daisy lane  November 2018-11-01                         \n",
       "46044           Daisy lane  November 2018-11-01                         \n",
       "46045           Daisy lane  November 2018-11-01        Corbett, Mark    \n",
       "46046                 Main  November 2018-11-01          Yost, Morgan   \n",
       "46047                 Main  November 2018-11-01       Thiringer, J.K.   \n",
       "46048            Southdale  November 2018-11-01                         \n",
       "46049             South MP  November 2018-11-01         Brown, Eugene   \n",
       "46050          The Vintage  November 2018-11-01                         \n",
       "46051           Daisy lane  November 2018-11-01                         \n",
       "46052             South MP  November 2018-11-01                         \n",
       "46053           Daisy lane  November 2018-11-01                         \n",
       "46054           Daisy lane  November 2018-11-01                         \n",
       "46055           Daisy lane  November 2018-11-01                         \n",
       "46056           Daisy lane  November 2018-11-01                         \n",
       "46057           Daisy lane  November 2018-11-01                         \n",
       "46058           Daisy lane  November 2018-11-01                         \n",
       "46059             South MP  November 2018-11-01        Murphy, Thomas   \n",
       "\n",
       "                                   type benchmark_date grouping  \n",
       "0         Total Active Patients on SCIT        01-2015   Group7  \n",
       "1         Total Active Patients on SCIT        01-2015   Group7  \n",
       "2         Total Active Patients on SCIT        01-2015   Group7  \n",
       "3         Total Active Patients on SCIT        01-2015   Group7  \n",
       "4         Total Active Patients on SCIT        01-2015   Group7  \n",
       "5         Total Active Patients on SCIT        01-2015   Group7  \n",
       "6         Total Active Patients on SCIT        01-2015   Group7  \n",
       "7         Total Active Patients on SCIT        01-2015   Group7  \n",
       "8         Total Active Patients on SCIT        01-2015   Group7  \n",
       "9         Total Active Patients on SCIT        01-2015   Group7  \n",
       "10        Total Active Patients on SCIT        01-2015   Group7  \n",
       "11        Total Active Patients on SCIT        01-2015   Group7  \n",
       "12        Total Active Patients on SCIT        01-2015   Group7  \n",
       "13        Total Active Patients on SCIT        01-2015   Group7  \n",
       "14        Total Active Patients on SCIT        01-2015   Group7  \n",
       "15        Total Active Patients on SCIT        01-2015   Group7  \n",
       "16        Total Active Patients on SCIT        01-2015   Group7  \n",
       "17        Total Active Patients on SCIT        01-2015   Group7  \n",
       "18        Total Active Patients on SCIT        01-2015   Group7  \n",
       "19        Total Active Patients on SCIT        01-2015   Group7  \n",
       "20        Total Active Patients on SCIT        01-2015   Group7  \n",
       "21        Total Active Patients on SCIT        01-2015   Group7  \n",
       "22        Total Active Patients on SCIT        01-2015   Group7  \n",
       "23        Total Active Patients on SCIT        01-2015   Group7  \n",
       "24        Total Active Patients on SCIT        01-2015   Group7  \n",
       "25        Total Active Patients on SCIT        01-2015   Group7  \n",
       "26        Total Active Patients on SCIT        01-2015   Group7  \n",
       "27        Total Active Patients on SCIT        01-2015   Group7  \n",
       "28        Total Active Patients on SCIT        01-2015   Group7  \n",
       "29        Total Active Patients on SCIT        01-2015   Group7  \n",
       "...                                 ...            ...      ...  \n",
       "46030  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46031  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46032  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46033  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46034  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46035  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46036  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46037  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46038  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46039     Total Active Patients on SCIT        11-2018   Group7  \n",
       "46040     Total Active Patients on SCIT        11-2018   Group7  \n",
       "46041  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46042     Total Active Patients on SCIT        11-2018   Group7  \n",
       "46043  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46044  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46045     Total Active Patients on SCIT        11-2018   Group7  \n",
       "46046  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46047  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46048  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46049  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46050     Total Active Patients on SCIT        11-2018   Group7  \n",
       "46051  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46052  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46053  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46054  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46055  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46056  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46057  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46058  Total Active Patients on Unknown        11-2018   Group7  \n",
       "46059  Total Active Patients on Unknown        11-2018   Group7  \n",
       "\n",
       "[1617613 rows x 11 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_patients = pd.DataFrame(columns=['Patients_Tested', 'practice_id', 'practice_name', 'location_id', 'location_name', 'test_date', 'month_year', 'provider', 'type'])\n",
    "for j in range(year_start, year +1):\n",
    "    for i in range(1,12):\n",
    "        last_date = calendar.monthrange(year,i)[1]\n",
    "    #    if PED >= datetime.datetime(year, i, last_date, 0, 0, 0).strftime('%Y-%m-%d %H:%M:%S'):\n",
    "        if i < 10:\n",
    "            total_patients_new = pd.read_sql_query(\"SELECT a.ID AS Patients_Tested, a.intake_method as type, a.Mix_Location_ID as location_id, timestamp('%(year)s-0%(month)s-1 00:00:00') as month_year, '0%(month)s-%(year)s' as benchmark_date, monthname('%(year)s-%(month)s-%(date)s') as test_date, b.name as location_name, a.mix_practice_id as practice_id, c.name as practice_name, concat_ws(', ', pd.lastname, pd.firstname) as provider FROM patients a INNER JOIN practice_locations b on a.mix_location_ID = b.id INNER JOIN practices c on a.mix_practice_ID = c.id left join practice_doctors pd on a.mix_practice_doctor_id = pd.id WHERE a.active = 1 and mix_practice_id <> 9 and (a.therapy_start_date <= '%(year)s-%(month)s-%(date)s' or a.therapy_start_date is null)\", myconnection, params={\"year\":j,\"month\":i, \"date\":last_date})\n",
    "        else:\n",
    "            total_patients_new = pd.read_sql_query(\"SELECT a.ID AS Patients_Tested, a.intake_method as type, a.Mix_Location_ID as location_id, timestamp('%(year)s-%(month)s-1 00:00:00') as month_year, '%(month)s-%(year)s' as benchmark_date, monthname('%(year)s-%(month)s-%(date)s') as test_date, b.name as location_name, a.mix_practice_id as practice_id, c.name as practice_name, concat_ws(', ', pd.lastname, pd.firstname) as provider FROM patients a INNER JOIN practice_locations b on a.mix_location_ID = b.id INNER JOIN practices c on a.mix_practice_ID = c.id left join practice_doctors pd on a.mix_practice_doctor_id = pd.id WHERE a.active = 1 and mix_practice_id <> 9 and (a.therapy_start_date <= '%(year)s-%(month)s-%(date)s' or a.therapy_start_date is null)\", myconnection, params={\"year\":j, \"month\":i, \"date\":last_date})\n",
    "        total_patients = total_patients.append(total_patients_new)\n",
    "total_patients_ytd = pd.DataFrame(total_patients)\n",
    "inj_index = total_patients_ytd.type == 'inj'\n",
    "sub_index = total_patients_ytd.type == 'sub'\n",
    "unk_index = total_patients_ytd.type == 'unk'\n",
    "total_patients_ytd.loc[inj_index, 'type'] = 'Total Active Patients on SCIT'\n",
    "total_patients_ytd.loc[sub_index, 'type'] = 'Total Active Patients on SLIT'\n",
    "total_patients_ytd.loc[unk_index, 'type'] = 'Total Active Patients on Unknown'\n",
    "total_patients_ytd = total_patients_ytd[['Patients_Tested', 'practice_id', 'practice_name', 'location_id', 'location_name', 'test_date', 'month_year', 'provider', 'type', 'benchmark_date']]\n",
    "#total_patients_ytd.to_excel('AllergyEDGE Tests Examples Patients.xlsx')\n",
    "total_patients_ytd['grouping'] = 'Group7'\n",
    "total_patients_ytd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>test_date</th>\n",
       "      <th>month_year</th>\n",
       "      <th>provider</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>279</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:02:05</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>280</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:02:11</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>281</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:14:55</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>282</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:16:06</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>283</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:16:12</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>284</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:17:58</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>285</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:22:13</td>\n",
       "      <td>Hultman, Heather</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>286</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:23:15</td>\n",
       "      <td>Hultman, Heather</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>287</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 14:26:22</td>\n",
       "      <td>Smith, Dawn</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>288</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 15:05:52</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>289</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 15:11:18</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>290</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 15:14:57</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>291</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 15:16:05</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>292</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 15:16:45</td>\n",
       "      <td>Bonsack, Kate</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>293</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 15:29:37</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>294</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 15:52:26</td>\n",
       "      <td>Hultman, Heather</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>295</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 16:08:01</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>296</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 16:09:31</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>297</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 16:23:51</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>298</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 18:46:46</td>\n",
       "      <td>Peel, Jennifer</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>299</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 18:55:23</td>\n",
       "      <td>Rutledge-Gilliam, Jillian</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>300</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 19:08:51</td>\n",
       "      <td>Bonsack, Kate</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>301</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 19:53:11</td>\n",
       "      <td>Padgett, Judy</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>302</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 20:24:12</td>\n",
       "      <td>Smith, Sharon</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>303</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 20:25:03</td>\n",
       "      <td>Smith, Sharon</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>304</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 20:48:13</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>305</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 20:55:38</td>\n",
       "      <td>Rutledge-Gilliam, Jillian</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>306</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 21:16:37</td>\n",
       "      <td>McDonald, Hilda</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>307</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 21:20:45</td>\n",
       "      <td>Hultman, Heather</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>308</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>November</td>\n",
       "      <td>2015-11-09 21:25:19</td>\n",
       "      <td>Rutledge-Gilliam, Jillian</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57709</th>\n",
       "      <td>57990</td>\n",
       "      <td>50</td>\n",
       "      <td>Blue Ridge ENT</td>\n",
       "      <td>179</td>\n",
       "      <td>Ashe Clinic</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:02:55</td>\n",
       "      <td>banks, joni</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57710</th>\n",
       "      <td>57991</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>257</td>\n",
       "      <td>Poplar Level</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:03:06</td>\n",
       "      <td>Williams, Carla</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57711</th>\n",
       "      <td>57992</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>257</td>\n",
       "      <td>Poplar Level</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:03:16</td>\n",
       "      <td>Williams, Carla</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57712</th>\n",
       "      <td>57993</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>206</td>\n",
       "      <td>Rock Hill</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:03:27</td>\n",
       "      <td>Kirk, Kimberly</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57713</th>\n",
       "      <td>57994</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>203</td>\n",
       "      <td>Matthews</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:04:01</td>\n",
       "      <td>Myrick, Tammy</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57714</th>\n",
       "      <td>57995</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>257</td>\n",
       "      <td>Poplar Level</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:06:05</td>\n",
       "      <td>Williams, Carla</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57715</th>\n",
       "      <td>57996</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:07:09</td>\n",
       "      <td>Bordelon, Amy</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57716</th>\n",
       "      <td>57997</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:07:38</td>\n",
       "      <td>Bordelon, Amy</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57717</th>\n",
       "      <td>57998</td>\n",
       "      <td>50</td>\n",
       "      <td>Blue Ridge ENT</td>\n",
       "      <td>178</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:07:55</td>\n",
       "      <td>Roach, Kay</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57718</th>\n",
       "      <td>57999</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:09:26</td>\n",
       "      <td>White, Alesia</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57719</th>\n",
       "      <td>58000</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:10:55</td>\n",
       "      <td>Gouldy, Andrea</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57720</th>\n",
       "      <td>58001</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:33:44</td>\n",
       "      <td>Druliner, Jacque</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57721</th>\n",
       "      <td>58002</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:33:59</td>\n",
       "      <td>Druliner, Jacque</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57722</th>\n",
       "      <td>58003</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:34:44</td>\n",
       "      <td>Fowler, Michelle</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57723</th>\n",
       "      <td>58004</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:35:17</td>\n",
       "      <td>Druliner, Jacque</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57724</th>\n",
       "      <td>58005</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>265</td>\n",
       "      <td>Daisy lane</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:38:07</td>\n",
       "      <td>Lamon, Rebecca</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57725</th>\n",
       "      <td>58006</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:44:05</td>\n",
       "      <td>Bordelon, Amy</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57726</th>\n",
       "      <td>58007</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>196</td>\n",
       "      <td>Mooresville Plantation Ridge</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:46:27</td>\n",
       "      <td>Ford, Madison</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57727</th>\n",
       "      <td>58008</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>225</td>\n",
       "      <td>Woodlands Indian Springs</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:46:28</td>\n",
       "      <td>Diaz, Ana</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57728</th>\n",
       "      <td>58009</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>225</td>\n",
       "      <td>Woodlands Indian Springs</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:47:02</td>\n",
       "      <td>Diaz, Ana</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57729</th>\n",
       "      <td>58010</td>\n",
       "      <td>38</td>\n",
       "      <td>Medical Center ENT Associates of Houston</td>\n",
       "      <td>128</td>\n",
       "      <td>Houston</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 21:56:00</td>\n",
       "      <td>Ramlal, Sian</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57730</th>\n",
       "      <td>58011</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 22:00:34</td>\n",
       "      <td>Druliner, Jacque</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57731</th>\n",
       "      <td>58012</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 22:03:16</td>\n",
       "      <td>White, Alesia</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57732</th>\n",
       "      <td>58013</td>\n",
       "      <td>43</td>\n",
       "      <td>Ear, Nose and Throat Center of the Ozarks</td>\n",
       "      <td>144</td>\n",
       "      <td>Springdale Office</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 22:05:07</td>\n",
       "      <td>Summers, Heather</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57733</th>\n",
       "      <td>58014</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 22:40:46</td>\n",
       "      <td>Martinez, Julie</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57734</th>\n",
       "      <td>58015</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 22:49:57</td>\n",
       "      <td>White, Alesia</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57735</th>\n",
       "      <td>58016</td>\n",
       "      <td>51</td>\n",
       "      <td>Western Washington Medical Group</td>\n",
       "      <td>181</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 22:59:41</td>\n",
       "      <td>Thompson, Angelina</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57736</th>\n",
       "      <td>58017</td>\n",
       "      <td>45</td>\n",
       "      <td>Cache Valley Ear Nose &amp; Throat</td>\n",
       "      <td>157</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:06:07</td>\n",
       "      <td>Hardman, Katie</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57737</th>\n",
       "      <td>58018</td>\n",
       "      <td>51</td>\n",
       "      <td>Western Washington Medical Group</td>\n",
       "      <td>181</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:32:53</td>\n",
       "      <td>Carson, Christa</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57738</th>\n",
       "      <td>58019</td>\n",
       "      <td>51</td>\n",
       "      <td>Western Washington Medical Group</td>\n",
       "      <td>181</td>\n",
       "      <td>Main</td>\n",
       "      <td>February</td>\n",
       "      <td>2018-02-28 23:32:59</td>\n",
       "      <td>Carson, Christa</td>\n",
       "      <td># of Errors</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group8</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>57739 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Patients_Tested  practice_id  \\\n",
       "0                  279           36   \n",
       "1                  280           36   \n",
       "2                  281           36   \n",
       "3                  282           36   \n",
       "4                  283           36   \n",
       "5                  284           36   \n",
       "6                  285           36   \n",
       "7                  286           36   \n",
       "8                  287           36   \n",
       "9                  288           36   \n",
       "10                 289           36   \n",
       "11                 290           36   \n",
       "12                 291           36   \n",
       "13                 292           36   \n",
       "14                 293           36   \n",
       "15                 294           36   \n",
       "16                 295           36   \n",
       "17                 296           36   \n",
       "18                 297           36   \n",
       "19                 298           36   \n",
       "20                 299           36   \n",
       "21                 300           36   \n",
       "22                 301           36   \n",
       "23                 302           36   \n",
       "24                 303           36   \n",
       "25                 304           36   \n",
       "26                 305           36   \n",
       "27                 306           36   \n",
       "28                 307           36   \n",
       "29                 308           36   \n",
       "...                ...          ...   \n",
       "57709            57990           50   \n",
       "57710            57991           31   \n",
       "57711            57992           31   \n",
       "57712            57993           16   \n",
       "57713            57994           16   \n",
       "57714            57995           31   \n",
       "57715            57996           17   \n",
       "57716            57997           17   \n",
       "57717            57998           50   \n",
       "57718            57999           13   \n",
       "57719            58000           31   \n",
       "57720            58001           20   \n",
       "57721            58002           20   \n",
       "57722            58003           36   \n",
       "57723            58004           20   \n",
       "57724            58005           31   \n",
       "57725            58006           17   \n",
       "57726            58007           16   \n",
       "57727            58008           13   \n",
       "57728            58009           13   \n",
       "57729            58010           38   \n",
       "57730            58011           20   \n",
       "57731            58012           13   \n",
       "57732            58013           43   \n",
       "57733            58014           13   \n",
       "57734            58015           13   \n",
       "57735            58016           51   \n",
       "57736            58017           45   \n",
       "57737            58018           51   \n",
       "57738            58019           51   \n",
       "\n",
       "                                          practice_name  location_id  \\\n",
       "0                                           Augusta ENT          124   \n",
       "1                                           Augusta ENT          124   \n",
       "2                                           Augusta ENT          124   \n",
       "3                                           Augusta ENT          124   \n",
       "4                                           Augusta ENT          124   \n",
       "5                                           Augusta ENT          124   \n",
       "6                                           Augusta ENT          124   \n",
       "7                                           Augusta ENT          124   \n",
       "8                                           Augusta ENT          124   \n",
       "9                                           Augusta ENT          124   \n",
       "10                                          Augusta ENT          124   \n",
       "11                                          Augusta ENT          124   \n",
       "12                                          Augusta ENT          124   \n",
       "13                                          Augusta ENT          125   \n",
       "14                                          Augusta ENT          124   \n",
       "15                                          Augusta ENT          124   \n",
       "16                                          Augusta ENT          124   \n",
       "17                                          Augusta ENT          124   \n",
       "18                                          Augusta ENT          124   \n",
       "19                                          Augusta ENT          125   \n",
       "20                                          Augusta ENT          125   \n",
       "21                                          Augusta ENT          125   \n",
       "22                                          Augusta ENT          125   \n",
       "23                                          Augusta ENT          125   \n",
       "24                                          Augusta ENT          125   \n",
       "25                                          Augusta ENT          124   \n",
       "26                                          Augusta ENT          125   \n",
       "27                                          Augusta ENT          124   \n",
       "28                                          Augusta ENT          124   \n",
       "29                                          Augusta ENT          125   \n",
       "...                                                 ...          ...   \n",
       "57709                                    Blue Ridge ENT          179   \n",
       "57710                            Advanced ENT & Allergy          257   \n",
       "57711                            Advanced ENT & Allergy          257   \n",
       "57712  Charlotte Eye Ear Nose & Throat Associates, P.A.          206   \n",
       "57713  Charlotte Eye Ear Nose & Throat Associates, P.A.          203   \n",
       "57714                            Advanced ENT & Allergy          257   \n",
       "57715                      ENT Associates of East Texas          267   \n",
       "57716                      ENT Associates of East Texas          267   \n",
       "57717                                    Blue Ridge ENT          178   \n",
       "57718                                         Texas ENT          233   \n",
       "57719                            Advanced ENT & Allergy          265   \n",
       "57720                                    Willamette ENT          251   \n",
       "57721                                    Willamette ENT          251   \n",
       "57722                                       Augusta ENT          125   \n",
       "57723                                    Willamette ENT          251   \n",
       "57724                            Advanced ENT & Allergy          265   \n",
       "57725                      ENT Associates of East Texas          267   \n",
       "57726  Charlotte Eye Ear Nose & Throat Associates, P.A.          196   \n",
       "57727                                         Texas ENT          225   \n",
       "57728                                         Texas ENT          225   \n",
       "57729          Medical Center ENT Associates of Houston          128   \n",
       "57730                                    Willamette ENT          251   \n",
       "57731                                         Texas ENT          233   \n",
       "57732         Ear, Nose and Throat Center of the Ozarks          144   \n",
       "57733                                         Texas ENT          233   \n",
       "57734                                         Texas ENT          233   \n",
       "57735                  Western Washington Medical Group          181   \n",
       "57736                    Cache Valley Ear Nose & Throat          157   \n",
       "57737                  Western Washington Medical Group          181   \n",
       "57738                  Western Washington Medical Group          181   \n",
       "\n",
       "                      location_name test_date          month_year  \\\n",
       "0                             Evans  November 2015-11-09 14:02:05   \n",
       "1                             Evans  November 2015-11-09 14:02:11   \n",
       "2                             Evans  November 2015-11-09 14:14:55   \n",
       "3                             Evans  November 2015-11-09 14:16:06   \n",
       "4                             Evans  November 2015-11-09 14:16:12   \n",
       "5                             Evans  November 2015-11-09 14:17:58   \n",
       "6                             Evans  November 2015-11-09 14:22:13   \n",
       "7                             Evans  November 2015-11-09 14:23:15   \n",
       "8                             Evans  November 2015-11-09 14:26:22   \n",
       "9                             Evans  November 2015-11-09 15:05:52   \n",
       "10                            Evans  November 2015-11-09 15:11:18   \n",
       "11                            Evans  November 2015-11-09 15:14:57   \n",
       "12                            Evans  November 2015-11-09 15:16:05   \n",
       "13                         Downtown  November 2015-11-09 15:16:45   \n",
       "14                            Evans  November 2015-11-09 15:29:37   \n",
       "15                            Evans  November 2015-11-09 15:52:26   \n",
       "16                            Evans  November 2015-11-09 16:08:01   \n",
       "17                            Evans  November 2015-11-09 16:09:31   \n",
       "18                            Evans  November 2015-11-09 16:23:51   \n",
       "19                         Downtown  November 2015-11-09 18:46:46   \n",
       "20                         Downtown  November 2015-11-09 18:55:23   \n",
       "21                         Downtown  November 2015-11-09 19:08:51   \n",
       "22                         Downtown  November 2015-11-09 19:53:11   \n",
       "23                         Downtown  November 2015-11-09 20:24:12   \n",
       "24                         Downtown  November 2015-11-09 20:25:03   \n",
       "25                            Evans  November 2015-11-09 20:48:13   \n",
       "26                         Downtown  November 2015-11-09 20:55:38   \n",
       "27                            Evans  November 2015-11-09 21:16:37   \n",
       "28                            Evans  November 2015-11-09 21:20:45   \n",
       "29                         Downtown  November 2015-11-09 21:25:19   \n",
       "...                             ...       ...                 ...   \n",
       "57709                   Ashe Clinic  February 2018-02-28 21:02:55   \n",
       "57710                  Poplar Level  February 2018-02-28 21:03:06   \n",
       "57711                  Poplar Level  February 2018-02-28 21:03:16   \n",
       "57712                     Rock Hill  February 2018-02-28 21:03:27   \n",
       "57713                      Matthews  February 2018-02-28 21:04:01   \n",
       "57714                  Poplar Level  February 2018-02-28 21:06:05   \n",
       "57715                          Main  February 2018-02-28 21:07:09   \n",
       "57716                          Main  February 2018-02-28 21:07:38   \n",
       "57717                          Main  February 2018-02-28 21:07:55   \n",
       "57718                   The Vintage  February 2018-02-28 21:09:26   \n",
       "57719                    Daisy lane  February 2018-02-28 21:10:55   \n",
       "57720                         Salem  February 2018-02-28 21:33:44   \n",
       "57721                         Salem  February 2018-02-28 21:33:59   \n",
       "57722                      Downtown  February 2018-02-28 21:34:44   \n",
       "57723                         Salem  February 2018-02-28 21:35:17   \n",
       "57724                    Daisy lane  February 2018-02-28 21:38:07   \n",
       "57725                          Main  February 2018-02-28 21:44:05   \n",
       "57726  Mooresville Plantation Ridge  February 2018-02-28 21:46:27   \n",
       "57727      Woodlands Indian Springs  February 2018-02-28 21:46:28   \n",
       "57728      Woodlands Indian Springs  February 2018-02-28 21:47:02   \n",
       "57729                       Houston  February 2018-02-28 21:56:00   \n",
       "57730                         Salem  February 2018-02-28 22:00:34   \n",
       "57731                   The Vintage  February 2018-02-28 22:03:16   \n",
       "57732             Springdale Office  February 2018-02-28 22:05:07   \n",
       "57733                   The Vintage  February 2018-02-28 22:40:46   \n",
       "57734                   The Vintage  February 2018-02-28 22:49:57   \n",
       "57735                          Main  February 2018-02-28 22:59:41   \n",
       "57736                          Main  February 2018-02-28 23:06:07   \n",
       "57737                          Main  February 2018-02-28 23:32:53   \n",
       "57738                          Main  February 2018-02-28 23:32:59   \n",
       "\n",
       "                        provider         type benchmark_date grouping  \n",
       "0                  Keller, Linda  # of Errors        11-2015   Group8  \n",
       "1                  Keller, Linda  # of Errors        11-2015   Group8  \n",
       "2                  Keller, Linda  # of Errors        11-2015   Group8  \n",
       "3                  Keller, Linda  # of Errors        11-2015   Group8  \n",
       "4                  Keller, Linda  # of Errors        11-2015   Group8  \n",
       "5                  Keller, Linda  # of Errors        11-2015   Group8  \n",
       "6               Hultman, Heather  # of Errors        11-2015   Group8  \n",
       "7               Hultman, Heather  # of Errors        11-2015   Group8  \n",
       "8                    Smith, Dawn  # of Errors        11-2015   Group8  \n",
       "9                McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "10               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "11               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "12               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "13                 Bonsack, Kate  # of Errors        11-2015   Group8  \n",
       "14               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "15              Hultman, Heather  # of Errors        11-2015   Group8  \n",
       "16               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "17               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "18                 Keller, Linda  # of Errors        11-2015   Group8  \n",
       "19                Peel, Jennifer  # of Errors        11-2015   Group8  \n",
       "20     Rutledge-Gilliam, Jillian  # of Errors        11-2015   Group8  \n",
       "21                 Bonsack, Kate  # of Errors        11-2015   Group8  \n",
       "22                 Padgett, Judy  # of Errors        11-2015   Group8  \n",
       "23                 Smith, Sharon  # of Errors        11-2015   Group8  \n",
       "24                 Smith, Sharon  # of Errors        11-2015   Group8  \n",
       "25               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "26     Rutledge-Gilliam, Jillian  # of Errors        11-2015   Group8  \n",
       "27               McDonald, Hilda  # of Errors        11-2015   Group8  \n",
       "28              Hultman, Heather  # of Errors        11-2015   Group8  \n",
       "29     Rutledge-Gilliam, Jillian  # of Errors        11-2015   Group8  \n",
       "...                          ...          ...            ...      ...  \n",
       "57709                banks, joni  # of Errors        02-2018   Group8  \n",
       "57710            Williams, Carla  # of Errors        02-2018   Group8  \n",
       "57711            Williams, Carla  # of Errors        02-2018   Group8  \n",
       "57712             Kirk, Kimberly  # of Errors        02-2018   Group8  \n",
       "57713              Myrick, Tammy  # of Errors        02-2018   Group8  \n",
       "57714            Williams, Carla  # of Errors        02-2018   Group8  \n",
       "57715              Bordelon, Amy  # of Errors        02-2018   Group8  \n",
       "57716              Bordelon, Amy  # of Errors        02-2018   Group8  \n",
       "57717                Roach, Kay   # of Errors        02-2018   Group8  \n",
       "57718              White, Alesia  # of Errors        02-2018   Group8  \n",
       "57719             Gouldy, Andrea  # of Errors        02-2018   Group8  \n",
       "57720           Druliner, Jacque  # of Errors        02-2018   Group8  \n",
       "57721           Druliner, Jacque  # of Errors        02-2018   Group8  \n",
       "57722           Fowler, Michelle  # of Errors        02-2018   Group8  \n",
       "57723           Druliner, Jacque  # of Errors        02-2018   Group8  \n",
       "57724             Lamon, Rebecca  # of Errors        02-2018   Group8  \n",
       "57725              Bordelon, Amy  # of Errors        02-2018   Group8  \n",
       "57726              Ford, Madison  # of Errors        02-2018   Group8  \n",
       "57727                  Diaz, Ana  # of Errors        02-2018   Group8  \n",
       "57728                  Diaz, Ana  # of Errors        02-2018   Group8  \n",
       "57729               Ramlal, Sian  # of Errors        02-2018   Group8  \n",
       "57730           Druliner, Jacque  # of Errors        02-2018   Group8  \n",
       "57731              White, Alesia  # of Errors        02-2018   Group8  \n",
       "57732           Summers, Heather  # of Errors        02-2018   Group8  \n",
       "57733            Martinez, Julie  # of Errors        02-2018   Group8  \n",
       "57734              White, Alesia  # of Errors        02-2018   Group8  \n",
       "57735         Thompson, Angelina  # of Errors        02-2018   Group8  \n",
       "57736             Hardman, Katie  # of Errors        02-2018   Group8  \n",
       "57737            Carson, Christa  # of Errors        02-2018   Group8  \n",
       "57738            Carson, Christa  # of Errors        02-2018   Group8  \n",
       "\n",
       "[57739 rows x 11 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_errors = pd.read_sql_query(\"SELECT a.id as Patients_Tested, a.practice_id, c.name as practice_name, a.location_id, b.name as location_name, monthname(a.date) as test_date, a.date as month_year, concat_ws(', ', u.lastname, u.firstname) as provider, 1 as type from user_errors a INNER JOIN practice_locations b ON a.Location_ID = b.id INNER JOIN practices c on a.practice_id = c.id left join users u on a.user_id = u.id WHERE a.Date BETWEEN %(PSD)s AND %(PED)s AND a.practice_id <> 9\", myconnection, params={\"PSD\":PSD, \"PED\":PED})\n",
    "total_errors['benchmark_date'] = total_errors['month_year'].dt.strftime('%m-%Y')\n",
    "practice_id_index = total_errors.type == 1\n",
    "total_errors.loc[practice_id_index, 'type'] = '# of Errors'\n",
    "#total_errors.to_excel('AllergyEDGE Tests Examples Errors.xlsx')\n",
    "total_errors['grouping'] = 'Group8'\n",
    "total_errors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>month_year</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>provider</th>\n",
       "      <th>test_date</th>\n",
       "      <th>type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>334</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>326</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>125</td>\n",
       "      <td>Downtown</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>188179</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>165</td>\n",
       "      <td>West Ashley</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>192006</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>167</td>\n",
       "      <td>South MP</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>189484</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>170</td>\n",
       "      <td>North MP</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>199531</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>172</td>\n",
       "      <td>Goose Creek</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>214062</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>174</td>\n",
       "      <td>Walterboro</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>197853</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>175</td>\n",
       "      <td>North Charleston</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "      <td>Charleston ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>255405</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>197</td>\n",
       "      <td>Southpark</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>276342</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>198</td>\n",
       "      <td>Belmont</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>261750</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>199</td>\n",
       "      <td>Blakeney</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>255630</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>200</td>\n",
       "      <td>Concord</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>255770</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>201</td>\n",
       "      <td>Huntersville</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>255503</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>203</td>\n",
       "      <td>Matthews</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>276328</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>205</td>\n",
       "      <td>Pineville</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>261887</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>206</td>\n",
       "      <td>Rock Hill</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>280848</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>207</td>\n",
       "      <td>Steele Creek</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>262873</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>208</td>\n",
       "      <td>University/Arbors</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>280306</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>209</td>\n",
       "      <td>Salisbury</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>285480</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>210</td>\n",
       "      <td>Monroe</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>287166</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>211</td>\n",
       "      <td>Albemarle</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>390745</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>222</td>\n",
       "      <td>CBO</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>445046</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>223</td>\n",
       "      <td>North Cypress</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>390724</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>233</td>\n",
       "      <td>The Vintage</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>13</td>\n",
       "      <td>Texas ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>527686</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>251</td>\n",
       "      <td>Salem</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>20</td>\n",
       "      <td>Willamette ENT</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>702369</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>862310</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group9</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>129</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group10</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>,</td>\n",
       "      <td>January</td>\n",
       "      <td># of Techs</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>160</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group10</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>Keller, Linda</td>\n",
       "      <td>January</td>\n",
       "      <td># of Techs</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>159</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Group10</td>\n",
       "      <td>124</td>\n",
       "      <td>Evans</td>\n",
       "      <td>2015-01-31 23:59:59</td>\n",
       "      <td>36</td>\n",
       "      <td>Augusta ENT</td>\n",
       "      <td>Hultman, Heather</td>\n",
       "      <td>January</td>\n",
       "      <td># of Techs</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>506</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Buttram, Angela</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>507</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Hardee, Monica</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>508</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Glass, Daniel</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>509</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Beverly, Lara</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>510</th>\n",
       "      <td>268</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>268</td>\n",
       "      <td>Lexington</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>58</td>\n",
       "      <td>CENTA Medical Group</td>\n",
       "      <td>King, Jonathan</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>511</th>\n",
       "      <td>268</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>268</td>\n",
       "      <td>Lexington</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>58</td>\n",
       "      <td>CENTA Medical Group</td>\n",
       "      <td>Kirchner, John</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>512</th>\n",
       "      <td>268</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>268</td>\n",
       "      <td>Lexington</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>58</td>\n",
       "      <td>CENTA Medical Group</td>\n",
       "      <td>Clements, Matthew</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>513</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Correa, Alex</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>514</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Duke, Sanford</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>515</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Dunn, C.</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>516</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Griffin, John</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>517</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Holmes, Keith</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>518</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Jerles, Matthew</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>519</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Newman, J</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>520</th>\n",
       "      <td>272</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>272</td>\n",
       "      <td>Goss</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>Corbett, Mark</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>521</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Fontenot, Ray</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>522</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Jordan, Carey</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>523</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>OMara, William</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>524</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Parks, Steve</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>525</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Roebuck, Jeremy</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>526</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Corbitt, Christian</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>527</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Frederick, Erin</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>528</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Walters, Amy</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>530</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>531</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Ayre, Thomas</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>532</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Rapport, Philip</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>533</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Boone, John</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>534</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Drew, Brian</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>535</th>\n",
       "      <td>281</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>281</td>\n",
       "      <td>Burnsville</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Rapport, Philip</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>26567 rows Ã— 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Patients_Tested benchmark_date grouping location_id      location_name  \\\n",
       "0               334        01-2015   Group9         124              Evans   \n",
       "1               326        01-2015   Group9         125           Downtown   \n",
       "2            188179        01-2015   Group9         165        West Ashley   \n",
       "3            192006        01-2015   Group9         167           South MP   \n",
       "4            189484        01-2015   Group9         170           North MP   \n",
       "5            199531        01-2015   Group9         172        Goose Creek   \n",
       "6            214062        01-2015   Group9         174         Walterboro   \n",
       "7            197853        01-2015   Group9         175   North Charleston   \n",
       "8            255405        01-2015   Group9         197          Southpark   \n",
       "9            276342        01-2015   Group9         198            Belmont   \n",
       "10           261750        01-2015   Group9         199           Blakeney   \n",
       "11           255630        01-2015   Group9         200            Concord   \n",
       "12           255770        01-2015   Group9         201       Huntersville   \n",
       "13           255503        01-2015   Group9         203           Matthews   \n",
       "14           276328        01-2015   Group9         205          Pineville   \n",
       "15           261887        01-2015   Group9         206          Rock Hill   \n",
       "16           280848        01-2015   Group9         207       Steele Creek   \n",
       "17           262873        01-2015   Group9         208  University/Arbors   \n",
       "18           280306        01-2015   Group9         209          Salisbury   \n",
       "19           285480        01-2015   Group9         210             Monroe   \n",
       "20           287166        01-2015   Group9         211          Albemarle   \n",
       "21           390745        01-2015   Group9         222                CBO   \n",
       "22           445046        01-2015   Group9         223      North Cypress   \n",
       "23           390724        01-2015   Group9         233        The Vintage   \n",
       "24           527686        01-2015   Group9         251              Salem   \n",
       "25           702369        01-2015   Group9         267               Main   \n",
       "26           862310        01-2015   Group9         280          Southdale   \n",
       "0               129        01-2015  Group10         124              Evans   \n",
       "1               160        01-2015  Group10         124              Evans   \n",
       "2               159        01-2015  Group10         124              Evans   \n",
       "..              ...            ...      ...         ...                ...   \n",
       "506             267        02-2018  Group11         267               Main   \n",
       "507             267        02-2018  Group11         267               Main   \n",
       "508             267        02-2018  Group11         267               Main   \n",
       "509             267        02-2018  Group11         267               Main   \n",
       "510             268        02-2018  Group11         268          Lexington   \n",
       "511             268        02-2018  Group11         268          Lexington   \n",
       "512             268        02-2018  Group11         268          Lexington   \n",
       "513             269        02-2018  Group11         269              Macon   \n",
       "514             269        02-2018  Group11         269              Macon   \n",
       "515             269        02-2018  Group11         269              Macon   \n",
       "516             269        02-2018  Group11         269              Macon   \n",
       "517             269        02-2018  Group11         269              Macon   \n",
       "518             269        02-2018  Group11         269              Macon   \n",
       "519             269        02-2018  Group11         269              Macon   \n",
       "520             272        02-2018  Group11         272               Goss   \n",
       "521             279        02-2018  Group11         279               Main   \n",
       "522             279        02-2018  Group11         279               Main   \n",
       "523             279        02-2018  Group11         279               Main   \n",
       "524             279        02-2018  Group11         279               Main   \n",
       "525             279        02-2018  Group11         279               Main   \n",
       "526             279        02-2018  Group11         279               Main   \n",
       "527             279        02-2018  Group11         279               Main   \n",
       "528             279        02-2018  Group11         279               Main   \n",
       "529             280        02-2018  Group11         280          Southdale   \n",
       "530             280        02-2018  Group11         280          Southdale   \n",
       "531             280        02-2018  Group11         280          Southdale   \n",
       "532             280        02-2018  Group11         280          Southdale   \n",
       "533             280        02-2018  Group11         280          Southdale   \n",
       "534             280        02-2018  Group11         280          Southdale   \n",
       "535             281        02-2018  Group11         281         Burnsville   \n",
       "\n",
       "             month_year practice_id  \\\n",
       "0   2015-01-31 23:59:59          36   \n",
       "1   2015-01-31 23:59:59          36   \n",
       "2   2015-01-31 23:59:59           7   \n",
       "3   2015-01-31 23:59:59           7   \n",
       "4   2015-01-31 23:59:59           7   \n",
       "5   2015-01-31 23:59:59           7   \n",
       "6   2015-01-31 23:59:59           7   \n",
       "7   2015-01-31 23:59:59           7   \n",
       "8   2015-01-31 23:59:59          16   \n",
       "9   2015-01-31 23:59:59          16   \n",
       "10  2015-01-31 23:59:59          16   \n",
       "11  2015-01-31 23:59:59          16   \n",
       "12  2015-01-31 23:59:59          16   \n",
       "13  2015-01-31 23:59:59          16   \n",
       "14  2015-01-31 23:59:59          16   \n",
       "15  2015-01-31 23:59:59          16   \n",
       "16  2015-01-31 23:59:59          16   \n",
       "17  2015-01-31 23:59:59          16   \n",
       "18  2015-01-31 23:59:59          16   \n",
       "19  2015-01-31 23:59:59          16   \n",
       "20  2015-01-31 23:59:59          16   \n",
       "21  2015-01-31 23:59:59          13   \n",
       "22  2015-01-31 23:59:59          13   \n",
       "23  2015-01-31 23:59:59          13   \n",
       "24  2015-01-31 23:59:59          20   \n",
       "25  2015-01-31 23:59:59          17   \n",
       "26  2015-01-31 23:59:59          15   \n",
       "0   2015-01-31 23:59:59          36   \n",
       "1   2015-01-31 23:59:59          36   \n",
       "2   2015-01-31 23:59:59          36   \n",
       "..                  ...         ...   \n",
       "506 2018-02-28 23:59:59          17   \n",
       "507 2018-02-28 23:59:59          17   \n",
       "508 2018-02-28 23:59:59          17   \n",
       "509 2018-02-28 23:59:59          17   \n",
       "510 2018-02-28 23:59:59          58   \n",
       "511 2018-02-28 23:59:59          58   \n",
       "512 2018-02-28 23:59:59          58   \n",
       "513 2018-02-28 23:59:59          59   \n",
       "514 2018-02-28 23:59:59          59   \n",
       "515 2018-02-28 23:59:59          59   \n",
       "516 2018-02-28 23:59:59          59   \n",
       "517 2018-02-28 23:59:59          59   \n",
       "518 2018-02-28 23:59:59          59   \n",
       "519 2018-02-28 23:59:59          59   \n",
       "520 2018-02-28 23:59:59          31   \n",
       "521 2018-02-28 23:59:59          60   \n",
       "522 2018-02-28 23:59:59          60   \n",
       "523 2018-02-28 23:59:59          60   \n",
       "524 2018-02-28 23:59:59          60   \n",
       "525 2018-02-28 23:59:59          60   \n",
       "526 2018-02-28 23:59:59          60   \n",
       "527 2018-02-28 23:59:59          60   \n",
       "528 2018-02-28 23:59:59          60   \n",
       "529 2018-02-28 23:59:59          15   \n",
       "530 2018-02-28 23:59:59          15   \n",
       "531 2018-02-28 23:59:59          15   \n",
       "532 2018-02-28 23:59:59          15   \n",
       "533 2018-02-28 23:59:59          15   \n",
       "534 2018-02-28 23:59:59          15   \n",
       "535 2018-02-28 23:59:59          15   \n",
       "\n",
       "                                        practice_name             provider  \\\n",
       "0                                         Augusta ENT                        \n",
       "1                                         Augusta ENT                        \n",
       "2                                      Charleston ENT                        \n",
       "3                                      Charleston ENT                        \n",
       "4                                      Charleston ENT                        \n",
       "5                                      Charleston ENT                        \n",
       "6                                      Charleston ENT                        \n",
       "7                                      Charleston ENT                        \n",
       "8    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "9    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "10   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "11   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "12   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "13   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "14   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "15   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "16   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "17   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "18   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "19   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "20   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "21                                          Texas ENT                        \n",
       "22                                          Texas ENT                        \n",
       "23                                          Texas ENT                        \n",
       "24                                     Willamette ENT                        \n",
       "25                       ENT Associates of East Texas                        \n",
       "26                         Minneapolis Otolaryngology                        \n",
       "0                                         Augusta ENT                   ,    \n",
       "1                                         Augusta ENT        Keller, Linda   \n",
       "2                                         Augusta ENT     Hultman, Heather   \n",
       "..                                                ...                  ...   \n",
       "506                      ENT Associates of East Texas      Buttram, Angela   \n",
       "507                      ENT Associates of East Texas       Hardee, Monica   \n",
       "508                      ENT Associates of East Texas        Glass, Daniel   \n",
       "509                      ENT Associates of East Texas        Beverly, Lara   \n",
       "510                               CENTA Medical Group       King, Jonathan   \n",
       "511                               CENTA Medical Group       Kirchner, John   \n",
       "512                               CENTA Medical Group    Clements, Matthew   \n",
       "513                 The ENT Center of Central Georgia         Correa, Alex   \n",
       "514                 The ENT Center of Central Georgia        Duke, Sanford   \n",
       "515                 The ENT Center of Central Georgia             Dunn, C.   \n",
       "516                 The ENT Center of Central Georgia        Griffin, John   \n",
       "517                 The ENT Center of Central Georgia        Holmes, Keith   \n",
       "518                 The ENT Center of Central Georgia      Jerles, Matthew   \n",
       "519                 The ENT Center of Central Georgia            Newman, J   \n",
       "520                            Advanced ENT & Allergy       Corbett, Mark    \n",
       "521                               Southeast Texas ENT       Fontenot, Ray    \n",
       "522                               Southeast Texas ENT       Jordan, Carey    \n",
       "523                               Southeast Texas ENT      OMara, William    \n",
       "524                               Southeast Texas ENT        Parks, Steve    \n",
       "525                               Southeast Texas ENT     Roebuck, Jeremy    \n",
       "526                               Southeast Texas ENT  Corbitt, Christian    \n",
       "527                               Southeast Texas ENT      Frederick, Erin   \n",
       "528                               Southeast Texas ENT         Walters, Amy   \n",
       "529                        Minneapolis Otolaryngology          Posey, Lisa   \n",
       "530                        Minneapolis Otolaryngology       Silver, Robert   \n",
       "531                        Minneapolis Otolaryngology         Ayre, Thomas   \n",
       "532                        Minneapolis Otolaryngology      Rapport, Philip   \n",
       "533                        Minneapolis Otolaryngology          Boone, John   \n",
       "534                        Minneapolis Otolaryngology          Drew, Brian   \n",
       "535                        Minneapolis Otolaryngology      Rapport, Philip   \n",
       "\n",
       "    test_date                          type  \n",
       "0     January         # of Mixing Locations  \n",
       "1     January         # of Mixing Locations  \n",
       "2     January         # of Mixing Locations  \n",
       "3     January         # of Mixing Locations  \n",
       "4     January         # of Mixing Locations  \n",
       "5     January         # of Mixing Locations  \n",
       "6     January         # of Mixing Locations  \n",
       "7     January         # of Mixing Locations  \n",
       "8     January         # of Mixing Locations  \n",
       "9     January         # of Mixing Locations  \n",
       "10    January         # of Mixing Locations  \n",
       "11    January         # of Mixing Locations  \n",
       "12    January         # of Mixing Locations  \n",
       "13    January         # of Mixing Locations  \n",
       "14    January         # of Mixing Locations  \n",
       "15    January         # of Mixing Locations  \n",
       "16    January         # of Mixing Locations  \n",
       "17    January         # of Mixing Locations  \n",
       "18    January         # of Mixing Locations  \n",
       "19    January         # of Mixing Locations  \n",
       "20    January         # of Mixing Locations  \n",
       "21    January         # of Mixing Locations  \n",
       "22    January         # of Mixing Locations  \n",
       "23    January         # of Mixing Locations  \n",
       "24    January         # of Mixing Locations  \n",
       "25    January         # of Mixing Locations  \n",
       "26    January         # of Mixing Locations  \n",
       "0     January                    # of Techs  \n",
       "1     January                    # of Techs  \n",
       "2     January                    # of Techs  \n",
       "..        ...                           ...  \n",
       "506  February  # of Physicians and Midlevel  \n",
       "507  February  # of Physicians and Midlevel  \n",
       "508  February  # of Physicians and Midlevel  \n",
       "509  February  # of Physicians and Midlevel  \n",
       "510  February  # of Physicians and Midlevel  \n",
       "511  February  # of Physicians and Midlevel  \n",
       "512  February  # of Physicians and Midlevel  \n",
       "513  February  # of Physicians and Midlevel  \n",
       "514  February  # of Physicians and Midlevel  \n",
       "515  February  # of Physicians and Midlevel  \n",
       "516  February  # of Physicians and Midlevel  \n",
       "517  February  # of Physicians and Midlevel  \n",
       "518  February  # of Physicians and Midlevel  \n",
       "519  February  # of Physicians and Midlevel  \n",
       "520  February  # of Physicians and Midlevel  \n",
       "521  February  # of Physicians and Midlevel  \n",
       "522  February  # of Physicians and Midlevel  \n",
       "523  February  # of Physicians and Midlevel  \n",
       "524  February  # of Physicians and Midlevel  \n",
       "525  February  # of Physicians and Midlevel  \n",
       "526  February  # of Physicians and Midlevel  \n",
       "527  February  # of Physicians and Midlevel  \n",
       "528  February  # of Physicians and Midlevel  \n",
       "529  February  # of Physicians and Midlevel  \n",
       "530  February  # of Physicians and Midlevel  \n",
       "531  February  # of Physicians and Midlevel  \n",
       "532  February  # of Physicians and Midlevel  \n",
       "533  February  # of Physicians and Midlevel  \n",
       "534  February  # of Physicians and Midlevel  \n",
       "535  February  # of Physicians and Midlevel  \n",
       "\n",
       "[26567 rows x 11 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_people_places = pd.DataFrame(columns=['Patients_Tested', 'practice_id', 'practice_name', 'location_id', 'location_name', 'test_date', 'month_year', 'provider', 'type', 'benchmark_date', 'grouping'])\n",
    "for j in range(year_start, year +1):\n",
    "    for i, m in enumerate(calendar.month_name[1:]):\n",
    "        last_date = calendar.monthrange(year,i + 1)[1]\n",
    "        month_name = m.capitalize()\n",
    "        year_current = j\n",
    "        if PED >= datetime.datetime(j, i + 1, last_date, 0, 0, 0).strftime('%Y-%m-%d %H:%M:%S'):\n",
    "            if i + 1 < 10:\n",
    "                total_doctors = pd.read_sql_query(\"SELECT a.mix_location_id AS Patients_Tested, a.practice_id, b.name AS practice_name, a.mix_location_id as location_id, c.name as location_name, %(monthname)s AS test_date, '%(year)s-0%(month)s-%(last_date)s 23:59:59' AS month_year, '0%(month)s-%(year)s' as benchmark_date, concat_ws(', ', d.lastname, d.firstname) AS provider, '# of Physicians and Midlevel' as type, 'Group11' as grouping FROM patients a LEFT JOIN practices b ON a.practice_id = b.id LEFT JOIN practice_locations c ON a.mix_location_id = c.id LEFT JOIN practice_doctors d ON a.mix_practice_doctor_id = d.id WHERE a.mix_location_id IS NOT NULL AND a.mix_practice_doctor_id IS NOT NULL AND a.therapy_start_date <= '%(year)s-0%(month)s-%(last_date)s 23:59:59' GROUP BY a.mix_location_id, a.mix_practice_doctor_id\", myconnection, params={\"year\":j, \"monthname\":month_name, \"month\":i + 1,\"last_date\":last_date})\n",
    "                mixing_locations = pd.read_sql_query(\"select a.id as Patients_Tested, a.mix_practice_id as practice_id, b.name as practice_name, a.mix_location_id as location_id, c.name as location_name, %(monthname)s as test_date, '%(year)s-0%(month)s-%(last_date)s 23:59:59' as month_year, '0%(month)s-%(year)s' as benchmark_date, '' as provider, '# of Mixing Locations' as type, 'Group9' as grouping from vials a left join practices b on a.mix_practice_id = b.id left join practice_locations c on a.mix_location_id = c.id WHERE a.mix_location_id IS NOT NULL AND a.mix_practice_id <> 9 and a.mix_date <= '%(year)s-0%(month)s-%(last_date)s 23:59:59' GROUP BY a.mix_location_id\", myconnection, params={\"year\":j, \"monthname\":month_name, \"month\":i + 1,\"last_date\":last_date})\n",
    "                total_techs = pd.read_sql_query(\"SELECT DISTINCT convert(tech.tester, UNSIGNED INTEGER) AS Patients_Tested, convert(tech.practice_id, UNSIGNED INTEGER) AS practice_id, b.name AS practice_name, tech.location_id AS location_id, c.name AS location_name, %(monthname)s AS test_date, '%(year)s-0%(month)s-%(last_date)s 23:59:59' AS month_year, '0%(month)s-%(year)s' as benchmark_date, concat_ws(', ', tech.lastname, tech.firstname) AS provider, '# of Techs' AS type, 'Group10' AS grouping FROM ((SELECT a.patient_id      AS Patients_Tested, monthname(a.date) AS test_date, a.date AS month_year, b.practice_id, d.location_id, a.shot_giver_id   AS tester, 'shot' AS type_of_test, 'ZXCV78' AS barcode, 'sht' AS intake_method, c.username, c.firstname, c.lastname FROM patient_visits_shots a LEFT JOIN patients b ON a.patient_id = b.id LEFT JOIN users c ON c.id = a.shot_giver_id LEFT JOIN patient_visits d ON a.visit_id = d.id WHERE b.practice_id <> 9 AND a.active = 1 AND a.Date BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND b.id IS NOT NULL AND c.id IS NOT NULL) UNION (SELECT DISTINCT q.patient AS Patients_Tested, q.tester, monthname(q.test_date) AS test_date, q.test_date AS month_year, q.type AS type_of_test, 'QWER45' AS barcode, 'tst' AS intake_method, q.practice_id, q.location_id, z.username, z.firstname, z.lastname FROM ((SELECT DISTINCT (a.patient_id) AS patient, a.user_id AS tester, a.test_date AS test_date, a.location_ID, d.Name, a.practice_id, i.name AS Practice_name, 'injection' AS type FROM intradermal_tests a INNER JOIN practice_locations d ON a.Location_ID = d.id INNER JOIN practices i ON a.practice_id = i.id WHERE a.Test_Date BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND (a.Status IS NULL OR a.Status <> 'deleted')) UNION (SELECT DISTINCT (b.patient_id) AS patient, b.tester_id AS tester, b.test_date AS test_date, b.location_id, e.Name, b.practice_id, i.name AS Practice_name, 'mqt' AS type FROM mq_tests b INNER JOIN practice_locations e ON b.Location_ID = e.id INNER JOIN practices i ON b.practice_id = i.id WHERE b.Test_Date BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND (b.Status IS NULL OR b.Status <> 'deleted')) UNION (SELECT DISTINCT (c.patient_id) AS patient, c.tester_id AS tester, c.test_date AS test_date, c.location_id, f.Name, c.practice_id, i.name AS Practice_name, 'stick' AS type FROM prick_tests c INNER JOIN practice_locations f ON c.location_id = f.id INNER JOIN practices i ON c.practice_id = i.id WHERE c.Test_Date BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND (c.Status IS NULL OR c.Status <> 'deleted')) UNION (SELECT DISTINCT (g.patient_id) AS patient, g.blood_drawn_by AS tester, g.Start_Date AS test_date, g.Start_Location_id AS Location_ID, h.name, g.start_practice_id, i.name AS Practice_name, 'ige' AS type FROM ige_tests g INNER JOIN practice_locations h ON g.start_practice_id = h.ID INNER JOIN practices i ON g.start_practice_id = i.id WHERE g.Start_Date BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND (g.Status = 'Complete')) ORDER BY Location_ID) q LEFT JOIN users z ON q.tester = z.id WHERE q.practice_id <> 9) UNION (SELECT DISTINCT v.patient_id AS Patients_Tested, v.barcode, IF(v.created_by IS NULL, v.mixer_id, v.created_by) AS tester, monthname(v.Mix_Date) AS test_date, v.Mix_Date AS month_year, z.intake_method, 'vial' AS type_of_test, v.mix_practice_id AS practice_id, v.mix_location_id AS location_id, u.username, u.firstname, u.lastname FROM vials v LEFT JOIN patients z ON v.patient_id = z.id LEFT JOIN users u ON IF(v.created_by IS NULL, v.mixer_id, v.created_by) = u.id LEFT JOIN practice_locations a ON v.mix_location_id = a.id LEFT JOIN practices b ON v.mix_practice_id = b.id WHERE (v.status_id <> 2 OR v.status_id IS NOT NULL) AND v.is_child <> 1 AND v.Mix_Date BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND v.Patient_ID IS NOT NULL AND v.mix_practice_id <> 9 AND u.id IS NOT NULL) UNION (SELECT a.id AS Patients_Tested, a.user_id AS tester, a.practice_id, a.location_id, monthname(a.date) AS test_date, a.date AS month_year, 'ASDF12' AS barcode, 'err' AS intake_method, 'error' AS type_of_test, u.username, u.firstname, u.lastname FROM user_errors a INNER JOIN practice_locations b ON a.Location_ID = b.id INNER JOIN practices c ON a.practice_id = c.id LEFT JOIN users u ON a.user_id = u.id WHERE a.Date BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND a.practice_id <> 9)) tech LEFT JOIN practices b ON tech.practice_ID = b.id LEFT JOIN practice_locations c ON tech.location_id = c.id WHERE tech.month_year BETWEEN '%(year)s-0%(month)s-01 00:00:00' AND '%(year)s-0%(month)s-%(last_date)s 23:59:59' AND tech.practice_id <> 9\", myconnection, params={\"year\":j, \"monthname\":month_name, \"month\":i + 1,\"last_date\":last_date})\n",
    "                dr_locations = pd.concat([mixing_locations, total_techs, total_doctors], axis=0)\n",
    "            else:\n",
    "                total_doctors = pd.read_sql_query(\"SELECT a.mix_location_id AS Patients_Tested, a.practice_id, b.name AS practice_name, a.mix_location_id as location_id, c.name as location_name, %(monthname)s AS test_date, '%(year)s-%(month)s-%(last_date)s 23:59:59' AS month_year, '%(month)s-%(year)s' as benchmark_date, concat_ws(', ', d.lastname, d.firstname) AS provider, '# of Physicians and Midlevel' as type, 'Group11' as grouping FROM patients a LEFT JOIN practices b ON a.practice_id = b.id LEFT JOIN practice_locations c ON a.mix_location_id = c.id LEFT JOIN practice_doctors d ON a.mix_practice_doctor_id = d.id WHERE a.mix_location_id IS NOT NULL AND a.mix_practice_doctor_id IS NOT NULL AND a.therapy_start_date <= '%(year)s-%(month)s-%(last_date)s 23:59:59' GROUP BY a.mix_location_id, a.mix_practice_doctor_id\", myconnection, params={\"year\":j, \"monthname\":month_name, \"month\":i + 1,\"last_date\":last_date})\n",
    "                mixing_locations = pd.read_sql_query(\"select a.id as Patients_Tested, a.mix_practice_id as practice_id, b.name as practice_name, a.mix_location_id as location_id, c.name as location_name, %(monthname)s as test_date, '%(year)s-%(month)s-%(last_date)s 23:59:59' as month_year, '%(month)s-%(year)s' as benchmark_date, '' as provider, '# of Mixing Locations' as type, 'Group9' as grouping from vials a left join practices b on a.mix_practice_id = b.id left join practice_locations c on a.mix_location_id = c.id WHERE a.mix_location_id IS NOT NULL AND a.mix_practice_id <> 9 and a.mix_date <= '%(year)s-%(month)s-%(last_date)s 23:59:59' GROUP BY a.mix_location_id\", myconnection, params={\"year\":j, \"monthname\":month_name, \"month\":i + 1,\"last_date\":last_date})\n",
    "                total_techs = pd.read_sql_query(\"SELECT DISTINCT convert(tech.tester, UNSIGNED INTEGER) AS Patients_Tested, convert(tech.practice_id, UNSIGNED INTEGER) AS practice_id, b.name AS practice_name, tech.location_id AS location_id, c.name AS location_name, %(monthname)s AS test_date, '%(year)s-%(month)s-%(last_date)s 23:59:59' AS month_year, '%(month)s-%(year)s' as benchmark_date, concat_ws(', ', tech.lastname, tech.firstname) AS provider, '# of Techs' AS type, 'Group10' AS grouping FROM ((SELECT a.patient_id AS Patients_Tested, monthname(a.date) AS test_date, a.date AS month_year, b.practice_id, d.location_id, a.shot_giver_id   AS tester, 'shot' AS type_of_test, 'ZXCV78' AS barcode, 'sht' AS intake_method, c.username, c.firstname, c.lastname FROM patient_visits_shots a LEFT JOIN patients b ON a.patient_id = b.id LEFT JOIN users c ON c.id = a.shot_giver_id LEFT JOIN patient_visits d ON a.visit_id = d.id WHERE b.practice_id <> 9 AND a.active = 1 AND a.Date BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND b.id IS NOT NULL AND c.id IS NOT NULL) UNION (SELECT DISTINCT q.patient AS Patients_Tested, q.tester, monthname(q.test_date) AS test_date, q.test_date AS month_year, q.type AS type_of_test, 'QWER45' AS barcode, 'tst' AS intake_method, q.practice_id, q.location_id, z.username, z.firstname, z.lastname FROM ((SELECT DISTINCT (a.patient_id) AS patient, a.user_id AS tester, a.test_date AS test_date, a.location_ID, d.Name, a.practice_id, i.name AS Practice_name, 'injection' AS type FROM intradermal_tests a INNER JOIN practice_locations d ON a.Location_ID = d.id INNER JOIN practices i ON a.practice_id = i.id WHERE a.Test_Date BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND (a.Status IS NULL OR a.Status <> 'deleted')) UNION (SELECT DISTINCT (b.patient_id) AS patient, b.tester_id AS tester, b.test_date AS test_date, b.location_id, e.Name, b.practice_id, i.name AS Practice_name, 'mqt' AS type FROM mq_tests b INNER JOIN practice_locations e ON b.Location_ID = e.id INNER JOIN practices i ON b.practice_id = i.id WHERE b.Test_Date BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND (b.Status IS NULL OR b.Status <> 'deleted')) UNION (SELECT DISTINCT (c.patient_id) AS patient, c.tester_id AS tester, c.test_date AS test_date, c.location_id, f.Name, c.practice_id, i.name AS Practice_name, 'stick' AS type FROM prick_tests c INNER JOIN practice_locations f ON c.location_id = f.id INNER JOIN practices i ON c.practice_id = i.id WHERE c.Test_Date BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND (c.Status IS NULL OR c.Status <> 'deleted')) UNION (SELECT DISTINCT (g.patient_id) AS patient, g.blood_drawn_by AS tester, g.Start_Date AS test_date, g.Start_Location_id AS Location_ID, h.name, g.start_practice_id, i.name AS Practice_name, 'ige' AS type FROM ige_tests g INNER JOIN practice_locations h ON g.start_practice_id = h.ID INNER JOIN practices i ON g.start_practice_id = i.id WHERE g.Start_Date BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND (g.Status = 'Complete')) ORDER BY Location_ID) q LEFT JOIN users z ON q.tester = z.id WHERE q.practice_id <> 9) UNION (SELECT DISTINCT v.patient_id AS Patients_Tested, v.barcode, IF(v.created_by IS NULL, v.mixer_id, v.created_by) AS tester, monthname(v.Mix_Date) AS test_date, v.Mix_Date AS month_year, z.intake_method, 'vial' AS type_of_test, v.mix_practice_id AS practice_id, v.mix_location_id AS location_id, u.username, u.firstname, u.lastname FROM vials v LEFT JOIN patients z ON v.patient_id = z.id LEFT JOIN users u ON IF(v.created_by IS NULL, v.mixer_id, v.created_by) = u.id LEFT JOIN practice_locations a ON v.mix_location_id = a.id LEFT JOIN practices b ON v.mix_practice_id = b.id WHERE (v.status_id <> 2 OR v.status_id IS NOT NULL) AND v.is_child <> 1 AND v.Mix_Date BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND v.Patient_ID IS NOT NULL AND v.mix_practice_id <> 9 AND u.id IS NOT NULL) UNION (SELECT a.id AS Patients_Tested, a.user_id AS tester, a.practice_id, a.location_id, monthname(a.date) AS test_date, a.date AS month_year, 'ASDF12' AS barcode, 'err' AS intake_method, 'error' AS type_of_test, u.username, u.firstname, u.lastname FROM user_errors a INNER JOIN practice_locations b ON a.Location_ID = b.id INNER JOIN practices c ON a.practice_id = c.id LEFT JOIN users u ON a.user_id = u.id WHERE a.Date BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND a.practice_id <> 9)) tech LEFT JOIN practices b ON tech.practice_ID = b.id LEFT JOIN practice_locations c ON tech.location_id = c.id WHERE tech.month_year BETWEEN '%(year)s-%(month)s-01 00:00:00' AND '%(year)s-%(month)s-%(last_date)s 23:59:59' AND tech.practice_id <> 9\", myconnection, params={\"year\":j, \"monthname\":month_name, \"month\":i + 1,\"last_date\":last_date})\n",
    "                dr_locations = pd.concat([mixing_locations, total_techs, total_doctors], axis=0)\n",
    "            total_people_places = pd.concat([total_people_places, dr_locations], axis=0)\n",
    "total_people_places['month_year'] = pd.to_datetime(total_people_places.month_year)\n",
    "#total_people_places['month_year'] = total_people_places['month_year'].dt.strftime('%m/%d/%Y')\n",
    "#total_people_places.to_excel('AllergyEDGE Tests Examples People and Places.xlsx')\n",
    "total_people_places"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>grouping</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>month_year</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>provider</th>\n",
       "      <th>test_date</th>\n",
       "      <th>type</th>\n",
       "      <th>category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>42411</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-04-06 17:24:11</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>April</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>45685</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-06-07 18:05:01</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>June</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>66497</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-08-07 17:27:48</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>August</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>81758</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-10-05 19:15:24</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td>October</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>87208</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-11-28 18:43:16</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>November</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>192034</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2018-01-31 18:00:22</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>43939</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-05-02 18:42:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>May</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>47045</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-07-11 17:30:14</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>July</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>67814</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-09-01 19:08:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>September</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>27097</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-10-30 19:43:29</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>Abrams, Mark</td>\n",
       "      <td>October</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>89752</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-12-28 17:41:54</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>December</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>42118</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-04-06 17:30:30</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>April</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>45749</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-06-08 19:59:33</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>June</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>81880</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-10-06 19:18:05</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>October</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>87374</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-11-28 18:43:28</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>November</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>192037</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2018-01-31 18:00:27</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>43943</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-05-02 18:43:06</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>May</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>47046</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-07-11 17:30:19</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>July</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>67942</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-09-05 17:41:57</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>September</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>83998</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-10-30 19:43:34</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>October</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>89754</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-12-28 17:41:59</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>December</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>42412</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-04-06 17:30:34</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td>April</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>45751</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-06-08 20:06:41</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>Parsons, Gregory</td>\n",
       "      <td>June</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>66588</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-08-08 17:48:01</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>August</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>28830</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-10-06 19:18:09</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>Sicard, Michael</td>\n",
       "      <td>October</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>87516</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-11-29 21:26:29</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>November</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>192033</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2018-01-31 18:00:55</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>January</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>43944</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-05-02 18:43:12</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>May</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>46435</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-07-11 17:30:24</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td>Silver, John Robert</td>\n",
       "      <td>July</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>67972</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Group1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>North Charleston (reference-only)</td>\n",
       "      <td>2017-09-05 21:08:34</td>\n",
       "      <td>16</td>\n",
       "      <td>Charlotte Eye Ear Nose &amp; Throat Associates, P.A.</td>\n",
       "      <td></td>\n",
       "      <td>September</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>506</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Buttram, Angela</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>507</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Hardee, Monica</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>508</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Glass, Daniel</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>509</th>\n",
       "      <td>267</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>267</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>17</td>\n",
       "      <td>ENT Associates of East Texas</td>\n",
       "      <td>Beverly, Lara</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>510</th>\n",
       "      <td>268</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>268</td>\n",
       "      <td>Lexington</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>58</td>\n",
       "      <td>CENTA Medical Group</td>\n",
       "      <td>King, Jonathan</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>511</th>\n",
       "      <td>268</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>268</td>\n",
       "      <td>Lexington</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>58</td>\n",
       "      <td>CENTA Medical Group</td>\n",
       "      <td>Kirchner, John</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>512</th>\n",
       "      <td>268</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>268</td>\n",
       "      <td>Lexington</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>58</td>\n",
       "      <td>CENTA Medical Group</td>\n",
       "      <td>Clements, Matthew</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>513</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Correa, Alex</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>514</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Duke, Sanford</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>515</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Dunn, C.</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>516</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Griffin, John</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>517</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Holmes, Keith</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>518</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Jerles, Matthew</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>519</th>\n",
       "      <td>269</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>269</td>\n",
       "      <td>Macon</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>59</td>\n",
       "      <td>The ENT Center of Central Georgia</td>\n",
       "      <td>Newman, J</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>520</th>\n",
       "      <td>272</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>272</td>\n",
       "      <td>Goss</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>31</td>\n",
       "      <td>Advanced ENT &amp; Allergy</td>\n",
       "      <td>Corbett, Mark</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>521</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Fontenot, Ray</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>522</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Jordan, Carey</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>523</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>OMara, William</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>524</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Parks, Steve</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>525</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Roebuck, Jeremy</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>526</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Corbitt, Christian</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>527</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Frederick, Erin</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>528</th>\n",
       "      <td>279</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>279</td>\n",
       "      <td>Main</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>60</td>\n",
       "      <td>Southeast Texas ENT</td>\n",
       "      <td>Walters, Amy</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Posey, Lisa</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>530</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Silver, Robert</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>531</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Ayre, Thomas</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>532</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Rapport, Philip</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>533</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Boone, John</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>534</th>\n",
       "      <td>280</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>280</td>\n",
       "      <td>Southdale</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Drew, Brian</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>535</th>\n",
       "      <td>281</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Group11</td>\n",
       "      <td>281</td>\n",
       "      <td>Burnsville</td>\n",
       "      <td>2018-02-28 23:59:59</td>\n",
       "      <td>15</td>\n",
       "      <td>Minneapolis Otolaryngology</td>\n",
       "      <td>Rapport, Philip</td>\n",
       "      <td>February</td>\n",
       "      <td># of Physicians and Midlevel</td>\n",
       "      <td>Actuals</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3864904 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Patients_Tested benchmark_date grouping location_id  \\\n",
       "0             42411        04-2017   Group1         NaN   \n",
       "1             45685        06-2017   Group1         NaN   \n",
       "2             66497        08-2017   Group1         NaN   \n",
       "3             81758        10-2017   Group1         NaN   \n",
       "4             87208        11-2017   Group1         NaN   \n",
       "5            192034        01-2018   Group1         NaN   \n",
       "6             43939        05-2017   Group1         NaN   \n",
       "7             47045        07-2017   Group1         NaN   \n",
       "8             67814        09-2017   Group1         NaN   \n",
       "9             27097        10-2017   Group1         NaN   \n",
       "10            89752        12-2017   Group1         NaN   \n",
       "11            42118        04-2017   Group1         NaN   \n",
       "12            45749        06-2017   Group1         NaN   \n",
       "13            81880        10-2017   Group1         NaN   \n",
       "14            87374        11-2017   Group1         NaN   \n",
       "15           192037        01-2018   Group1         NaN   \n",
       "16            43943        05-2017   Group1         NaN   \n",
       "17            47046        07-2017   Group1         NaN   \n",
       "18            67942        09-2017   Group1         NaN   \n",
       "19            83998        10-2017   Group1         NaN   \n",
       "20            89754        12-2017   Group1         NaN   \n",
       "21            42412        04-2017   Group1         NaN   \n",
       "22            45751        06-2017   Group1         NaN   \n",
       "23            66588        08-2017   Group1         NaN   \n",
       "24            28830        10-2017   Group1         NaN   \n",
       "25            87516        11-2017   Group1         NaN   \n",
       "26           192033        01-2018   Group1         NaN   \n",
       "27            43944        05-2017   Group1         NaN   \n",
       "28            46435        07-2017   Group1         NaN   \n",
       "29            67972        09-2017   Group1         NaN   \n",
       "..              ...            ...      ...         ...   \n",
       "506             267        02-2018  Group11         267   \n",
       "507             267        02-2018  Group11         267   \n",
       "508             267        02-2018  Group11         267   \n",
       "509             267        02-2018  Group11         267   \n",
       "510             268        02-2018  Group11         268   \n",
       "511             268        02-2018  Group11         268   \n",
       "512             268        02-2018  Group11         268   \n",
       "513             269        02-2018  Group11         269   \n",
       "514             269        02-2018  Group11         269   \n",
       "515             269        02-2018  Group11         269   \n",
       "516             269        02-2018  Group11         269   \n",
       "517             269        02-2018  Group11         269   \n",
       "518             269        02-2018  Group11         269   \n",
       "519             269        02-2018  Group11         269   \n",
       "520             272        02-2018  Group11         272   \n",
       "521             279        02-2018  Group11         279   \n",
       "522             279        02-2018  Group11         279   \n",
       "523             279        02-2018  Group11         279   \n",
       "524             279        02-2018  Group11         279   \n",
       "525             279        02-2018  Group11         279   \n",
       "526             279        02-2018  Group11         279   \n",
       "527             279        02-2018  Group11         279   \n",
       "528             279        02-2018  Group11         279   \n",
       "529             280        02-2018  Group11         280   \n",
       "530             280        02-2018  Group11         280   \n",
       "531             280        02-2018  Group11         280   \n",
       "532             280        02-2018  Group11         280   \n",
       "533             280        02-2018  Group11         280   \n",
       "534             280        02-2018  Group11         280   \n",
       "535             281        02-2018  Group11         281   \n",
       "\n",
       "                         location_name          month_year practice_id  \\\n",
       "0    North Charleston (reference-only) 2017-04-06 17:24:11          16   \n",
       "1    North Charleston (reference-only) 2017-06-07 18:05:01          16   \n",
       "2    North Charleston (reference-only) 2017-08-07 17:27:48          16   \n",
       "3    North Charleston (reference-only) 2017-10-05 19:15:24          16   \n",
       "4    North Charleston (reference-only) 2017-11-28 18:43:16          16   \n",
       "5    North Charleston (reference-only) 2018-01-31 18:00:22          16   \n",
       "6    North Charleston (reference-only) 2017-05-02 18:42:59          16   \n",
       "7    North Charleston (reference-only) 2017-07-11 17:30:14          16   \n",
       "8    North Charleston (reference-only) 2017-09-01 19:08:59          16   \n",
       "9    North Charleston (reference-only) 2017-10-30 19:43:29          16   \n",
       "10   North Charleston (reference-only) 2017-12-28 17:41:54          16   \n",
       "11   North Charleston (reference-only) 2017-04-06 17:30:30          16   \n",
       "12   North Charleston (reference-only) 2017-06-08 19:59:33          16   \n",
       "13   North Charleston (reference-only) 2017-10-06 19:18:05          16   \n",
       "14   North Charleston (reference-only) 2017-11-28 18:43:28          16   \n",
       "15   North Charleston (reference-only) 2018-01-31 18:00:27          16   \n",
       "16   North Charleston (reference-only) 2017-05-02 18:43:06          16   \n",
       "17   North Charleston (reference-only) 2017-07-11 17:30:19          16   \n",
       "18   North Charleston (reference-only) 2017-09-05 17:41:57          16   \n",
       "19   North Charleston (reference-only) 2017-10-30 19:43:34          16   \n",
       "20   North Charleston (reference-only) 2017-12-28 17:41:59          16   \n",
       "21   North Charleston (reference-only) 2017-04-06 17:30:34          16   \n",
       "22   North Charleston (reference-only) 2017-06-08 20:06:41          16   \n",
       "23   North Charleston (reference-only) 2017-08-08 17:48:01          16   \n",
       "24   North Charleston (reference-only) 2017-10-06 19:18:09          16   \n",
       "25   North Charleston (reference-only) 2017-11-29 21:26:29          16   \n",
       "26   North Charleston (reference-only) 2018-01-31 18:00:55          16   \n",
       "27   North Charleston (reference-only) 2017-05-02 18:43:12          16   \n",
       "28   North Charleston (reference-only) 2017-07-11 17:30:24          16   \n",
       "29   North Charleston (reference-only) 2017-09-05 21:08:34          16   \n",
       "..                                 ...                 ...         ...   \n",
       "506                               Main 2018-02-28 23:59:59          17   \n",
       "507                               Main 2018-02-28 23:59:59          17   \n",
       "508                               Main 2018-02-28 23:59:59          17   \n",
       "509                               Main 2018-02-28 23:59:59          17   \n",
       "510                          Lexington 2018-02-28 23:59:59          58   \n",
       "511                          Lexington 2018-02-28 23:59:59          58   \n",
       "512                          Lexington 2018-02-28 23:59:59          58   \n",
       "513                              Macon 2018-02-28 23:59:59          59   \n",
       "514                              Macon 2018-02-28 23:59:59          59   \n",
       "515                              Macon 2018-02-28 23:59:59          59   \n",
       "516                              Macon 2018-02-28 23:59:59          59   \n",
       "517                              Macon 2018-02-28 23:59:59          59   \n",
       "518                              Macon 2018-02-28 23:59:59          59   \n",
       "519                              Macon 2018-02-28 23:59:59          59   \n",
       "520                               Goss 2018-02-28 23:59:59          31   \n",
       "521                               Main 2018-02-28 23:59:59          60   \n",
       "522                               Main 2018-02-28 23:59:59          60   \n",
       "523                               Main 2018-02-28 23:59:59          60   \n",
       "524                               Main 2018-02-28 23:59:59          60   \n",
       "525                               Main 2018-02-28 23:59:59          60   \n",
       "526                               Main 2018-02-28 23:59:59          60   \n",
       "527                               Main 2018-02-28 23:59:59          60   \n",
       "528                               Main 2018-02-28 23:59:59          60   \n",
       "529                          Southdale 2018-02-28 23:59:59          15   \n",
       "530                          Southdale 2018-02-28 23:59:59          15   \n",
       "531                          Southdale 2018-02-28 23:59:59          15   \n",
       "532                          Southdale 2018-02-28 23:59:59          15   \n",
       "533                          Southdale 2018-02-28 23:59:59          15   \n",
       "534                          Southdale 2018-02-28 23:59:59          15   \n",
       "535                         Burnsville 2018-02-28 23:59:59          15   \n",
       "\n",
       "                                        practice_name             provider  \\\n",
       "0    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "1    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "2    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "3    Charlotte Eye Ear Nose & Throat Associates, P.A.     Parsons, Gregory   \n",
       "4    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "5    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "6    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "7    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "8    Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "9    Charlotte Eye Ear Nose & Throat Associates, P.A.         Abrams, Mark   \n",
       "10   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "11   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "12   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "13   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "14   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "15   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "16   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "17   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "18   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "19   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "20   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "21   Charlotte Eye Ear Nose & Throat Associates, P.A.     Parsons, Gregory   \n",
       "22   Charlotte Eye Ear Nose & Throat Associates, P.A.     Parsons, Gregory   \n",
       "23   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "24   Charlotte Eye Ear Nose & Throat Associates, P.A.      Sicard, Michael   \n",
       "25   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "26   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "27   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "28   Charlotte Eye Ear Nose & Throat Associates, P.A.  Silver, John Robert   \n",
       "29   Charlotte Eye Ear Nose & Throat Associates, P.A.                        \n",
       "..                                                ...                  ...   \n",
       "506                      ENT Associates of East Texas      Buttram, Angela   \n",
       "507                      ENT Associates of East Texas       Hardee, Monica   \n",
       "508                      ENT Associates of East Texas        Glass, Daniel   \n",
       "509                      ENT Associates of East Texas        Beverly, Lara   \n",
       "510                               CENTA Medical Group       King, Jonathan   \n",
       "511                               CENTA Medical Group       Kirchner, John   \n",
       "512                               CENTA Medical Group    Clements, Matthew   \n",
       "513                 The ENT Center of Central Georgia         Correa, Alex   \n",
       "514                 The ENT Center of Central Georgia        Duke, Sanford   \n",
       "515                 The ENT Center of Central Georgia             Dunn, C.   \n",
       "516                 The ENT Center of Central Georgia        Griffin, John   \n",
       "517                 The ENT Center of Central Georgia        Holmes, Keith   \n",
       "518                 The ENT Center of Central Georgia      Jerles, Matthew   \n",
       "519                 The ENT Center of Central Georgia            Newman, J   \n",
       "520                            Advanced ENT & Allergy       Corbett, Mark    \n",
       "521                               Southeast Texas ENT       Fontenot, Ray    \n",
       "522                               Southeast Texas ENT       Jordan, Carey    \n",
       "523                               Southeast Texas ENT      OMara, William    \n",
       "524                               Southeast Texas ENT        Parks, Steve    \n",
       "525                               Southeast Texas ENT     Roebuck, Jeremy    \n",
       "526                               Southeast Texas ENT  Corbitt, Christian    \n",
       "527                               Southeast Texas ENT      Frederick, Erin   \n",
       "528                               Southeast Texas ENT         Walters, Amy   \n",
       "529                        Minneapolis Otolaryngology          Posey, Lisa   \n",
       "530                        Minneapolis Otolaryngology       Silver, Robert   \n",
       "531                        Minneapolis Otolaryngology         Ayre, Thomas   \n",
       "532                        Minneapolis Otolaryngology      Rapport, Philip   \n",
       "533                        Minneapolis Otolaryngology          Boone, John   \n",
       "534                        Minneapolis Otolaryngology          Drew, Brian   \n",
       "535                        Minneapolis Otolaryngology      Rapport, Philip   \n",
       "\n",
       "     test_date                          type category  \n",
       "0        April           Patient Tests - IGE  Actuals  \n",
       "1         June           Patient Tests - IGE  Actuals  \n",
       "2       August           Patient Tests - IGE  Actuals  \n",
       "3      October           Patient Tests - IGE  Actuals  \n",
       "4     November           Patient Tests - IGE  Actuals  \n",
       "5      January           Patient Tests - IGE  Actuals  \n",
       "6          May           Patient Tests - IGE  Actuals  \n",
       "7         July           Patient Tests - IGE  Actuals  \n",
       "8    September           Patient Tests - IGE  Actuals  \n",
       "9      October           Patient Tests - IGE  Actuals  \n",
       "10    December           Patient Tests - IGE  Actuals  \n",
       "11       April           Patient Tests - IGE  Actuals  \n",
       "12        June           Patient Tests - IGE  Actuals  \n",
       "13     October           Patient Tests - IGE  Actuals  \n",
       "14    November           Patient Tests - IGE  Actuals  \n",
       "15     January           Patient Tests - IGE  Actuals  \n",
       "16         May           Patient Tests - IGE  Actuals  \n",
       "17        July           Patient Tests - IGE  Actuals  \n",
       "18   September           Patient Tests - IGE  Actuals  \n",
       "19     October           Patient Tests - IGE  Actuals  \n",
       "20    December           Patient Tests - IGE  Actuals  \n",
       "21       April           Patient Tests - IGE  Actuals  \n",
       "22        June           Patient Tests - IGE  Actuals  \n",
       "23      August           Patient Tests - IGE  Actuals  \n",
       "24     October           Patient Tests - IGE  Actuals  \n",
       "25    November           Patient Tests - IGE  Actuals  \n",
       "26     January           Patient Tests - IGE  Actuals  \n",
       "27         May           Patient Tests - IGE  Actuals  \n",
       "28        July           Patient Tests - IGE  Actuals  \n",
       "29   September           Patient Tests - IGE  Actuals  \n",
       "..         ...                           ...      ...  \n",
       "506   February  # of Physicians and Midlevel  Actuals  \n",
       "507   February  # of Physicians and Midlevel  Actuals  \n",
       "508   February  # of Physicians and Midlevel  Actuals  \n",
       "509   February  # of Physicians and Midlevel  Actuals  \n",
       "510   February  # of Physicians and Midlevel  Actuals  \n",
       "511   February  # of Physicians and Midlevel  Actuals  \n",
       "512   February  # of Physicians and Midlevel  Actuals  \n",
       "513   February  # of Physicians and Midlevel  Actuals  \n",
       "514   February  # of Physicians and Midlevel  Actuals  \n",
       "515   February  # of Physicians and Midlevel  Actuals  \n",
       "516   February  # of Physicians and Midlevel  Actuals  \n",
       "517   February  # of Physicians and Midlevel  Actuals  \n",
       "518   February  # of Physicians and Midlevel  Actuals  \n",
       "519   February  # of Physicians and Midlevel  Actuals  \n",
       "520   February  # of Physicians and Midlevel  Actuals  \n",
       "521   February  # of Physicians and Midlevel  Actuals  \n",
       "522   February  # of Physicians and Midlevel  Actuals  \n",
       "523   February  # of Physicians and Midlevel  Actuals  \n",
       "524   February  # of Physicians and Midlevel  Actuals  \n",
       "525   February  # of Physicians and Midlevel  Actuals  \n",
       "526   February  # of Physicians and Midlevel  Actuals  \n",
       "527   February  # of Physicians and Midlevel  Actuals  \n",
       "528   February  # of Physicians and Midlevel  Actuals  \n",
       "529   February  # of Physicians and Midlevel  Actuals  \n",
       "530   February  # of Physicians and Midlevel  Actuals  \n",
       "531   February  # of Physicians and Midlevel  Actuals  \n",
       "532   February  # of Physicians and Midlevel  Actuals  \n",
       "533   February  # of Physicians and Midlevel  Actuals  \n",
       "534   February  # of Physicians and Midlevel  Actuals  \n",
       "535   February  # of Physicians and Midlevel  Actuals  \n",
       "\n",
       "[3864904 rows x 12 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#KPI_detail_output = pd.concat([all_tests, food_pricks, food_inj, all_vials, total_injections, treatments, total_patients_ytd, total_errors, total_people_places], axis=0)\n",
    "KPI_detail_output = pd.concat([all_tests, all_vials, total_injections, treatments, total_patients_ytd, total_errors, total_people_places], axis=0)\n",
    "KPI_detail_output['category'] = 'Actuals'\n",
    "KPI_detail_output"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>grouping</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>provider</th>\n",
       "      <th>test_date</th>\n",
       "      <th>category</th>\n",
       "      <th>month_year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - MQT</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2018-02-08 17:19:53</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - MQT</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-10-30 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-01-28 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>01-2016</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-01-27 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-01-27 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Average</td>\n",
       "      <td>2018-01-29 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-02-25 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>02-2016</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-02-26 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>02-2017</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-02-27 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Average</td>\n",
       "      <td>2018-02-22 21:43:54</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-03-23 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>03-2016</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-03-31 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-03-27 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-04-30 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>04-2016</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-04-29 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-04-21 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-05-21 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>05-2016</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-05-25 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-05-31 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>06-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-06-15 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-06-29 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-06-29 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>07-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-07-13 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-07-27 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-07-27 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-08-20 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-08-31 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-08-30 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-09-24 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-09-29 00:00:00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>425</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-03-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>426</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>03-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-03-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>427</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-03-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>428</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-04-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>429</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>04-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-04-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>430</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-04-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>431</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-05-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>432</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>05-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-05-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>433</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-05-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>434</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>06-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-06-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>435</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-06-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>436</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-06-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>437</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>07-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-07-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>438</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-07-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>439</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-07-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>440</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-08-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>441</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-08-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>442</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-08-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>443</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-09-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>444</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-09-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>445</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-09-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>446</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>10-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-10-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>447</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>10-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-10-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>448</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-10-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>449</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-11-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>450</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>11-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-11-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>451</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-11-30 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>452</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>12-2015</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2015-12-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>453</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>12-2016</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2016-12-31 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>454</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Average</td>\n",
       "      <td>2017-12-31 23:59:59</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>455 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    grouping                    type benchmark_date  Patients_Tested  \\\n",
       "0     Group1     Patient Tests - MQT        02-2018                1   \n",
       "1     Group1     Patient Tests - MQT        10-2017                1   \n",
       "2     Group1  Patient Tests - Sticks        01-2015                2   \n",
       "3     Group1  Patient Tests - Sticks        01-2016                4   \n",
       "4     Group1  Patient Tests - Sticks        01-2017                4   \n",
       "5     Group1  Patient Tests - Sticks        01-2018                4   \n",
       "6     Group1  Patient Tests - Sticks        02-2015                2   \n",
       "7     Group1  Patient Tests - Sticks        02-2016                7   \n",
       "8     Group1  Patient Tests - Sticks        02-2017                5   \n",
       "9     Group1  Patient Tests - Sticks        02-2018                2   \n",
       "10    Group1  Patient Tests - Sticks        03-2015                6   \n",
       "11    Group1  Patient Tests - Sticks        03-2016                8   \n",
       "12    Group1  Patient Tests - Sticks        03-2017                8   \n",
       "13    Group1  Patient Tests - Sticks        04-2015                3   \n",
       "14    Group1  Patient Tests - Sticks        04-2016               11   \n",
       "15    Group1  Patient Tests - Sticks        04-2017                7   \n",
       "16    Group1  Patient Tests - Sticks        05-2015                4   \n",
       "17    Group1  Patient Tests - Sticks        05-2016               18   \n",
       "18    Group1  Patient Tests - Sticks        05-2017                7   \n",
       "19    Group1  Patient Tests - Sticks        06-2015                1   \n",
       "20    Group1  Patient Tests - Sticks        06-2016               13   \n",
       "21    Group1  Patient Tests - Sticks        06-2017                7   \n",
       "22    Group1  Patient Tests - Sticks        07-2015                1   \n",
       "23    Group1  Patient Tests - Sticks        07-2016                5   \n",
       "24    Group1  Patient Tests - Sticks        07-2017                4   \n",
       "25    Group1  Patient Tests - Sticks        08-2015                2   \n",
       "26    Group1  Patient Tests - Sticks        08-2016                7   \n",
       "27    Group1  Patient Tests - Sticks        08-2017                8   \n",
       "28    Group1  Patient Tests - Sticks        09-2015                4   \n",
       "29    Group1  Patient Tests - Sticks        09-2016                6   \n",
       "..       ...                     ...            ...              ...   \n",
       "425   Group9   # of Mixing Locations        03-2015                1   \n",
       "426   Group9   # of Mixing Locations        03-2016                1   \n",
       "427   Group9   # of Mixing Locations        03-2017                1   \n",
       "428   Group9   # of Mixing Locations        04-2015                1   \n",
       "429   Group9   # of Mixing Locations        04-2016                1   \n",
       "430   Group9   # of Mixing Locations        04-2017                1   \n",
       "431   Group9   # of Mixing Locations        05-2015                1   \n",
       "432   Group9   # of Mixing Locations        05-2016                1   \n",
       "433   Group9   # of Mixing Locations        05-2017                1   \n",
       "434   Group9   # of Mixing Locations        06-2015                1   \n",
       "435   Group9   # of Mixing Locations        06-2016                1   \n",
       "436   Group9   # of Mixing Locations        06-2017                1   \n",
       "437   Group9   # of Mixing Locations        07-2015                1   \n",
       "438   Group9   # of Mixing Locations        07-2016                1   \n",
       "439   Group9   # of Mixing Locations        07-2017                1   \n",
       "440   Group9   # of Mixing Locations        08-2015                1   \n",
       "441   Group9   # of Mixing Locations        08-2016                1   \n",
       "442   Group9   # of Mixing Locations        08-2017                1   \n",
       "443   Group9   # of Mixing Locations        09-2015                1   \n",
       "444   Group9   # of Mixing Locations        09-2016                1   \n",
       "445   Group9   # of Mixing Locations        09-2017                1   \n",
       "446   Group9   # of Mixing Locations        10-2015                1   \n",
       "447   Group9   # of Mixing Locations        10-2016                1   \n",
       "448   Group9   # of Mixing Locations        10-2017                1   \n",
       "449   Group9   # of Mixing Locations        11-2015                1   \n",
       "450   Group9   # of Mixing Locations        11-2016                1   \n",
       "451   Group9   # of Mixing Locations        11-2017                1   \n",
       "452   Group9   # of Mixing Locations        12-2015                1   \n",
       "453   Group9   # of Mixing Locations        12-2016                1   \n",
       "454   Group9   # of Mixing Locations        12-2017                1   \n",
       "\n",
       "     location_id  location_name  practice_id  practice_name  provider  \\\n",
       "0              1              1            1              1         1   \n",
       "1              1              1            1              1         1   \n",
       "2              2              2            2              2         2   \n",
       "3              4              4            4              4         4   \n",
       "4              4              4            4              4         4   \n",
       "5              4              4            4              4         4   \n",
       "6              2              2            2              2         2   \n",
       "7              7              7            7              7         7   \n",
       "8              5              5            5              5         5   \n",
       "9              2              2            2              2         2   \n",
       "10             6              6            6              6         6   \n",
       "11             8              8            8              8         8   \n",
       "12             8              8            8              8         8   \n",
       "13             3              3            3              3         3   \n",
       "14            11             11           11             11        11   \n",
       "15             7              7            7              7         7   \n",
       "16             4              4            4              4         4   \n",
       "17            18             18           18             18        18   \n",
       "18             7              7            7              7         7   \n",
       "19             1              1            1              1         1   \n",
       "20            13             13           13             13        13   \n",
       "21             7              7            7              7         7   \n",
       "22             1              1            1              1         1   \n",
       "23             5              5            5              5         5   \n",
       "24             4              4            4              4         4   \n",
       "25             2              2            2              2         2   \n",
       "26             7              7            7              7         7   \n",
       "27             8              8            8              8         8   \n",
       "28             4              4            4              4         4   \n",
       "29             6              6            6              6         6   \n",
       "..           ...            ...          ...            ...       ...   \n",
       "425            1              1            1              1         1   \n",
       "426            1              1            1              1         1   \n",
       "427            1              1            1              1         1   \n",
       "428            1              1            1              1         1   \n",
       "429            1              1            1              1         1   \n",
       "430            1              1            1              1         1   \n",
       "431            1              1            1              1         1   \n",
       "432            1              1            1              1         1   \n",
       "433            1              1            1              1         1   \n",
       "434            1              1            1              1         1   \n",
       "435            1              1            1              1         1   \n",
       "436            1              1            1              1         1   \n",
       "437            1              1            1              1         1   \n",
       "438            1              1            1              1         1   \n",
       "439            1              1            1              1         1   \n",
       "440            1              1            1              1         1   \n",
       "441            1              1            1              1         1   \n",
       "442            1              1            1              1         1   \n",
       "443            1              1            1              1         1   \n",
       "444            1              1            1              1         1   \n",
       "445            1              1            1              1         1   \n",
       "446            1              1            1              1         1   \n",
       "447            1              1            1              1         1   \n",
       "448            1              1            1              1         1   \n",
       "449            1              1            1              1         1   \n",
       "450            1              1            1              1         1   \n",
       "451            1              1            1              1         1   \n",
       "452            1              1            1              1         1   \n",
       "453            1              1            1              1         1   \n",
       "454            1              1            1              1         1   \n",
       "\n",
       "     test_date category          month_year  \n",
       "0            1  Average 2018-02-08 17:19:53  \n",
       "1            1  Average 2017-10-30 00:00:00  \n",
       "2            2  Average 2015-01-28 00:00:00  \n",
       "3            4  Average 2016-01-27 00:00:00  \n",
       "4            4  Average 2017-01-27 00:00:00  \n",
       "5            4  Average 2018-01-29 00:00:00  \n",
       "6            2  Average 2015-02-25 00:00:00  \n",
       "7            7  Average 2016-02-26 00:00:00  \n",
       "8            5  Average 2017-02-27 00:00:00  \n",
       "9            2  Average 2018-02-22 21:43:54  \n",
       "10           6  Average 2015-03-23 00:00:00  \n",
       "11           8  Average 2016-03-31 00:00:00  \n",
       "12           8  Average 2017-03-27 00:00:00  \n",
       "13           3  Average 2015-04-30 00:00:00  \n",
       "14          11  Average 2016-04-29 00:00:00  \n",
       "15           7  Average 2017-04-21 00:00:00  \n",
       "16           4  Average 2015-05-21 00:00:00  \n",
       "17          18  Average 2016-05-25 00:00:00  \n",
       "18           7  Average 2017-05-31 00:00:00  \n",
       "19           1  Average 2015-06-15 00:00:00  \n",
       "20          13  Average 2016-06-29 00:00:00  \n",
       "21           7  Average 2017-06-29 00:00:00  \n",
       "22           1  Average 2015-07-13 00:00:00  \n",
       "23           5  Average 2016-07-27 00:00:00  \n",
       "24           4  Average 2017-07-27 00:00:00  \n",
       "25           2  Average 2015-08-20 00:00:00  \n",
       "26           7  Average 2016-08-31 00:00:00  \n",
       "27           8  Average 2017-08-30 00:00:00  \n",
       "28           4  Average 2015-09-24 00:00:00  \n",
       "29           6  Average 2016-09-29 00:00:00  \n",
       "..         ...      ...                 ...  \n",
       "425          1  Average 2015-03-31 23:59:59  \n",
       "426          1  Average 2016-03-31 23:59:59  \n",
       "427          1  Average 2017-03-31 23:59:59  \n",
       "428          1  Average 2015-04-30 23:59:59  \n",
       "429          1  Average 2016-04-30 23:59:59  \n",
       "430          1  Average 2017-04-30 23:59:59  \n",
       "431          1  Average 2015-05-31 23:59:59  \n",
       "432          1  Average 2016-05-31 23:59:59  \n",
       "433          1  Average 2017-05-31 23:59:59  \n",
       "434          1  Average 2015-06-30 23:59:59  \n",
       "435          1  Average 2016-06-30 23:59:59  \n",
       "436          1  Average 2017-06-30 23:59:59  \n",
       "437          1  Average 2015-07-31 23:59:59  \n",
       "438          1  Average 2016-07-31 23:59:59  \n",
       "439          1  Average 2017-07-31 23:59:59  \n",
       "440          1  Average 2015-08-31 23:59:59  \n",
       "441          1  Average 2016-08-31 23:59:59  \n",
       "442          1  Average 2017-08-31 23:59:59  \n",
       "443          1  Average 2015-09-30 23:59:59  \n",
       "444          1  Average 2016-09-30 23:59:59  \n",
       "445          1  Average 2017-09-30 23:59:59  \n",
       "446          1  Average 2015-10-31 23:59:59  \n",
       "447          1  Average 2016-10-31 23:59:59  \n",
       "448          1  Average 2017-10-31 23:59:59  \n",
       "449          1  Average 2015-11-30 23:59:59  \n",
       "450          1  Average 2016-11-30 23:59:59  \n",
       "451          1  Average 2017-11-30 23:59:59  \n",
       "452          1  Average 2015-12-31 23:59:59  \n",
       "453          1  Average 2016-12-31 23:59:59  \n",
       "454          1  Average 2017-12-31 23:59:59  \n",
       "\n",
       "[455 rows x 12 columns]"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#KPI_detail_per_practice = KPI_detail_output[KPI_detail_output['practice_id'] == 7]\n",
    "#KPI_detail_per_practice.to_excel('CENT February 2018 YTD AE Dynamic KPIs.xlsx')\n",
    "#KPI_detail_per_practice = KPI_detail_output[KPI_detail_output['practice_id'] == 13]\n",
    "#KPI_detail_per_practice.to_excel('TENT October 2017 YTD AE Dynamic KPIs.xlsx')\n",
    "#KPI_detail_per_practice = KPI_detail_output[KPI_detail_output['practice_id'] == 36]\n",
    "#KPI_detail_per_practice.to_excel('AUGENT October 2017 YTD AE Dynamic KPIs.xlsx')\n",
    "#KPI_detail_per_practice = KPI_detail_output[KPI_detail_output['practice_id'] == 57]\n",
    "#KPI_detail_per_practice.to_excel('Portneuf Ear, Nose and Throat November 2017 YTD AE Dynamic KPIs.xlsx')\n",
    "KPI_detail_per_practice = KPI_detail_output[KPI_detail_output['practice_id'] == 15]\n",
    "#KPI_detail_per_practice.to_excel('ENTSC February 2018 YTD AE Dynamic KPIs.xlsx')\n",
    "#KPI_detail_per_practice = KPI_detail_output[KPI_detail_output['practice_id'] == 20]\n",
    "#KPI_detail_per_practice.to_excel('WENT February 2018 YTD AE Dynamic KPIs.xlsx')\n",
    "KPI_detail_per_practice\n",
    "patient_sum_p = KPI_detail_per_practice[['Patients_Tested', 'benchmark_date', 'grouping', 'location_id', 'location_name', 'practice_id', 'practice_name', 'provider', 'test_date', 'type', 'category']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).count()\n",
    "patient_sum_p\n",
    "date_patient_sum_p = KPI_detail_per_practice[['grouping', 'type', 'benchmark_date', 'month_year']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).max()\n",
    "date_patient_sum_p\n",
    "benchmark_all_p = pd.merge(patient_sum_p, date_patient_sum_p, on=['grouping', 'type', 'benchmark_date'])\n",
    "benchmark_all_p['category'] = 'Average'\n",
    "benchmark_all_p"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>grouping</th>\n",
       "      <th>type</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>provider</th>\n",
       "      <th>test_date</th>\n",
       "      <th>category</th>\n",
       "      <th>month_year</th>\n",
       "      <th>practice_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>11.000000</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-01-30 00:00:00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>01-2016</td>\n",
       "      <td>18.000000</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-01-29 00:00:00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>13.000000</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-01-31 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>58.666667</td>\n",
       "      <td>8</td>\n",
       "      <td>176</td>\n",
       "      <td>176</td>\n",
       "      <td>176</td>\n",
       "      <td>176</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2018-01-31 20:29:38</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>10.500000</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-02-25 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>02-2016</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>16</td>\n",
       "      <td>16</td>\n",
       "      <td>16</td>\n",
       "      <td>16</td>\n",
       "      <td>16</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-02-29 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>02-2017</td>\n",
       "      <td>8.500000</td>\n",
       "      <td>17</td>\n",
       "      <td>17</td>\n",
       "      <td>17</td>\n",
       "      <td>17</td>\n",
       "      <td>17</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-02-28 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>31.600000</td>\n",
       "      <td>9</td>\n",
       "      <td>158</td>\n",
       "      <td>158</td>\n",
       "      <td>158</td>\n",
       "      <td>158</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2018-02-28 18:22:09</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>7.500000</td>\n",
       "      <td>15</td>\n",
       "      <td>15</td>\n",
       "      <td>15</td>\n",
       "      <td>15</td>\n",
       "      <td>15</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-03-27 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>03-2016</td>\n",
       "      <td>13.500000</td>\n",
       "      <td>27</td>\n",
       "      <td>27</td>\n",
       "      <td>27</td>\n",
       "      <td>27</td>\n",
       "      <td>27</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-03-30 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>15.500000</td>\n",
       "      <td>31</td>\n",
       "      <td>31</td>\n",
       "      <td>31</td>\n",
       "      <td>31</td>\n",
       "      <td>31</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-03-30 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>7.333333</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-04-30 00:00:00</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>04-2016</td>\n",
       "      <td>11.500000</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-04-29 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>87.500000</td>\n",
       "      <td>8</td>\n",
       "      <td>175</td>\n",
       "      <td>175</td>\n",
       "      <td>175</td>\n",
       "      <td>175</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-04-28 18:35:16</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-05-26 00:00:00</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>05-2016</td>\n",
       "      <td>16.000000</td>\n",
       "      <td>32</td>\n",
       "      <td>32</td>\n",
       "      <td>32</td>\n",
       "      <td>32</td>\n",
       "      <td>32</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-05-31 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>56.333333</td>\n",
       "      <td>9</td>\n",
       "      <td>169</td>\n",
       "      <td>169</td>\n",
       "      <td>169</td>\n",
       "      <td>169</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-05-31 20:27:35</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>06-2015</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>12</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-06-22 00:00:00</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>7.000000</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-06-29 00:00:00</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>22</td>\n",
       "      <td>200</td>\n",
       "      <td>200</td>\n",
       "      <td>200</td>\n",
       "      <td>200</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-06-30 19:30:57</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>07-2015</td>\n",
       "      <td>11.500000</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>23</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-07-31 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>4.333333</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-07-29 21:54:13</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>78.500000</td>\n",
       "      <td>14</td>\n",
       "      <td>157</td>\n",
       "      <td>157</td>\n",
       "      <td>157</td>\n",
       "      <td>157</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-07-31 19:21:30</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>21.000000</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>21</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-08-31 00:00:00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>13.000000</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>26</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-08-31 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>71.000000</td>\n",
       "      <td>21</td>\n",
       "      <td>213</td>\n",
       "      <td>213</td>\n",
       "      <td>213</td>\n",
       "      <td>213</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-08-31 20:32:37</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>9.500000</td>\n",
       "      <td>19</td>\n",
       "      <td>19</td>\n",
       "      <td>19</td>\n",
       "      <td>19</td>\n",
       "      <td>19</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-09-30 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>11.000000</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>22</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-09-30 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>54.666667</td>\n",
       "      <td>11</td>\n",
       "      <td>164</td>\n",
       "      <td>164</td>\n",
       "      <td>164</td>\n",
       "      <td>164</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-09-29 18:33:03</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Group1</td>\n",
       "      <td>Patient Tests - IGE</td>\n",
       "      <td>10-2015</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-10-29 00:00:00</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>925</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>4.142857</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-03-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>926</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>03-2016</td>\n",
       "      <td>3.700000</td>\n",
       "      <td>37</td>\n",
       "      <td>37</td>\n",
       "      <td>37</td>\n",
       "      <td>37</td>\n",
       "      <td>37</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-03-31 23:59:59</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>927</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>2.650000</td>\n",
       "      <td>53</td>\n",
       "      <td>53</td>\n",
       "      <td>53</td>\n",
       "      <td>53</td>\n",
       "      <td>53</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-03-31 23:59:59</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>928</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>4.142857</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-04-30 23:59:59</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>929</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>04-2016</td>\n",
       "      <td>3.454545</td>\n",
       "      <td>38</td>\n",
       "      <td>38</td>\n",
       "      <td>38</td>\n",
       "      <td>38</td>\n",
       "      <td>38</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-04-30 23:59:59</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>930</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>2.619048</td>\n",
       "      <td>55</td>\n",
       "      <td>55</td>\n",
       "      <td>55</td>\n",
       "      <td>55</td>\n",
       "      <td>55</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-04-30 23:59:59</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>931</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>4.142857</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>29</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-05-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>932</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>05-2016</td>\n",
       "      <td>3.250000</td>\n",
       "      <td>39</td>\n",
       "      <td>39</td>\n",
       "      <td>39</td>\n",
       "      <td>39</td>\n",
       "      <td>39</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-05-31 23:59:59</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>933</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>2.545455</td>\n",
       "      <td>56</td>\n",
       "      <td>56</td>\n",
       "      <td>56</td>\n",
       "      <td>56</td>\n",
       "      <td>56</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-05-31 23:59:59</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>934</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>06-2015</td>\n",
       "      <td>4.125000</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-06-30 23:59:59</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>935</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>3.076923</td>\n",
       "      <td>40</td>\n",
       "      <td>40</td>\n",
       "      <td>40</td>\n",
       "      <td>40</td>\n",
       "      <td>40</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-06-30 23:59:59</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>936</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>2.521739</td>\n",
       "      <td>58</td>\n",
       "      <td>58</td>\n",
       "      <td>58</td>\n",
       "      <td>58</td>\n",
       "      <td>58</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-06-30 23:59:59</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>937</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>07-2015</td>\n",
       "      <td>4.125000</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-07-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>938</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>3.153846</td>\n",
       "      <td>41</td>\n",
       "      <td>41</td>\n",
       "      <td>41</td>\n",
       "      <td>41</td>\n",
       "      <td>41</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-07-31 23:59:59</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>939</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>2.458333</td>\n",
       "      <td>59</td>\n",
       "      <td>59</td>\n",
       "      <td>59</td>\n",
       "      <td>59</td>\n",
       "      <td>59</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-07-31 23:59:59</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>940</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>4.125000</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>33</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-08-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>941</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>3.230769</td>\n",
       "      <td>42</td>\n",
       "      <td>42</td>\n",
       "      <td>42</td>\n",
       "      <td>42</td>\n",
       "      <td>42</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-08-31 23:59:59</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>942</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>2.440000</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-08-31 23:59:59</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>943</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>3.777778</td>\n",
       "      <td>34</td>\n",
       "      <td>34</td>\n",
       "      <td>34</td>\n",
       "      <td>34</td>\n",
       "      <td>34</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-09-30 23:59:59</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>944</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>3.307692</td>\n",
       "      <td>43</td>\n",
       "      <td>43</td>\n",
       "      <td>43</td>\n",
       "      <td>43</td>\n",
       "      <td>43</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-09-30 23:59:59</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>945</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>2.440000</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-09-30 23:59:59</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>946</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>10-2015</td>\n",
       "      <td>3.888889</td>\n",
       "      <td>35</td>\n",
       "      <td>35</td>\n",
       "      <td>35</td>\n",
       "      <td>35</td>\n",
       "      <td>35</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-10-31 23:59:59</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>947</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>10-2016</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>45</td>\n",
       "      <td>45</td>\n",
       "      <td>45</td>\n",
       "      <td>45</td>\n",
       "      <td>45</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-10-31 23:59:59</td>\n",
       "      <td>15</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>948</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>2.440000</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>61</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-10-31 23:59:59</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>949</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-11-30 23:59:59</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>950</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>11-2016</td>\n",
       "      <td>2.875000</td>\n",
       "      <td>46</td>\n",
       "      <td>46</td>\n",
       "      <td>46</td>\n",
       "      <td>46</td>\n",
       "      <td>46</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-11-30 23:59:59</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>951</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>2.333333</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-11-30 23:59:59</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>952</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>12-2015</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>36</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2015-12-31 23:59:59</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>953</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>12-2016</td>\n",
       "      <td>2.937500</td>\n",
       "      <td>47</td>\n",
       "      <td>47</td>\n",
       "      <td>47</td>\n",
       "      <td>47</td>\n",
       "      <td>47</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2016-12-31 23:59:59</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>954</th>\n",
       "      <td>Group9</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>2.333333</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>63</td>\n",
       "      <td>Benchmark All</td>\n",
       "      <td>2017-12-31 23:59:59</td>\n",
       "      <td>27</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>955 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    grouping                   type benchmark_date  Patients_Tested  \\\n",
       "0     Group1    Patient Tests - IGE        01-2015        11.000000   \n",
       "1     Group1    Patient Tests - IGE        01-2016        18.000000   \n",
       "2     Group1    Patient Tests - IGE        01-2017        13.000000   \n",
       "3     Group1    Patient Tests - IGE        01-2018        58.666667   \n",
       "4     Group1    Patient Tests - IGE        02-2015        10.500000   \n",
       "5     Group1    Patient Tests - IGE        02-2016         8.000000   \n",
       "6     Group1    Patient Tests - IGE        02-2017         8.500000   \n",
       "7     Group1    Patient Tests - IGE        02-2018        31.600000   \n",
       "8     Group1    Patient Tests - IGE        03-2015         7.500000   \n",
       "9     Group1    Patient Tests - IGE        03-2016        13.500000   \n",
       "10    Group1    Patient Tests - IGE        03-2017        15.500000   \n",
       "11    Group1    Patient Tests - IGE        04-2015         7.333333   \n",
       "12    Group1    Patient Tests - IGE        04-2016        11.500000   \n",
       "13    Group1    Patient Tests - IGE        04-2017        87.500000   \n",
       "14    Group1    Patient Tests - IGE        05-2015         6.000000   \n",
       "15    Group1    Patient Tests - IGE        05-2016        16.000000   \n",
       "16    Group1    Patient Tests - IGE        05-2017        56.333333   \n",
       "17    Group1    Patient Tests - IGE        06-2015         4.000000   \n",
       "18    Group1    Patient Tests - IGE        06-2016         7.000000   \n",
       "19    Group1    Patient Tests - IGE        06-2017       100.000000   \n",
       "20    Group1    Patient Tests - IGE        07-2015        11.500000   \n",
       "21    Group1    Patient Tests - IGE        07-2016         4.333333   \n",
       "22    Group1    Patient Tests - IGE        07-2017        78.500000   \n",
       "23    Group1    Patient Tests - IGE        08-2015        21.000000   \n",
       "24    Group1    Patient Tests - IGE        08-2016        13.000000   \n",
       "25    Group1    Patient Tests - IGE        08-2017        71.000000   \n",
       "26    Group1    Patient Tests - IGE        09-2015         9.500000   \n",
       "27    Group1    Patient Tests - IGE        09-2016        11.000000   \n",
       "28    Group1    Patient Tests - IGE        09-2017        54.666667   \n",
       "29    Group1    Patient Tests - IGE        10-2015         9.000000   \n",
       "..       ...                    ...            ...              ...   \n",
       "925   Group9  # of Mixing Locations        03-2015         4.142857   \n",
       "926   Group9  # of Mixing Locations        03-2016         3.700000   \n",
       "927   Group9  # of Mixing Locations        03-2017         2.650000   \n",
       "928   Group9  # of Mixing Locations        04-2015         4.142857   \n",
       "929   Group9  # of Mixing Locations        04-2016         3.454545   \n",
       "930   Group9  # of Mixing Locations        04-2017         2.619048   \n",
       "931   Group9  # of Mixing Locations        05-2015         4.142857   \n",
       "932   Group9  # of Mixing Locations        05-2016         3.250000   \n",
       "933   Group9  # of Mixing Locations        05-2017         2.545455   \n",
       "934   Group9  # of Mixing Locations        06-2015         4.125000   \n",
       "935   Group9  # of Mixing Locations        06-2016         3.076923   \n",
       "936   Group9  # of Mixing Locations        06-2017         2.521739   \n",
       "937   Group9  # of Mixing Locations        07-2015         4.125000   \n",
       "938   Group9  # of Mixing Locations        07-2016         3.153846   \n",
       "939   Group9  # of Mixing Locations        07-2017         2.458333   \n",
       "940   Group9  # of Mixing Locations        08-2015         4.125000   \n",
       "941   Group9  # of Mixing Locations        08-2016         3.230769   \n",
       "942   Group9  # of Mixing Locations        08-2017         2.440000   \n",
       "943   Group9  # of Mixing Locations        09-2015         3.777778   \n",
       "944   Group9  # of Mixing Locations        09-2016         3.307692   \n",
       "945   Group9  # of Mixing Locations        09-2017         2.440000   \n",
       "946   Group9  # of Mixing Locations        10-2015         3.888889   \n",
       "947   Group9  # of Mixing Locations        10-2016         3.000000   \n",
       "948   Group9  # of Mixing Locations        10-2017         2.440000   \n",
       "949   Group9  # of Mixing Locations        11-2015         4.000000   \n",
       "950   Group9  # of Mixing Locations        11-2016         2.875000   \n",
       "951   Group9  # of Mixing Locations        11-2017         2.333333   \n",
       "952   Group9  # of Mixing Locations        12-2015         4.000000   \n",
       "953   Group9  # of Mixing Locations        12-2016         2.937500   \n",
       "954   Group9  # of Mixing Locations        12-2017         2.333333   \n",
       "\n",
       "     location_id  location_name  practice_name  provider  test_date  \\\n",
       "0             11             11             11        11         11   \n",
       "1             18             18             18        18         18   \n",
       "2             26             26             26        26         26   \n",
       "3              8            176            176       176        176   \n",
       "4             21             21             21        21         21   \n",
       "5             16             16             16        16         16   \n",
       "6             17             17             17        17         17   \n",
       "7              9            158            158       158        158   \n",
       "8             15             15             15        15         15   \n",
       "9             27             27             27        27         27   \n",
       "10            31             31             31        31         31   \n",
       "11            22             22             22        22         22   \n",
       "12            23             23             23        23         23   \n",
       "13             8            175            175       175        175   \n",
       "14            18             18             18        18         18   \n",
       "15            32             32             32        32         32   \n",
       "16             9            169            169       169        169   \n",
       "17            12             12             12        12         12   \n",
       "18            21             21             21        21         21   \n",
       "19            22            200            200       200        200   \n",
       "20            23             23             23        23         23   \n",
       "21            13             13             13        13         13   \n",
       "22            14            157            157       157        157   \n",
       "23            21             21             21        21         21   \n",
       "24            26             26             26        26         26   \n",
       "25            21            213            213       213        213   \n",
       "26            19             19             19        19         19   \n",
       "27            22             22             22        22         22   \n",
       "28            11            164            164       164        164   \n",
       "29            18             18             18        18         18   \n",
       "..           ...            ...            ...       ...        ...   \n",
       "925           29             29             29        29         29   \n",
       "926           37             37             37        37         37   \n",
       "927           53             53             53        53         53   \n",
       "928           29             29             29        29         29   \n",
       "929           38             38             38        38         38   \n",
       "930           55             55             55        55         55   \n",
       "931           29             29             29        29         29   \n",
       "932           39             39             39        39         39   \n",
       "933           56             56             56        56         56   \n",
       "934           33             33             33        33         33   \n",
       "935           40             40             40        40         40   \n",
       "936           58             58             58        58         58   \n",
       "937           33             33             33        33         33   \n",
       "938           41             41             41        41         41   \n",
       "939           59             59             59        59         59   \n",
       "940           33             33             33        33         33   \n",
       "941           42             42             42        42         42   \n",
       "942           61             61             61        61         61   \n",
       "943           34             34             34        34         34   \n",
       "944           43             43             43        43         43   \n",
       "945           61             61             61        61         61   \n",
       "946           35             35             35        35         35   \n",
       "947           45             45             45        45         45   \n",
       "948           61             61             61        61         61   \n",
       "949           36             36             36        36         36   \n",
       "950           46             46             46        46         46   \n",
       "951           63             63             63        63         63   \n",
       "952           36             36             36        36         36   \n",
       "953           47             47             47        47         47   \n",
       "954           63             63             63        63         63   \n",
       "\n",
       "          category          month_year  practice_id  \n",
       "0    Benchmark All 2015-01-30 00:00:00            1  \n",
       "1    Benchmark All 2016-01-29 00:00:00            1  \n",
       "2    Benchmark All 2017-01-31 00:00:00            2  \n",
       "3    Benchmark All 2018-01-31 20:29:38            3  \n",
       "4    Benchmark All 2015-02-25 00:00:00            2  \n",
       "5    Benchmark All 2016-02-29 00:00:00            2  \n",
       "6    Benchmark All 2017-02-28 00:00:00            2  \n",
       "7    Benchmark All 2018-02-28 18:22:09            5  \n",
       "8    Benchmark All 2015-03-27 00:00:00            2  \n",
       "9    Benchmark All 2016-03-30 00:00:00            2  \n",
       "10   Benchmark All 2017-03-30 00:00:00            2  \n",
       "11   Benchmark All 2015-04-30 00:00:00            3  \n",
       "12   Benchmark All 2016-04-29 00:00:00            2  \n",
       "13   Benchmark All 2017-04-28 18:35:16            2  \n",
       "14   Benchmark All 2015-05-26 00:00:00            3  \n",
       "15   Benchmark All 2016-05-31 00:00:00            2  \n",
       "16   Benchmark All 2017-05-31 20:27:35            3  \n",
       "17   Benchmark All 2015-06-22 00:00:00            3  \n",
       "18   Benchmark All 2016-06-29 00:00:00            3  \n",
       "19   Benchmark All 2017-06-30 19:30:57            2  \n",
       "20   Benchmark All 2015-07-31 00:00:00            2  \n",
       "21   Benchmark All 2016-07-29 21:54:13            3  \n",
       "22   Benchmark All 2017-07-31 19:21:30            2  \n",
       "23   Benchmark All 2015-08-31 00:00:00            1  \n",
       "24   Benchmark All 2016-08-31 00:00:00            2  \n",
       "25   Benchmark All 2017-08-31 20:32:37            3  \n",
       "26   Benchmark All 2015-09-30 00:00:00            2  \n",
       "27   Benchmark All 2016-09-30 00:00:00            2  \n",
       "28   Benchmark All 2017-09-29 18:33:03            3  \n",
       "29   Benchmark All 2015-10-29 00:00:00            2  \n",
       "..             ...                 ...          ...  \n",
       "925  Benchmark All 2015-03-31 23:59:59            7  \n",
       "926  Benchmark All 2016-03-31 23:59:59           10  \n",
       "927  Benchmark All 2017-03-31 23:59:59           20  \n",
       "928  Benchmark All 2015-04-30 23:59:59            7  \n",
       "929  Benchmark All 2016-04-30 23:59:59           11  \n",
       "930  Benchmark All 2017-04-30 23:59:59           21  \n",
       "931  Benchmark All 2015-05-31 23:59:59            7  \n",
       "932  Benchmark All 2016-05-31 23:59:59           12  \n",
       "933  Benchmark All 2017-05-31 23:59:59           22  \n",
       "934  Benchmark All 2015-06-30 23:59:59            8  \n",
       "935  Benchmark All 2016-06-30 23:59:59           13  \n",
       "936  Benchmark All 2017-06-30 23:59:59           23  \n",
       "937  Benchmark All 2015-07-31 23:59:59            8  \n",
       "938  Benchmark All 2016-07-31 23:59:59           13  \n",
       "939  Benchmark All 2017-07-31 23:59:59           24  \n",
       "940  Benchmark All 2015-08-31 23:59:59            8  \n",
       "941  Benchmark All 2016-08-31 23:59:59           13  \n",
       "942  Benchmark All 2017-08-31 23:59:59           25  \n",
       "943  Benchmark All 2015-09-30 23:59:59            9  \n",
       "944  Benchmark All 2016-09-30 23:59:59           13  \n",
       "945  Benchmark All 2017-09-30 23:59:59           25  \n",
       "946  Benchmark All 2015-10-31 23:59:59            9  \n",
       "947  Benchmark All 2016-10-31 23:59:59           15  \n",
       "948  Benchmark All 2017-10-31 23:59:59           25  \n",
       "949  Benchmark All 2015-11-30 23:59:59            9  \n",
       "950  Benchmark All 2016-11-30 23:59:59           16  \n",
       "951  Benchmark All 2017-11-30 23:59:59           27  \n",
       "952  Benchmark All 2015-12-31 23:59:59            9  \n",
       "953  Benchmark All 2016-12-31 23:59:59           16  \n",
       "954  Benchmark All 2017-12-31 23:59:59           27  \n",
       "\n",
       "[955 rows x 12 columns]"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "patient_sum = KPI_detail_output[['Patients_Tested', 'benchmark_date', 'grouping', 'location_id', 'location_name', 'practice_name', 'provider', 'test_date', 'type', 'category']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).count()\n",
    "patient_sum\n",
    "date_patient_sum = KPI_detail_output[['grouping', 'type', 'benchmark_date', 'month_year']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).max()\n",
    "date_patient_sum\n",
    "practice_patient_sum = KPI_detail_output[['grouping', 'type', 'benchmark_date', 'practice_id']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).nunique()\n",
    "practice_patient_sum\n",
    "benchmark_all = pd.merge(patient_sum, date_patient_sum, on=['grouping', 'type', 'benchmark_date'])\n",
    "benchmark_all['category'] = 'Benchmark All'\n",
    "benchmark_all = pd.concat([benchmark_all, practice_patient_sum['practice_id']], axis=1)\n",
    "benchmark_all['Patients_Tested'] = benchmark_all['Patients_Tested'] / benchmark_all['practice_id']\n",
    "benchmark_all\n",
    "#benchmark_all_updated = pd.pivot_table(KPI_detail_output, index=['grouping', 'type', 'benchmark_date'], values=['Patients_Tested'], )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "# SCIT Vials Mixed for New Patients         19\n",
       "# SLIT Vials Mixed for New Patients          5\n",
       "# Unknown Vials Mixed for New Patients       0\n",
       "# of Errors                                 54\n",
       "# of Injections                           1560\n",
       "# of Mixing Locations                        1\n",
       "# of New Patients on SCIT                   19\n",
       "# of New Patients on SLIT                    2\n",
       "# of New Patients on Unknown                 0\n",
       "# of Physicians and Midlevel                15\n",
       "# of Techs                                   7\n",
       "# of Total SCIT Vials Mixed                267\n",
       "# of Total SLIT Vials Mixed                 39\n",
       "# of Total Unknown Vials Mixed               2\n",
       "Allergy Tests - IGE                          4\n",
       "Allergy Tests - MQT                         33\n",
       "Allergy Tests - Pricks                       8\n",
       "Allergy Tests - Sticks                      11\n",
       "Patient Tests - IGE                          2\n",
       "Patient Tests - MQT                         33\n",
       "Patient Tests - Pricks                       7\n",
       "Patient Tests - Sticks                      11\n",
       "Total Active Patients on SCIT              913\n",
       "Total Active Patients on SLIT              191\n",
       "Total Active Patients on Unknown           403\n",
       "Subtotal Allergy Activity                 3621\n",
       "Group1                                      55\n",
       "Group10                                      7\n",
       "Group11                                     15\n",
       "Group2                                      58\n",
       "Group3                                      25\n",
       "Group4                                     310\n",
       "Group5                                    1560\n",
       "Group6                                      22\n",
       "Group7                                    1509\n",
       "Group8                                      54\n",
       "Group9                                       1\n",
       "Subtotal Allergy Activity                 3621\n",
       "Name: (Patients_Tested, Benchmark All Allergy Activity, ), dtype: int32"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "### Not Needed###\n",
    "benchmark_all = pd.pivot_table(KPI_detail_output, index=['type'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_all\n",
    "benchmark_all['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_all['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(practices)).astype(int)\n",
    "benchmark_all\n",
    "benchmark_all_AE = benchmark_all['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "#benchmark_all_AE.to_excel('AllergyEDGE Tests Examples All Benchmark.xlsx')\n",
    "benchmark_all_AE\n",
    "benchmark_totals = pd.pivot_table(KPI_detail_output, index=['grouping'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_totals['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_totals['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(practices)).astype(int)\n",
    "benchmark_totals_AE = benchmark_totals['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "benchmark_totals_AE\n",
    "complete_benchmarks_all = pd.concat([benchmark_all_AE, benchmark_totals_AE], axis=0)\n",
    "complete_benchmarks_all.to_excel('AllergyEDGE Tests Examples All Benchmark.xlsx')\n",
    "complete_benchmarks_all"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[34, 37, 42, 49, 50, 51, 54, 55, 56, 57]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_doctors = pd.read_sql_query(\"SELECT pd.practice_id, count(DISTINCT(pd.id)) as total_doctors, count(p.id) AS total_patients FROM practice_doctors pd LEFT JOIN patients p ON pd.id = p.mix_practice_doctor_id WHERE pd.active = 1 AND pd.practice_ID <> 53 GROUP BY pd.practice_id\", myconnection)\n",
    "total_doctors.sort_values('total_doctors')\n",
    "Small, Medium, Large = total_doctors[total_doctors['total_doctors'] <= 4], total_doctors[(total_doctors['total_doctors'] <= 10) & (total_doctors['total_doctors'] >= 5)], total_doctors[total_doctors['total_doctors'] >= 11]\n",
    "Small = Small[['practice_id']].astype(int)\n",
    "Medium = Medium[['practice_id']].astype(int)\n",
    "Large = Large[['practice_id']].astype(int)\n",
    "benchmark_groups = tuple(Large.practice_id)\n",
    "benchmark_groups_Medium = list(Medium.practice_id)\n",
    "benchmark_groups_Medium\n",
    "benchmark_groups_Large = list(Large.practice_id)\n",
    "benchmark_groups_Large\n",
    "benchmark_groups_Small = list(Small.practice_id)\n",
    "benchmark_groups_Small"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Patients_Tested</th>\n",
       "      <th>benchmark_date</th>\n",
       "      <th>category</th>\n",
       "      <th>grouping</th>\n",
       "      <th>location_id</th>\n",
       "      <th>location_name</th>\n",
       "      <th>month_year</th>\n",
       "      <th>practice_id</th>\n",
       "      <th>practice_name</th>\n",
       "      <th>provider</th>\n",
       "      <th>test_date</th>\n",
       "      <th>type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.0</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2018-02-08 17:19:53</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Patient Tests - MQT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.0</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2017-10-30 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Patient Tests - MQT</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2.0</td>\n",
       "      <td>01-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2015-01-28 00:00:00</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4.0</td>\n",
       "      <td>01-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2016-01-27 00:00:00</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4.0</td>\n",
       "      <td>01-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-01-27 00:00:00</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>4.0</td>\n",
       "      <td>01-2018</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2018-01-29 00:00:00</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>2.0</td>\n",
       "      <td>02-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2015-02-25 00:00:00</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7.0</td>\n",
       "      <td>02-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2016-02-26 00:00:00</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>5.0</td>\n",
       "      <td>02-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2017-02-27 00:00:00</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>2.0</td>\n",
       "      <td>02-2018</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2018-02-22 21:43:54</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>6.0</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>2015-03-23 00:00:00</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>8.0</td>\n",
       "      <td>03-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2016-03-31 00:00:00</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>8.0</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-03-27 00:00:00</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>3.0</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-04-30 00:00:00</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>11.0</td>\n",
       "      <td>04-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>2016-04-29 00:00:00</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>11</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>7.0</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2017-04-21 00:00:00</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>4.0</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2015-05-21 00:00:00</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18.0</td>\n",
       "      <td>05-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>2016-05-25 00:00:00</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>18</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>7.0</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2017-05-31 00:00:00</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1.0</td>\n",
       "      <td>06-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2015-06-15 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>13.0</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>2016-06-29 00:00:00</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>13</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>7.0</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2017-06-29 00:00:00</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1.0</td>\n",
       "      <td>07-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2015-07-13 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>5.0</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-07-27 00:00:00</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>4.0</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2017-07-27 00:00:00</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>2.0</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2015-08-20 00:00:00</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>7.0</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2016-08-31 00:00:00</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>8.0</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-08-30 00:00:00</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>4.0</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2015-09-24 00:00:00</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>6.0</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>Average</td>\n",
       "      <td>Group1</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>2016-09-29 00:00:00</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>6</td>\n",
       "      <td>Patient Tests - Sticks</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>787</th>\n",
       "      <td>1.0</td>\n",
       "      <td>03-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-03-31 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>788</th>\n",
       "      <td>1.0</td>\n",
       "      <td>03-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2016-03-31 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>789</th>\n",
       "      <td>1.0</td>\n",
       "      <td>03-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-03-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>790</th>\n",
       "      <td>1.0</td>\n",
       "      <td>04-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-04-30 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>791</th>\n",
       "      <td>1.0</td>\n",
       "      <td>04-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2016-04-30 23:59:59</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>792</th>\n",
       "      <td>1.0</td>\n",
       "      <td>04-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-04-30 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>793</th>\n",
       "      <td>1.0</td>\n",
       "      <td>05-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-05-31 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>794</th>\n",
       "      <td>1.0</td>\n",
       "      <td>05-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2016-05-31 23:59:59</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>795</th>\n",
       "      <td>1.0</td>\n",
       "      <td>05-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-05-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>796</th>\n",
       "      <td>1.0</td>\n",
       "      <td>06-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-06-30 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>797</th>\n",
       "      <td>1.0</td>\n",
       "      <td>06-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-06-30 23:59:59</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>798</th>\n",
       "      <td>1.0</td>\n",
       "      <td>06-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-06-30 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>799</th>\n",
       "      <td>1.0</td>\n",
       "      <td>07-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-07-31 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>800</th>\n",
       "      <td>1.0</td>\n",
       "      <td>07-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-07-31 23:59:59</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>801</th>\n",
       "      <td>1.0</td>\n",
       "      <td>07-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-07-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>802</th>\n",
       "      <td>1.0</td>\n",
       "      <td>08-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-08-31 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>803</th>\n",
       "      <td>1.0</td>\n",
       "      <td>08-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-08-31 23:59:59</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>804</th>\n",
       "      <td>1.0</td>\n",
       "      <td>08-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-08-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>805</th>\n",
       "      <td>1.0</td>\n",
       "      <td>09-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-09-30 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>806</th>\n",
       "      <td>1.0</td>\n",
       "      <td>09-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>2016-09-30 23:59:59</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td>5</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>807</th>\n",
       "      <td>1.0</td>\n",
       "      <td>09-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-09-30 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>808</th>\n",
       "      <td>1.0</td>\n",
       "      <td>10-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-10-31 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>809</th>\n",
       "      <td>1.0</td>\n",
       "      <td>10-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>2016-10-31 23:59:59</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td>7</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>810</th>\n",
       "      <td>1.0</td>\n",
       "      <td>10-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2017-10-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>811</th>\n",
       "      <td>1.0</td>\n",
       "      <td>11-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-11-30 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>812</th>\n",
       "      <td>1.0</td>\n",
       "      <td>11-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2016-11-30 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>813</th>\n",
       "      <td>1.0</td>\n",
       "      <td>11-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-11-30 23:59:59</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>814</th>\n",
       "      <td>1.0</td>\n",
       "      <td>12-2015</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>2015-12-31 23:59:59</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>815</th>\n",
       "      <td>1.0</td>\n",
       "      <td>12-2016</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>2016-12-31 23:59:59</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td>8</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>816</th>\n",
       "      <td>1.0</td>\n",
       "      <td>12-2017</td>\n",
       "      <td>Benchmark Medium</td>\n",
       "      <td>Group9</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-12-31 23:59:59</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td>10</td>\n",
       "      <td># of Mixing Locations</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2227 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Patients_Tested benchmark_date          category grouping  location_id  \\\n",
       "0                1.0        02-2018           Average   Group1            1   \n",
       "1                1.0        10-2017           Average   Group1            1   \n",
       "2                2.0        01-2015           Average   Group1            2   \n",
       "3                4.0        01-2016           Average   Group1            4   \n",
       "4                4.0        01-2017           Average   Group1            4   \n",
       "5                4.0        01-2018           Average   Group1            4   \n",
       "6                2.0        02-2015           Average   Group1            2   \n",
       "7                7.0        02-2016           Average   Group1            7   \n",
       "8                5.0        02-2017           Average   Group1            5   \n",
       "9                2.0        02-2018           Average   Group1            2   \n",
       "10               6.0        03-2015           Average   Group1            6   \n",
       "11               8.0        03-2016           Average   Group1            8   \n",
       "12               8.0        03-2017           Average   Group1            8   \n",
       "13               3.0        04-2015           Average   Group1            3   \n",
       "14              11.0        04-2016           Average   Group1           11   \n",
       "15               7.0        04-2017           Average   Group1            7   \n",
       "16               4.0        05-2015           Average   Group1            4   \n",
       "17              18.0        05-2016           Average   Group1           18   \n",
       "18               7.0        05-2017           Average   Group1            7   \n",
       "19               1.0        06-2015           Average   Group1            1   \n",
       "20              13.0        06-2016           Average   Group1           13   \n",
       "21               7.0        06-2017           Average   Group1            7   \n",
       "22               1.0        07-2015           Average   Group1            1   \n",
       "23               5.0        07-2016           Average   Group1            5   \n",
       "24               4.0        07-2017           Average   Group1            4   \n",
       "25               2.0        08-2015           Average   Group1            2   \n",
       "26               7.0        08-2016           Average   Group1            7   \n",
       "27               8.0        08-2017           Average   Group1            8   \n",
       "28               4.0        09-2015           Average   Group1            4   \n",
       "29               6.0        09-2016           Average   Group1            6   \n",
       "..               ...            ...               ...      ...          ...   \n",
       "787              1.0        03-2015  Benchmark Medium   Group9            3   \n",
       "788              1.0        03-2016  Benchmark Medium   Group9            3   \n",
       "789              1.0        03-2017  Benchmark Medium   Group9            8   \n",
       "790              1.0        04-2015  Benchmark Medium   Group9            3   \n",
       "791              1.0        04-2016  Benchmark Medium   Group9            4   \n",
       "792              1.0        04-2017  Benchmark Medium   Group9            8   \n",
       "793              1.0        05-2015  Benchmark Medium   Group9            3   \n",
       "794              1.0        05-2016  Benchmark Medium   Group9            4   \n",
       "795              1.0        05-2017  Benchmark Medium   Group9            8   \n",
       "796              1.0        06-2015  Benchmark Medium   Group9            3   \n",
       "797              1.0        06-2016  Benchmark Medium   Group9            5   \n",
       "798              1.0        06-2017  Benchmark Medium   Group9            8   \n",
       "799              1.0        07-2015  Benchmark Medium   Group9            3   \n",
       "800              1.0        07-2016  Benchmark Medium   Group9            5   \n",
       "801              1.0        07-2017  Benchmark Medium   Group9            8   \n",
       "802              1.0        08-2015  Benchmark Medium   Group9            3   \n",
       "803              1.0        08-2016  Benchmark Medium   Group9            5   \n",
       "804              1.0        08-2017  Benchmark Medium   Group9            8   \n",
       "805              1.0        09-2015  Benchmark Medium   Group9            3   \n",
       "806              1.0        09-2016  Benchmark Medium   Group9            5   \n",
       "807              1.0        09-2017  Benchmark Medium   Group9            8   \n",
       "808              1.0        10-2015  Benchmark Medium   Group9            3   \n",
       "809              1.0        10-2016  Benchmark Medium   Group9            7   \n",
       "810              1.0        10-2017  Benchmark Medium   Group9            8   \n",
       "811              1.0        11-2015  Benchmark Medium   Group9            3   \n",
       "812              1.0        11-2016  Benchmark Medium   Group9            8   \n",
       "813              1.0        11-2017  Benchmark Medium   Group9           10   \n",
       "814              1.0        12-2015  Benchmark Medium   Group9            3   \n",
       "815              1.0        12-2016  Benchmark Medium   Group9            8   \n",
       "816              1.0        12-2017  Benchmark Medium   Group9           10   \n",
       "\n",
       "     location_name          month_year  practice_id  practice_name  provider  \\\n",
       "0                1 2018-02-08 17:19:53            1              1         1   \n",
       "1                1 2017-10-30 00:00:00            1              1         1   \n",
       "2                2 2015-01-28 00:00:00            2              2         2   \n",
       "3                4 2016-01-27 00:00:00            4              4         4   \n",
       "4                4 2017-01-27 00:00:00            4              4         4   \n",
       "5                4 2018-01-29 00:00:00            4              4         4   \n",
       "6                2 2015-02-25 00:00:00            2              2         2   \n",
       "7                7 2016-02-26 00:00:00            7              7         7   \n",
       "8                5 2017-02-27 00:00:00            5              5         5   \n",
       "9                2 2018-02-22 21:43:54            2              2         2   \n",
       "10               6 2015-03-23 00:00:00            6              6         6   \n",
       "11               8 2016-03-31 00:00:00            8              8         8   \n",
       "12               8 2017-03-27 00:00:00            8              8         8   \n",
       "13               3 2015-04-30 00:00:00            3              3         3   \n",
       "14              11 2016-04-29 00:00:00           11             11        11   \n",
       "15               7 2017-04-21 00:00:00            7              7         7   \n",
       "16               4 2015-05-21 00:00:00            4              4         4   \n",
       "17              18 2016-05-25 00:00:00           18             18        18   \n",
       "18               7 2017-05-31 00:00:00            7              7         7   \n",
       "19               1 2015-06-15 00:00:00            1              1         1   \n",
       "20              13 2016-06-29 00:00:00           13             13        13   \n",
       "21               7 2017-06-29 00:00:00            7              7         7   \n",
       "22               1 2015-07-13 00:00:00            1              1         1   \n",
       "23               5 2016-07-27 00:00:00            5              5         5   \n",
       "24               4 2017-07-27 00:00:00            4              4         4   \n",
       "25               2 2015-08-20 00:00:00            2              2         2   \n",
       "26               7 2016-08-31 00:00:00            7              7         7   \n",
       "27               8 2017-08-30 00:00:00            8              8         8   \n",
       "28               4 2015-09-24 00:00:00            4              4         4   \n",
       "29               6 2016-09-29 00:00:00            6              6         6   \n",
       "..             ...                 ...          ...            ...       ...   \n",
       "787              3 2015-03-31 23:59:59            3              3         3   \n",
       "788              3 2016-03-31 23:59:59            3              3         3   \n",
       "789              8 2017-03-31 23:59:59            8              8         8   \n",
       "790              3 2015-04-30 23:59:59            3              3         3   \n",
       "791              4 2016-04-30 23:59:59            4              4         4   \n",
       "792              8 2017-04-30 23:59:59            8              8         8   \n",
       "793              3 2015-05-31 23:59:59            3              3         3   \n",
       "794              4 2016-05-31 23:59:59            4              4         4   \n",
       "795              8 2017-05-31 23:59:59            8              8         8   \n",
       "796              3 2015-06-30 23:59:59            3              3         3   \n",
       "797              5 2016-06-30 23:59:59            5              5         5   \n",
       "798              8 2017-06-30 23:59:59            8              8         8   \n",
       "799              3 2015-07-31 23:59:59            3              3         3   \n",
       "800              5 2016-07-31 23:59:59            5              5         5   \n",
       "801              8 2017-07-31 23:59:59            8              8         8   \n",
       "802              3 2015-08-31 23:59:59            3              3         3   \n",
       "803              5 2016-08-31 23:59:59            5              5         5   \n",
       "804              8 2017-08-31 23:59:59            8              8         8   \n",
       "805              3 2015-09-30 23:59:59            3              3         3   \n",
       "806              5 2016-09-30 23:59:59            5              5         5   \n",
       "807              8 2017-09-30 23:59:59            8              8         8   \n",
       "808              3 2015-10-31 23:59:59            3              3         3   \n",
       "809              7 2016-10-31 23:59:59            7              7         7   \n",
       "810              8 2017-10-31 23:59:59            8              8         8   \n",
       "811              3 2015-11-30 23:59:59            3              3         3   \n",
       "812              8 2016-11-30 23:59:59            8              8         8   \n",
       "813             10 2017-11-30 23:59:59           10             10        10   \n",
       "814              3 2015-12-31 23:59:59            3              3         3   \n",
       "815              8 2016-12-31 23:59:59            8              8         8   \n",
       "816             10 2017-12-31 23:59:59           10             10        10   \n",
       "\n",
       "     test_date                    type  \n",
       "0            1     Patient Tests - MQT  \n",
       "1            1     Patient Tests - MQT  \n",
       "2            2  Patient Tests - Sticks  \n",
       "3            4  Patient Tests - Sticks  \n",
       "4            4  Patient Tests - Sticks  \n",
       "5            4  Patient Tests - Sticks  \n",
       "6            2  Patient Tests - Sticks  \n",
       "7            7  Patient Tests - Sticks  \n",
       "8            5  Patient Tests - Sticks  \n",
       "9            2  Patient Tests - Sticks  \n",
       "10           6  Patient Tests - Sticks  \n",
       "11           8  Patient Tests - Sticks  \n",
       "12           8  Patient Tests - Sticks  \n",
       "13           3  Patient Tests - Sticks  \n",
       "14          11  Patient Tests - Sticks  \n",
       "15           7  Patient Tests - Sticks  \n",
       "16           4  Patient Tests - Sticks  \n",
       "17          18  Patient Tests - Sticks  \n",
       "18           7  Patient Tests - Sticks  \n",
       "19           1  Patient Tests - Sticks  \n",
       "20          13  Patient Tests - Sticks  \n",
       "21           7  Patient Tests - Sticks  \n",
       "22           1  Patient Tests - Sticks  \n",
       "23           5  Patient Tests - Sticks  \n",
       "24           4  Patient Tests - Sticks  \n",
       "25           2  Patient Tests - Sticks  \n",
       "26           7  Patient Tests - Sticks  \n",
       "27           8  Patient Tests - Sticks  \n",
       "28           4  Patient Tests - Sticks  \n",
       "29           6  Patient Tests - Sticks  \n",
       "..         ...                     ...  \n",
       "787          3   # of Mixing Locations  \n",
       "788          3   # of Mixing Locations  \n",
       "789          8   # of Mixing Locations  \n",
       "790          3   # of Mixing Locations  \n",
       "791          4   # of Mixing Locations  \n",
       "792          8   # of Mixing Locations  \n",
       "793          3   # of Mixing Locations  \n",
       "794          4   # of Mixing Locations  \n",
       "795          8   # of Mixing Locations  \n",
       "796          3   # of Mixing Locations  \n",
       "797          5   # of Mixing Locations  \n",
       "798          8   # of Mixing Locations  \n",
       "799          3   # of Mixing Locations  \n",
       "800          5   # of Mixing Locations  \n",
       "801          8   # of Mixing Locations  \n",
       "802          3   # of Mixing Locations  \n",
       "803          5   # of Mixing Locations  \n",
       "804          8   # of Mixing Locations  \n",
       "805          3   # of Mixing Locations  \n",
       "806          5   # of Mixing Locations  \n",
       "807          8   # of Mixing Locations  \n",
       "808          3   # of Mixing Locations  \n",
       "809          7   # of Mixing Locations  \n",
       "810          8   # of Mixing Locations  \n",
       "811          3   # of Mixing Locations  \n",
       "812          8   # of Mixing Locations  \n",
       "813         10   # of Mixing Locations  \n",
       "814          3   # of Mixing Locations  \n",
       "815          8   # of Mixing Locations  \n",
       "816         10   # of Mixing Locations  \n",
       "\n",
       "[2227 rows x 12 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "KPI_detail_output_medium = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Medium)]\n",
    "patient_sum_m = KPI_detail_output_medium[['Patients_Tested', 'benchmark_date', 'grouping', 'location_id', 'location_name', 'practice_name', 'provider', 'test_date', 'type', 'category']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).count()\n",
    "patient_sum_m\n",
    "date_patient_sum_m = KPI_detail_output_medium[['grouping', 'type', 'benchmark_date', 'month_year']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).max()\n",
    "date_patient_sum_m\n",
    "practice_patient_sum_m = KPI_detail_output_medium[['grouping', 'type', 'benchmark_date', 'practice_id']].groupby(['grouping', 'type', 'benchmark_date'], as_index=False).nunique()\n",
    "practice_patient_sum_m\n",
    "benchmark_all_m = pd.merge(patient_sum_m, date_patient_sum_m, on=['grouping', 'type', 'benchmark_date'])\n",
    "benchmark_all_m['category'] = 'Benchmark Medium'\n",
    "benchmark_all_m = pd.concat([benchmark_all_m, practice_patient_sum_m['practice_id']], axis=1)\n",
    "benchmark_all_m['Patients_Tested'] = benchmark_all_m['Patients_Tested'] / benchmark_all_m['practice_id']\n",
    "benchmark_all_m\n",
    "all_comp = pd.concat([benchmark_all_p, benchmark_all, benchmark_all_m])\n",
    "all_comp.to_excel('Dynaimc KPI Benchmark Data Medium.xlsx')\n",
    "all_comp"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "# SCIT Vials Mixed for New Patients              89\n",
       "# SLIT Vials Mixed for New Patients              30\n",
       "# Unknown Vials Mixed for New Patients            0\n",
       "# of Errors                                     366\n",
       "# of Injections                                6831\n",
       "# of Intradermal Tests not related to Food     5532\n",
       "# of Intradermal Tests related to Food          270\n",
       "# of Mixing Locations                             6\n",
       "# of New Patients on SCIT                        67\n",
       "# of New Patients on SLIT                        13\n",
       "# of New Patients on Unknown                      0\n",
       "# of Physicians and Midlevel                     31\n",
       "# of Pricks not related to Food                6501\n",
       "# of Pricks related to Food                     431\n",
       "# of Techs                                       19\n",
       "# of Total SCIT Vials Mixed                    1200\n",
       "# of Total SLIT Vials Mixed                     186\n",
       "# of Total Unknown Vials Mixed                    7\n",
       "Allergy Tests - IGE                              43\n",
       "Allergy Tests - MQT                             181\n",
       "Allergy Tests - Pricks                           37\n",
       "Allergy Tests - Sticks                           33\n",
       "Patient Tests - IGE                              23\n",
       "Patient Tests - MQT                             179\n",
       "Patient Tests - Pricks                           32\n",
       "Patient Tests - Sticks                           33\n",
       "Total Active Patients on SCIT                  3082\n",
       "Total Active Patients on SLIT                   583\n",
       "Total Active Patients on Unknown               1047\n",
       "Subtotal Allergy Activity                     26866\n",
       "Group1                                          268\n",
       "Group10                                         366\n",
       "Group11                                           6\n",
       "Group12                                          19\n",
       "Group13                                          31\n",
       "Group2                                          295\n",
       "Group3                                         6932\n",
       "Group4                                         5802\n",
       "Group5                                          120\n",
       "Group6                                         1394\n",
       "Group7                                         6831\n",
       "Group8                                           82\n",
       "Group9                                         4713\n",
       "Subtotal Allergy Activity                     26866\n",
       "Name: (Patients_Tested, Benchmark All Allergy Activity, ), dtype: int32"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "KPI_detail_output_large = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Large)]\n",
    "KPI_detail_output_large\n",
    "#KPI_detail_output_medium = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Medium)]\n",
    "#KPI_detail_output_medium\n",
    "#KPI_detail_output_small = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Small)]\n",
    "#KPI_detail_output_small\n",
    "benchmark_large = pd.pivot_table(KPI_detail_output_large, index=['type'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_large['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_large['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(benchmark_groups_Large)).astype(int)\n",
    "benchmark_large\n",
    "benchmark_large_AE = benchmark_large['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "#benchmark_large_AE.to_excel('AllergyEDGE Tests Examples Large Benchmark.xlsx')\n",
    "benchmark_large_AE\n",
    "benchmark_large_totals = pd.pivot_table(KPI_detail_output_large, index=['grouping'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_large_totals['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_large_totals['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(benchmark_groups_Large)).astype(int)\n",
    "benchmark_large_totals_AE = benchmark_large_totals['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "benchmark_large_totals_AE\n",
    "complete_benchmarks_large = pd.concat([benchmark_large_AE, benchmark_large_totals_AE], axis=0)\n",
    "complete_benchmarks_large.to_excel('AllergyEDGE Tests Examples Large Benchmark.xlsx')\n",
    "complete_benchmarks_large"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "# SCIT Vials Mixed for New Patients              5\n",
       "# SLIT Vials Mixed for New Patients              1\n",
       "# Unknown Vials Mixed for New Patients           0\n",
       "# of Errors                                     39\n",
       "# of Injections                                404\n",
       "# of Intradermal Tests not related to Food     331\n",
       "# of Intradermal Tests related to Food           7\n",
       "# of Mixing Locations                            1\n",
       "# of New Patients on SCIT                        4\n",
       "# of New Patients on SLIT                        0\n",
       "# of New Patients on Unknown                     0\n",
       "# of Physicians and Midlevel                     2\n",
       "# of Pricks not related to Food                318\n",
       "# of Pricks related to Food                     12\n",
       "# of Techs                                       1\n",
       "# of Total SCIT Vials Mixed                     73\n",
       "# of Total SLIT Vials Mixed                      9\n",
       "# of Total Unknown Vials Mixed                   0\n",
       "Allergy Tests - IGE                              0\n",
       "Allergy Tests - MQT                              8\n",
       "Allergy Tests - Pricks                           1\n",
       "Allergy Tests - Sticks                           2\n",
       "Patient Tests - IGE                              0\n",
       "Patient Tests - MQT                              8\n",
       "Patient Tests - Pricks                           1\n",
       "Patient Tests - Sticks                           1\n",
       "Total Active Patients on SCIT                  143\n",
       "Total Active Patients on SLIT                   30\n",
       "Total Active Patients on Unknown                63\n",
       "Subtotal Allergy Activity                     1477\n",
       "Group1                                          11\n",
       "Group10                                         39\n",
       "Group11                                          1\n",
       "Group12                                          1\n",
       "Group13                                          2\n",
       "Group2                                          13\n",
       "Group3                                         330\n",
       "Group4                                         338\n",
       "Group5                                           6\n",
       "Group6                                          83\n",
       "Group7                                         404\n",
       "Group8                                           5\n",
       "Group9                                         237\n",
       "Subtotal Allergy Activity                     1477\n",
       "Name: (Patients_Tested, Benchmark All Allergy Activity, ), dtype: int32"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "KPI_detail_output_small = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Small)]\n",
    "KPI_detail_output_small\n",
    "#KPI_detail_output_medium = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Medium)]\n",
    "#KPI_detail_output_medium\n",
    "#KPI_detail_output_small = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Small)]\n",
    "#KPI_detail_output_small\n",
    "benchmark_small = pd.pivot_table(KPI_detail_output_small, index=['type'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_small['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_small['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(benchmark_groups_Small)).astype(int)\n",
    "benchmark_small\n",
    "benchmark_small_AE = benchmark_small['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "#benchmark_large_AE.to_excel('AllergyEDGE Tests Examples Large Benchmark.xlsx')\n",
    "benchmark_small_AE\n",
    "benchmark_small_totals = pd.pivot_table(KPI_detail_output_small, index=['grouping'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_small_totals['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_small_totals['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(benchmark_groups_Small)).astype(int)\n",
    "benchmark_small_totals_AE = benchmark_small_totals['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "benchmark_small_totals_AE\n",
    "complete_benchmarks_small = pd.concat([benchmark_small_AE, benchmark_small_totals_AE], axis=0)\n",
    "complete_benchmarks_small.to_excel('AllergyEDGE Tests Examples Small Benchmark.xlsx')\n",
    "complete_benchmarks_small"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "# SCIT Vials Mixed for New Patients          5\n",
       "# SLIT Vials Mixed for New Patients          1\n",
       "# Unknown Vials Mixed for New Patients       0\n",
       "# of Errors                                 25\n",
       "# of Injections                            480\n",
       "# of Mixing Locations                        0\n",
       "# of New Patients on SCIT                    6\n",
       "# of New Patients on SLIT                    0\n",
       "# of New Patients on Unknown                 0\n",
       "# of Physicians and Midlevel                 5\n",
       "# of Techs                                   2\n",
       "# of Total SCIT Vials Mixed                 85\n",
       "# of Total SLIT Vials Mixed                 10\n",
       "# of Total Unknown Vials Mixed               1\n",
       "Allergy Tests - IGE                          0\n",
       "Allergy Tests - MQT                          7\n",
       "Allergy Tests - Pricks                       2\n",
       "Allergy Tests - Sticks                       3\n",
       "Patient Tests - IGE                          0\n",
       "Patient Tests - MQT                          7\n",
       "Patient Tests - Pricks                       1\n",
       "Patient Tests - Sticks                       3\n",
       "Total Active Patients on SCIT              272\n",
       "Total Active Patients on SLIT               61\n",
       "Total Active Patients on Unknown           165\n",
       "Subtotal Allergy Activity                 1152\n",
       "Group1                                      12\n",
       "Group10                                      2\n",
       "Group11                                      5\n",
       "Group2                                      14\n",
       "Group3                                       6\n",
       "Group4                                      97\n",
       "Group5                                     480\n",
       "Group6                                       7\n",
       "Group7                                     499\n",
       "Group8                                      25\n",
       "Group9                                       0\n",
       "Subtotal Allergy Activity                 1152\n",
       "Name: (Patients_Tested, Benchmark All Allergy Activity, ), dtype: int32"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "KPI_detail_output_medium = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Medium)]\n",
    "KPI_detail_output_medium\n",
    "#KPI_detail_output_medium = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Medium)]\n",
    "#KPI_detail_output_medium\n",
    "#KPI_detail_output_small = KPI_detail_output[KPI_detail_output['practice_id'].isin(benchmark_groups_Small)]\n",
    "#KPI_detail_output_small\n",
    "benchmark_medium = pd.pivot_table(KPI_detail_output_medium, index=['type'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_medium['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_medium['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(benchmark_groups_Medium)).astype(int)\n",
    "benchmark_medium\n",
    "benchmark_medium_AE = benchmark_medium['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "#benchmark_large_AE.to_excel('AllergyEDGE Tests Examples Large Benchmark.xlsx')\n",
    "benchmark_medium_AE\n",
    "benchmark_medium_totals = pd.pivot_table(KPI_detail_output_medium, index=['grouping'], values=['Patients_Tested'], columns=['month_year', 'test_date'], aggfunc='count', fill_value= 0, margins=True, margins_name='Subtotal Allergy Activity')\n",
    "benchmark_medium_totals['Patients_Tested', 'Benchmark All Allergy Activity', ''] = (benchmark_medium_totals['Patients_Tested', 'Subtotal Allergy Activity', ''] / diff_month(PED_computation, PSD_computation) / len(benchmark_groups_Medium)).astype(int)\n",
    "benchmark_medium_totals_AE = benchmark_medium_totals['Patients_Tested', 'Benchmark All Allergy Activity', '']\n",
    "benchmark_medium_totals_AE\n",
    "complete_benchmarks_medium = pd.concat([benchmark_medium_AE, benchmark_medium_totals_AE], axis=0)\n",
    "complete_benchmarks_medium.to_excel('AllergyEDGE Tests Examples Medium Benchmark.xlsx')\n",
    "complete_benchmarks_medium"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
