{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '145178.25'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '134320.77'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '145255.38'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '156189.99'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '167124.60'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '182007.57'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '177565.67'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '163746.91'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '113941.79'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '128892.85'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '139551.75'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '150210.66'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '160869.57'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '175653.05'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '171012.91'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '193529.44'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '156634.65'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '144920.92'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '156725.18'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '168529.44'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '180333.70'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '192137.96'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '196397.70'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '203409.76'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '188501.22'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '344077.51'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '399757.21'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '410288.22'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '420819.23'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '431350.24'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '443805.48'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '429793.34'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '476131.60'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '249880.52'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '240588.93'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '251507.42'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '262425.91'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '273344.40'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '280693.85'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '283344.21'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '268540.53'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '210999.69'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '194812.18'\")\n",
      "  result = self._query(query)\n",
      "C:\\Users\\eallan\\AppData\\Local\\Continuum\\Anaconda3\\lib\\site-packages\\pymysql\\cursors.py:166: Warning: (1292, \"Truncated incorrect INTEGER value: '205667.05'\")\n",
      "  result = self._query(query)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>time_period</th>\n",
       "      <th>categories</th>\n",
       "      <th>Budgets</th>\n",
       "      <th>RM</th>\n",
       "      <th>RD</th>\n",
       "      <th>rm_id</th>\n",
       "      <th>rm_name</th>\n",
       "      <th>level_0</th>\n",
       "      <th>month</th>\n",
       "      <th>Actuals</th>\n",
       "      <th>Actuals vs Budgets</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>547</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-01-01</td>\n",
       "      <td>units</td>\n",
       "      <td>199</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-01-01</td>\n",
       "      <td>138.00</td>\n",
       "      <td>0.693467</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>548</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-01-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>145178</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-01-01</td>\n",
       "      <td>89763.30</td>\n",
       "      <td>0.618298</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>549</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-01-01</td>\n",
       "      <td>members</td>\n",
       "      <td>13</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-01-01</td>\n",
       "      <td>10.00</td>\n",
       "      <td>0.769231</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>550</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-02-01</td>\n",
       "      <td>units</td>\n",
       "      <td>184</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-02-01</td>\n",
       "      <td>141.00</td>\n",
       "      <td>0.766304</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>551</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-02-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>134320</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-02-01</td>\n",
       "      <td>103279.20</td>\n",
       "      <td>0.768904</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>552</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-02-01</td>\n",
       "      <td>members</td>\n",
       "      <td>13</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-02-01</td>\n",
       "      <td>9.00</td>\n",
       "      <td>0.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>553</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-03-01</td>\n",
       "      <td>units</td>\n",
       "      <td>184</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-03-01</td>\n",
       "      <td>175.00</td>\n",
       "      <td>0.951087</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>554</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-03-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>134320</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-03-01</td>\n",
       "      <td>132459.54</td>\n",
       "      <td>0.986149</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>555</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-03-01</td>\n",
       "      <td>members</td>\n",
       "      <td>13</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-03-01</td>\n",
       "      <td>9.00</td>\n",
       "      <td>0.692308</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>556</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-04-01</td>\n",
       "      <td>units</td>\n",
       "      <td>199</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-04-01</td>\n",
       "      <td>189.00</td>\n",
       "      <td>0.949749</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>557</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-04-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>145255</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-04-01</td>\n",
       "      <td>126873.32</td>\n",
       "      <td>0.873452</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>558</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-04-01</td>\n",
       "      <td>members</td>\n",
       "      <td>14</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-04-01</td>\n",
       "      <td>10.00</td>\n",
       "      <td>0.714286</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>559</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-05-01</td>\n",
       "      <td>units</td>\n",
       "      <td>199</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-05-01</td>\n",
       "      <td>192.00</td>\n",
       "      <td>0.964824</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>560</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-05-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>145255</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-05-01</td>\n",
       "      <td>160435.52</td>\n",
       "      <td>1.104509</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>561</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-05-01</td>\n",
       "      <td>members</td>\n",
       "      <td>14</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-05-01</td>\n",
       "      <td>11.00</td>\n",
       "      <td>0.785714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>562</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-06-01</td>\n",
       "      <td>units</td>\n",
       "      <td>214</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-06-01</td>\n",
       "      <td>174.00</td>\n",
       "      <td>0.813084</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>563</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-06-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>156189</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-06-01</td>\n",
       "      <td>135372.30</td>\n",
       "      <td>0.866721</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>564</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-06-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-06-01</td>\n",
       "      <td>9.00</td>\n",
       "      <td>0.600000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>565</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-07-01</td>\n",
       "      <td>units</td>\n",
       "      <td>229</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-07-01</td>\n",
       "      <td>138.00</td>\n",
       "      <td>0.602620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>566</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-07-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>167124</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-07-01</td>\n",
       "      <td>103900.91</td>\n",
       "      <td>0.621700</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>567</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-07-01</td>\n",
       "      <td>members</td>\n",
       "      <td>16</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-07-01</td>\n",
       "      <td>11.00</td>\n",
       "      <td>0.687500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>568</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-08-01</td>\n",
       "      <td>units</td>\n",
       "      <td>229</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-08-01</td>\n",
       "      <td>166.00</td>\n",
       "      <td>0.724891</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>569</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-08-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>167124</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-08-01</td>\n",
       "      <td>128707.51</td>\n",
       "      <td>0.770132</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>570</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-08-01</td>\n",
       "      <td>members</td>\n",
       "      <td>16</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-08-01</td>\n",
       "      <td>9.00</td>\n",
       "      <td>0.562500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>571</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-09-01</td>\n",
       "      <td>units</td>\n",
       "      <td>229</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-09-01</td>\n",
       "      <td>133.00</td>\n",
       "      <td>0.580786</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>572</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-09-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>167124</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-09-01</td>\n",
       "      <td>109794.74</td>\n",
       "      <td>0.656966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>573</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-09-01</td>\n",
       "      <td>members</td>\n",
       "      <td>16</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-09-01</td>\n",
       "      <td>11.00</td>\n",
       "      <td>0.687500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>574</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>units</td>\n",
       "      <td>250</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>units</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>201.00</td>\n",
       "      <td>0.804000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>575</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>182007</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>sales</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>157646.27</td>\n",
       "      <td>0.866155</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>576</td>\n",
       "      <td>10</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>members</td>\n",
       "      <td>17</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>Jesse Boyer</td>\n",
       "      <td>10</td>\n",
       "      <td>Jessy Culp</td>\n",
       "      <td>members</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>13.00</td>\n",
       "      <td>0.764706</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1446</th>\n",
       "      <td>2551</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-03-01</td>\n",
       "      <td>units</td>\n",
       "      <td>449</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1447</th>\n",
       "      <td>2552</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-03-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>307206</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1448</th>\n",
       "      <td>2553</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-03-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1449</th>\n",
       "      <td>2554</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-04-01</td>\n",
       "      <td>units</td>\n",
       "      <td>449</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1450</th>\n",
       "      <td>2555</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-04-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>307206</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1451</th>\n",
       "      <td>2556</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-04-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1452</th>\n",
       "      <td>2557</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-05-01</td>\n",
       "      <td>units</td>\n",
       "      <td>449</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1453</th>\n",
       "      <td>2558</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-05-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>307206</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1454</th>\n",
       "      <td>2559</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-05-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1455</th>\n",
       "      <td>2560</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-06-01</td>\n",
       "      <td>units</td>\n",
       "      <td>449</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1456</th>\n",
       "      <td>2561</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-06-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>307206</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1457</th>\n",
       "      <td>2562</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-06-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1458</th>\n",
       "      <td>2563</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-07-01</td>\n",
       "      <td>units</td>\n",
       "      <td>449</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1459</th>\n",
       "      <td>2564</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-07-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>307206</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1460</th>\n",
       "      <td>2565</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-07-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1461</th>\n",
       "      <td>2566</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-08-01</td>\n",
       "      <td>units</td>\n",
       "      <td>449</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1462</th>\n",
       "      <td>2567</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-08-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>307206</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1463</th>\n",
       "      <td>2568</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-08-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1464</th>\n",
       "      <td>2569</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-09-01</td>\n",
       "      <td>units</td>\n",
       "      <td>449</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1465</th>\n",
       "      <td>2570</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-09-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>307206</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1466</th>\n",
       "      <td>2571</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-09-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1467</th>\n",
       "      <td>2572</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-10-01</td>\n",
       "      <td>units</td>\n",
       "      <td>464</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1468</th>\n",
       "      <td>2573</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-10-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>317037</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1469</th>\n",
       "      <td>2574</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-10-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1470</th>\n",
       "      <td>2575</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>units</td>\n",
       "      <td>447</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1471</th>\n",
       "      <td>2576</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>305978</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1472</th>\n",
       "      <td>2577</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-11-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1473</th>\n",
       "      <td>2578</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-12-01</td>\n",
       "      <td>units</td>\n",
       "      <td>489</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1474</th>\n",
       "      <td>2579</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-12-01</td>\n",
       "      <td>sales</td>\n",
       "      <td>334239</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1475</th>\n",
       "      <td>2580</td>\n",
       "      <td>corp</td>\n",
       "      <td>2018-12-01</td>\n",
       "      <td>members</td>\n",
       "      <td>15</td>\n",
       "      <td>corp</td>\n",
       "      <td></td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaT</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1476 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        id user_id time_period categories  Budgets          RM           RD  \\\n",
       "0      547      10  2017-01-01      units      199  Jessy Culp  Jesse Boyer   \n",
       "1      548      10  2017-01-01      sales   145178  Jessy Culp  Jesse Boyer   \n",
       "2      549      10  2017-01-01    members       13  Jessy Culp  Jesse Boyer   \n",
       "3      550      10  2017-02-01      units      184  Jessy Culp  Jesse Boyer   \n",
       "4      551      10  2017-02-01      sales   134320  Jessy Culp  Jesse Boyer   \n",
       "5      552      10  2017-02-01    members       13  Jessy Culp  Jesse Boyer   \n",
       "6      553      10  2017-03-01      units      184  Jessy Culp  Jesse Boyer   \n",
       "7      554      10  2017-03-01      sales   134320  Jessy Culp  Jesse Boyer   \n",
       "8      555      10  2017-03-01    members       13  Jessy Culp  Jesse Boyer   \n",
       "9      556      10  2017-04-01      units      199  Jessy Culp  Jesse Boyer   \n",
       "10     557      10  2017-04-01      sales   145255  Jessy Culp  Jesse Boyer   \n",
       "11     558      10  2017-04-01    members       14  Jessy Culp  Jesse Boyer   \n",
       "12     559      10  2017-05-01      units      199  Jessy Culp  Jesse Boyer   \n",
       "13     560      10  2017-05-01      sales   145255  Jessy Culp  Jesse Boyer   \n",
       "14     561      10  2017-05-01    members       14  Jessy Culp  Jesse Boyer   \n",
       "15     562      10  2017-06-01      units      214  Jessy Culp  Jesse Boyer   \n",
       "16     563      10  2017-06-01      sales   156189  Jessy Culp  Jesse Boyer   \n",
       "17     564      10  2017-06-01    members       15  Jessy Culp  Jesse Boyer   \n",
       "18     565      10  2017-07-01      units      229  Jessy Culp  Jesse Boyer   \n",
       "19     566      10  2017-07-01      sales   167124  Jessy Culp  Jesse Boyer   \n",
       "20     567      10  2017-07-01    members       16  Jessy Culp  Jesse Boyer   \n",
       "21     568      10  2017-08-01      units      229  Jessy Culp  Jesse Boyer   \n",
       "22     569      10  2017-08-01      sales   167124  Jessy Culp  Jesse Boyer   \n",
       "23     570      10  2017-08-01    members       16  Jessy Culp  Jesse Boyer   \n",
       "24     571      10  2017-09-01      units      229  Jessy Culp  Jesse Boyer   \n",
       "25     572      10  2017-09-01      sales   167124  Jessy Culp  Jesse Boyer   \n",
       "26     573      10  2017-09-01    members       16  Jessy Culp  Jesse Boyer   \n",
       "27     574      10  2017-10-01      units      250  Jessy Culp  Jesse Boyer   \n",
       "28     575      10  2017-10-01      sales   182007  Jessy Culp  Jesse Boyer   \n",
       "29     576      10  2017-10-01    members       17  Jessy Culp  Jesse Boyer   \n",
       "...    ...     ...         ...        ...      ...         ...          ...   \n",
       "1446  2551    corp  2018-03-01      units      449        corp                \n",
       "1447  2552    corp  2018-03-01      sales   307206        corp                \n",
       "1448  2553    corp  2018-03-01    members       15        corp                \n",
       "1449  2554    corp  2018-04-01      units      449        corp                \n",
       "1450  2555    corp  2018-04-01      sales   307206        corp                \n",
       "1451  2556    corp  2018-04-01    members       15        corp                \n",
       "1452  2557    corp  2018-05-01      units      449        corp                \n",
       "1453  2558    corp  2018-05-01      sales   307206        corp                \n",
       "1454  2559    corp  2018-05-01    members       15        corp                \n",
       "1455  2560    corp  2018-06-01      units      449        corp                \n",
       "1456  2561    corp  2018-06-01      sales   307206        corp                \n",
       "1457  2562    corp  2018-06-01    members       15        corp                \n",
       "1458  2563    corp  2018-07-01      units      449        corp                \n",
       "1459  2564    corp  2018-07-01      sales   307206        corp                \n",
       "1460  2565    corp  2018-07-01    members       15        corp                \n",
       "1461  2566    corp  2018-08-01      units      449        corp                \n",
       "1462  2567    corp  2018-08-01      sales   307206        corp                \n",
       "1463  2568    corp  2018-08-01    members       15        corp                \n",
       "1464  2569    corp  2018-09-01      units      449        corp                \n",
       "1465  2570    corp  2018-09-01      sales   307206        corp                \n",
       "1466  2571    corp  2018-09-01    members       15        corp                \n",
       "1467  2572    corp  2018-10-01      units      464        corp                \n",
       "1468  2573    corp  2018-10-01      sales   317037        corp                \n",
       "1469  2574    corp  2018-10-01    members       15        corp                \n",
       "1470  2575    corp  2018-11-01      units      447        corp                \n",
       "1471  2576    corp  2018-11-01      sales   305978        corp                \n",
       "1472  2577    corp  2018-11-01    members       15        corp                \n",
       "1473  2578    corp  2018-12-01      units      489        corp                \n",
       "1474  2579    corp  2018-12-01      sales   334239        corp                \n",
       "1475  2580    corp  2018-12-01    members       15        corp                \n",
       "\n",
       "     rm_id     rm_name  level_0      month    Actuals  Actuals vs Budgets  \n",
       "0       10  Jessy Culp    units 2017-01-01     138.00            0.693467  \n",
       "1       10  Jessy Culp    sales 2017-01-01   89763.30            0.618298  \n",
       "2       10  Jessy Culp  members 2017-01-01      10.00            0.769231  \n",
       "3       10  Jessy Culp    units 2017-02-01     141.00            0.766304  \n",
       "4       10  Jessy Culp    sales 2017-02-01  103279.20            0.768904  \n",
       "5       10  Jessy Culp  members 2017-02-01       9.00            0.692308  \n",
       "6       10  Jessy Culp    units 2017-03-01     175.00            0.951087  \n",
       "7       10  Jessy Culp    sales 2017-03-01  132459.54            0.986149  \n",
       "8       10  Jessy Culp  members 2017-03-01       9.00            0.692308  \n",
       "9       10  Jessy Culp    units 2017-04-01     189.00            0.949749  \n",
       "10      10  Jessy Culp    sales 2017-04-01  126873.32            0.873452  \n",
       "11      10  Jessy Culp  members 2017-04-01      10.00            0.714286  \n",
       "12      10  Jessy Culp    units 2017-05-01     192.00            0.964824  \n",
       "13      10  Jessy Culp    sales 2017-05-01  160435.52            1.104509  \n",
       "14      10  Jessy Culp  members 2017-05-01      11.00            0.785714  \n",
       "15      10  Jessy Culp    units 2017-06-01     174.00            0.813084  \n",
       "16      10  Jessy Culp    sales 2017-06-01  135372.30            0.866721  \n",
       "17      10  Jessy Culp  members 2017-06-01       9.00            0.600000  \n",
       "18      10  Jessy Culp    units 2017-07-01     138.00            0.602620  \n",
       "19      10  Jessy Culp    sales 2017-07-01  103900.91            0.621700  \n",
       "20      10  Jessy Culp  members 2017-07-01      11.00            0.687500  \n",
       "21      10  Jessy Culp    units 2017-08-01     166.00            0.724891  \n",
       "22      10  Jessy Culp    sales 2017-08-01  128707.51            0.770132  \n",
       "23      10  Jessy Culp  members 2017-08-01       9.00            0.562500  \n",
       "24      10  Jessy Culp    units 2017-09-01     133.00            0.580786  \n",
       "25      10  Jessy Culp    sales 2017-09-01  109794.74            0.656966  \n",
       "26      10  Jessy Culp  members 2017-09-01      11.00            0.687500  \n",
       "27      10  Jessy Culp    units 2017-10-01     201.00            0.804000  \n",
       "28      10  Jessy Culp    sales 2017-10-01  157646.27            0.866155  \n",
       "29      10  Jessy Culp  members 2017-10-01      13.00            0.764706  \n",
       "...    ...         ...      ...        ...        ...                 ...  \n",
       "1446   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1447   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1448   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1449   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1450   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1451   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1452   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1453   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1454   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1455   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1456   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1457   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1458   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1459   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1460   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1461   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1462   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1463   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1464   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1465   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1466   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1467   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1468   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1469   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1470   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1471   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1472   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1473   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1474   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "1475   NaN         NaN      NaN        NaT        NaN            0.000000  \n",
       "\n",
       "[1476 rows x 13 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import calendar\n",
    "import datetime\n",
    "import numpy as np\n",
    "import string\n",
    "import matplotlib as mt\n",
    "import matplotlib.pyplot as plt\n",
    "import pymysql\n",
    "from xlsxwriter.utility import xl_rowcol_to_cell\n",
    "myconnection = pymysql.connect( host='104.154.243.188', user='ifuelmed_data', passwd='', db='ifuelmed_project' )\n",
    "actuals = pd.read_sql_query(\"SELECT if(a.rm_id in (55,7,26,0), 'corp', a.rm_id) as rm_id, a.rm_name, a.month, sum(a.quantity) AS units, sum(a.price) AS sales, count(DISTINCT business_id) AS members FROM ha_sales_joined a WHERE year(month) >= 2017 and technology_tier not in ('Non-HA') and business_id <> 100319 GROUP BY if(a.rm_id in (55,7,26,0), 'corp', a.rm_id), a.month\", myconnection)\n",
    "actuals\n",
    "rms = actuals[['rm_id', 'rm_name']]\n",
    "all_rms = pd.concat([rms, rms, rms], axis=0)\n",
    "all_rms.reset_index(drop=True, inplace=True)\n",
    "all_rms\n",
    "actuals_T = actuals[['month', 'units', 'sales', 'members']].set_index(['month']).T\n",
    "actuals_T\n",
    "test_actuals = actuals_T.stack().reset_index()\n",
    "test_actuals\n",
    "actuals_w_rms = pd.concat([all_rms, test_actuals], axis=1)\n",
    "actuals_w_rms.sort_values(['rm_id', 'month'])\n",
    "actuals_w_rms['month'] = pd.to_datetime(actuals_w_rms['month'], format='%Y-%m-%d')\n",
    "actuals_w_rms['rm_id'] = actuals_w_rms['rm_id'].astype(str)\n",
    "#actuals_w_rms.dtypes\n",
    "##list(actuals_w_rms)\n",
    "actuals_w_rms = actuals_w_rms.rename(columns={0: 'Actuals'})\n",
    "actuals_w_rms\n",
    "budget = pd.read_sql_query(\"SELECT a.id, a.user_id, a.time_period, a.meta_key as categories, convert(a.meta_value, UNSIGNED INTEGER) as Budgets, if(a.user_id = 'corp', 'corp', concat_ws(' ', c.first_name, c.last_name)) AS RM, concat_ws(' ', d.first_name, d.last_name) AS RD FROM rm_budgets a LEFT JOIN (SELECT rm_id, max(rd_id) AS rd_id FROM rm_rd GROUP BY rm_id) b ON a.user_id = b.rm_id LEFT JOIN users c ON a.user_id = c.user_id LEFT JOIN users d ON b.rd_id = d.user_id WHERE time_period not in ('2017-12-31', '2018-12-31') and a.user_id not in ('fuel') ORDER BY a.user_id, a.time_period\", myconnection)\n",
    "budget\n",
    "##budget['user_id'] = budget['user_id'].astype(str).astype(int)\n",
    "budget['user_id'] = budget['user_id'].astype(str)\n",
    "budget['time_period'] = pd.to_datetime(budget['time_period'], format='%Y-%m-%d')\n",
    "budget.dtypes\n",
    "budget.sort_values(['user_id', 'time_period'])\n",
    "budget_vs_actual = pd.merge(budget, actuals_w_rms, how='left', left_on=['user_id', 'time_period', 'categories'], right_on=['rm_id', 'month', 'level_0'])\n",
    "#budget_vs_actual['Actuals vs Budgets'] = np.where(budget_vs_actual['Actuals'].notnull(), budget_vs_actual['Actuals'] / budget_vs_actual['Budgets'],'')\n",
    "budget_vs_actual['Actuals vs Budgets'] = (budget_vs_actual['Actuals'] / budget_vs_actual['Budgets']).fillna(0)\n",
    "budget_vs_actual['Actuals vs Budgets'] = budget_vs_actual['Actuals vs Budgets'].astype(float)\n",
    "#budget_vs_actual['Actuals vs Budgets'] = budget_vs_actual['Actuals vs Budgets'].map(lambda n: '{:,.2%}'.format(n))\n",
    "budget_vs_actual.to_excel('Actual vs Budget 3.14.18.xlsx', index=False)\n",
    "budget_vs_actual"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "Excel.Application.Quit()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "import win32com.client\n",
    "Excel   = win32com.client.gencache.EnsureDispatch('Excel.Application') # Excel = win32com.client.Dispatch('Excel.Application')\n",
    "\n",
    "win32c = win32com.client.constants\n",
    "\n",
    "wb = Excel.Workbooks.Open(\"C:\\\\Users\\\\eallan\\\\OneDrive - Fuel Medical Group, LLC\\\\Actual vs Budget 3.14.18.xlsx\")\n",
    "Sheet1 = wb.Worksheets(\"Sheet1\")\n",
    "\n",
    "cl1 = Sheet1.Cells(1,1)\n",
    "cl2 = Sheet1.Cells(len(budget_vs_actual.index),len(budget_vs_actual.columns))\n",
    "PivotSourceRange = Sheet1.Range(cl1,cl2)\n",
    "\n",
    "#PivotSourceRange.Select()\n",
    "\n",
    "wb.Sheets.Add (After=wb.Sheets(1))\n",
    "Sheet2 = wb.Worksheets(2)\n",
    "#wb.Sheets.Add (After=wb.Sheets(2))\n",
    "#Sheet3 = wb.Worksheets(3)\n",
    "cl3=Sheet2.Cells(4,1)   \n",
    "PivotTargetRange=  Sheet2.Range(cl3,cl3)\n",
    "PivotTableName = 'ReportPivotTable'\n",
    "cl4=Sheet2.Cells(4,11)\n",
    "PivotChartRange = Sheet2.Range(cl4,cl4)\n",
    "\n",
    "PivotCache = wb.PivotCaches().Create(SourceType=win32c.xlDatabase, SourceData=PivotSourceRange, Version=win32c.xlPivotTableVersion14)\n",
    "\n",
    "PivotTable = PivotCache.CreatePivotTable(TableDestination=PivotTargetRange, TableName=PivotTableName, DefaultVersion=win32c.xlPivotTableVersion14)\n",
    "\n",
    "PivotTable.PivotFields('RM').Orientation = win32c.xlRowField\n",
    "PivotTable.PivotFields('RM').Position = 1\n",
    "PivotTable.PivotFields('RM').Subtotals = [False, False, False, False, False, False, False, False, False, False, False, False]\n",
    "#PivotTable.PivotFields('doctor_name').Orientation = win32c.xlPageField\n",
    "#PivotTable.PivotFields('doctor_name').Position = 1\n",
    "#PivotTable.PivotFields('Date of Next Needed Visit').Orientation = win32c.xlPageField\n",
    "#PivotTable.PivotFields('Date of Next Needed Visit').Position = 2\n",
    "#PivotTable.PivotFields('location_name').Orientation = win32c.xlPageField\n",
    "#PivotTable.PivotFields('location_name').Position = 3\n",
    "#PivotTable.PivotFields('Gender').CurrentPage = 'M'\n",
    "PivotTable.PivotFields('categories').Orientation = win32c.xlColumnField\n",
    "PivotTable.PivotFields('categories').Position = 1\n",
    "PivotTable.PivotFields('categories').Subtotals = [False, False, False, False, False, False, False, False, False, False, False, False]\n",
    "#PivotTable.ColumnGrand = False\n",
    "PivotTable.RowGrand = False\n",
    "#PivotTable.PivotFields('weeks_since_last_treatment').Orientation = win32c.xlRowField\n",
    "#PivotTable.PivotFields('weeks_since_last_treatment').Position = 2\n",
    "#PivotTable.PivotFields('weeks_since_last_treatment').Subtotals = [False, False, False, False, False, False, False, False, False, False, False, False]\n",
    "#PivotTable.PivotFields('shot_location').Orientation = win32c.xlRowField\n",
    "#PivotTable.PivotFields('shot_location').Position = 3\n",
    "#PivotTable.PivotFields('shot_location').Subtotals = [False, False, False, False, False, False, False, False, False, False, False, False]\n",
    "#PivotTable.PivotFields('intake_method').Orientation = win32c.xlRowField\n",
    "#PivotTable.PivotFields('intake_method').Position = 4\n",
    "#PivotTable.PivotFields('intake_method').Subtotals = [False, False, False, False, False, False, False, False, False, False, False, False]\n",
    "#PivotTable.PivotFields('vial_status_name').Orientation = win32c.xlRowField\n",
    "#PivotTable.PivotFields('vial_status_name').Position = 5\n",
    "#PivotTable.PivotFields('vial_status_name').Subtotals = [False, False, False, False, False, False, False, False, False, False, False, False]\n",
    "\n",
    "\n",
    "DataField = PivotTable.AddDataField(PivotTable.PivotFields('Budgets'))\n",
    "DataField = PivotTable.AddDataField(PivotTable.PivotFields('Actuals'))\n",
    "DataField1 = PivotTable.AddDataField(PivotTable.PivotFields('Actuals vs Budgets'))\n",
    "#DataField = PivotTable.CalculatedField('Budget vs Actual', '=Actuals / Budgets')\n",
    "DataField.Function = win32c.xlSum\n",
    "DataField1.Function = win32c.xlAverage\n",
    "\n",
    "#timeline = SlicerCache.Add2.PivotTable('time_period')\n",
    "#timeline.Function = win32.xlTimeline\n",
    "#Excel.Sheets(Sheet2.Name).Activate()\n",
    "#Sheet2Chart = Excel.ActiveSheet.Shapes.AddChart2(201, win32c.xlColumnClustered).Select()\n",
    "#Excel.ActiveChart.SetSourceData(Source=Sheet2.Range('$A$5'))\n",
    "\n",
    "#PivotChart = PivotCache.CreatePivotChart(ChartDestination=PivotChartRange)\n",
    "#PivotChart.ChartType = win32c.xlBar\n",
    "\n",
    "Excel.Visible = 1\n",
    "\n",
    "wb.SaveAs('C:\\\\Users\\\\eallan\\\\OneDrive - Fuel Medical Group, LLC\\\\Actual vs Budget 3.14.18 Summary.xlsx')\n",
    "Excel.Application.Quit()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
